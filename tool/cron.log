20220228
20220301
+ start_date=20220228
+ end_date=20220301
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220228
+ echo 20220228
20220228
+ [[ 20220228 != \2\0\2\2\0\3\0\1 ]]
+ echo 20220228
20220228
+ echo '/bin/bash etl-log_extract.sh 20220228'
/bin/bash etl-log_extract.sh 20220228
+ /bin/bash ../etl/log_extract.sh 20220228
2022-2-28
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-2-28.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-2-28.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-2-28.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-2-28.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220228
mkdir: cannot create directory ‘20220228’: File exists
+ mv 'msgaction 2022-2-28.log' 'msgaction2 2022-2-28.log' 'msgtype 2022-2-28.log' 'userinfo 2022-2-28.log' 20220228
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220228'
/bin/bash etl-log_transform.sh 20220228
+ /bin/bash ../etl/log_transform.sh 20220228
2022-2-28
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220228/msgaction 2022-2-28.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220228/msgaction2 2022-2-28.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220228/msgtype 2022-2-28.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220228/userinfo 2022-2-28.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220228
+ mv enemy_relationship_47.253.49.46.2022-2-28.log friend_relationship_47.253.49.46.2022-2-28.log msgaction2_47.253.49.46.2022-2-28.log msgaction_47.253.49.46.2022-2-28.log msgtype_47.253.49.46.2022-2-28.log user_equipment_47.253.49.46.2022-2-28.log user_eudemons_47.253.49.46.2022-2-28.log user_extension_47.253.49.46.2022-2-28.log user_family_47.253.49.46.2022-2-28.log user_login_47.253.49.46.2022-2-28.log 20220228
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220228'
/bin/bash etl-log_load.sh 20220228
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220228
2022-2-28
../etl/log_load.sh: line 25: hadoop: command not found
../etl/log_load.sh: line 26: hadoop: command not found
../etl/log_load.sh: line 27: hadoop: command not found
../etl/log_load.sh: line 25: hadoop: command not found
../etl/log_load.sh: line 26: hadoop: command not found
../etl/log_load.sh: line 27: hadoop: command not found
../etl/log_load.sh: line 25: hadoop: command not found
../etl/log_load.sh: line 26: hadoop: command not found
../etl/log_load.sh: line 27: hadoop: command not found
../etl/log_load.sh: line 25: hadoop: command not found
../etl/log_load.sh: line 26: hadoop: command not found
../etl/log_load.sh: line 27: hadoop: command not found
../etl/log_load.sh: line 25: hadoop: command not found
../etl/log_load.sh: line 26: hadoop: command not found
../etl/log_load.sh: line 27: hadoop: command not found
../etl/log_load.sh: line 25: hadoop: command not found
../etl/log_load.sh: line 26: hadoop: command not found
../etl/log_load.sh: line 27: hadoop: command not found
../etl/log_load.sh: line 25: hadoop: command not found
../etl/log_load.sh: line 26: hadoop: command not found
../etl/log_load.sh: line 27: hadoop: command not found
../etl/log_load.sh: line 25: hadoop: command not found
../etl/log_load.sh: line 26: hadoop: command not found
../etl/log_load.sh: line 27: hadoop: command not found
../etl/log_load.sh: line 25: hadoop: command not found
../etl/log_load.sh: line 26: hadoop: command not found
../etl/log_load.sh: line 27: hadoop: command not found
../etl/log_load.sh: line 25: hadoop: command not found
../etl/log_load.sh: line 26: hadoop: command not found
../etl/log_load.sh: line 27: hadoop: command not found
++ date +%Y%m%d -d '20220228 +1day'
+ date_str=20220301
+ [[ 20220301 != \2\0\2\2\0\3\0\1 ]]
20220301
20220302
+ start_date=20220301
+ end_date=20220302
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220301
+ echo 20220301
20220301
+ [[ 20220301 != \2\0\2\2\0\3\0\2 ]]
+ echo 20220301
20220301
+ echo '/bin/bash etl-log_extract.sh 20220301'
/bin/bash etl-log_extract.sh 20220301
+ /bin/bash ../etl/log_extract.sh 20220301
2022-3-1
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-1.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-1.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-1.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-1.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220301
+ mv 'msgaction 2022-3-1.log' 'msgaction2 2022-3-1.log' 'msgtype 2022-3-1.log' 'userinfo 2022-3-1.log' 20220301
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220301'
/bin/bash etl-log_transform.sh 20220301
+ /bin/bash ../etl/log_transform.sh 20220301
2022-3-1
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220301/msgaction 2022-3-1.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220301/msgaction2 2022-3-1.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220301/msgtype 2022-3-1.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220301/userinfo 2022-3-1.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220301
+ mv enemy_relationship_47.253.49.46.2022-3-1.log friend_relationship_47.253.49.46.2022-3-1.log msgaction2_47.253.49.46.2022-3-1.log msgaction_47.253.49.46.2022-3-1.log msgtype_47.253.49.46.2022-3-1.log user_equipment_47.253.49.46.2022-3-1.log user_eudemons_47.253.49.46.2022-3-1.log user_extension_47.253.49.46.2022-3-1.log user_family_47.253.49.46.2022-3-1.log user_login_47.253.49.46.2022-3-1.log 20220301
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220301'
/bin/bash etl-log_load.sh 20220301
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220301
2022-3-1
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220301/user_login_47.253.49.46.2022-3-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220301/user_family_47.253.49.46.2022-3-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220301/user_eudemons_47.253.49.46.2022-3-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220301/user_equipment_47.253.49.46.2022-3-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220301/friend_relationship_47.253.49.46.2022-3-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220301/enemy_relationship_47.253.49.46.2022-3-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220301/user_extension_47.253.49.46.2022-3-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220301/msgaction_47.253.49.46.2022-3-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220301/msgaction2_47.253.49.46.2022-3-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220301/msgtype_47.253.49.46.2022-3-1.log': No such file or directory
++ date +%Y%m%d -d '20220301 +1day'
+ date_str=20220302
+ [[ 20220302 != \2\0\2\2\0\3\0\2 ]]
20220302
20220303
+ start_date=20220302
+ end_date=20220303
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220302
+ echo 20220302
20220302
+ [[ 20220302 != \2\0\2\2\0\3\0\3 ]]
+ echo 20220302
20220302
+ echo '/bin/bash etl-log_extract.sh 20220302'
/bin/bash etl-log_extract.sh 20220302
+ /bin/bash ../etl/log_extract.sh 20220302
2022-3-2
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-2.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-2.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-2.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-2.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220302
+ mv 'msgaction 2022-3-2.log' 'msgaction2 2022-3-2.log' 'msgtype 2022-3-2.log' 'userinfo 2022-3-2.log' 20220302
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220302'
/bin/bash etl-log_transform.sh 20220302
+ /bin/bash ../etl/log_transform.sh 20220302
2022-3-2
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220302/msgaction 2022-3-2.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220302/msgaction2 2022-3-2.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220302/msgtype 2022-3-2.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220302/userinfo 2022-3-2.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220302
+ mv enemy_relationship_47.253.49.46.2022-3-2.log friend_relationship_47.253.49.46.2022-3-2.log msgaction2_47.253.49.46.2022-3-2.log msgaction_47.253.49.46.2022-3-2.log msgtype_47.253.49.46.2022-3-2.log user_equipment_47.253.49.46.2022-3-2.log user_eudemons_47.253.49.46.2022-3-2.log user_extension_47.253.49.46.2022-3-2.log user_family_47.253.49.46.2022-3-2.log user_login_47.253.49.46.2022-3-2.log 20220302
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220302'
/bin/bash etl-log_load.sh 20220302
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220302
2022-3-2
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220302/user_login_47.253.49.46.2022-3-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220302/user_family_47.253.49.46.2022-3-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220302/user_eudemons_47.253.49.46.2022-3-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220302/user_equipment_47.253.49.46.2022-3-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220302/friend_relationship_47.253.49.46.2022-3-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220302/enemy_relationship_47.253.49.46.2022-3-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220302/user_extension_47.253.49.46.2022-3-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220302/msgaction_47.253.49.46.2022-3-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220302/msgaction2_47.253.49.46.2022-3-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220302/msgtype_47.253.49.46.2022-3-2.log': No such file or directory
++ date +%Y%m%d -d '20220302 +1day'
+ date_str=20220303
+ [[ 20220303 != \2\0\2\2\0\3\0\3 ]]
20220303
20220304
+ start_date=20220303
+ end_date=20220304
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220303
+ echo 20220303
20220303
+ [[ 20220303 != \2\0\2\2\0\3\0\4 ]]
+ echo 20220303
20220303
+ echo '/bin/bash etl-log_extract.sh 20220303'
/bin/bash etl-log_extract.sh 20220303
+ /bin/bash ../etl/log_extract.sh 20220303
2022-3-3
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-3.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-3.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-3.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-3.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220303
+ mv 'msgaction 2022-3-3.log' 'msgaction2 2022-3-3.log' 'msgtype 2022-3-3.log' 'userinfo 2022-3-3.log' 20220303
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220303'
/bin/bash etl-log_transform.sh 20220303
+ /bin/bash ../etl/log_transform.sh 20220303
2022-3-3
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220303/msgaction 2022-3-3.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220303/msgaction2 2022-3-3.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220303/msgtype 2022-3-3.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220303/userinfo 2022-3-3.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220303
+ mv enemy_relationship_47.253.49.46.2022-3-3.log friend_relationship_47.253.49.46.2022-3-3.log msgaction2_47.253.49.46.2022-3-3.log msgaction_47.253.49.46.2022-3-3.log msgtype_47.253.49.46.2022-3-3.log user_equipment_47.253.49.46.2022-3-3.log user_eudemons_47.253.49.46.2022-3-3.log user_extension_47.253.49.46.2022-3-3.log user_family_47.253.49.46.2022-3-3.log user_login_47.253.49.46.2022-3-3.log 20220303
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220303'
/bin/bash etl-log_load.sh 20220303
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220303
2022-3-3
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220303/user_login_47.253.49.46.2022-3-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220303/user_family_47.253.49.46.2022-3-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220303/user_eudemons_47.253.49.46.2022-3-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220303/user_equipment_47.253.49.46.2022-3-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220303/friend_relationship_47.253.49.46.2022-3-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220303/enemy_relationship_47.253.49.46.2022-3-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220303/user_extension_47.253.49.46.2022-3-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220303/msgaction_47.253.49.46.2022-3-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220303/msgaction2_47.253.49.46.2022-3-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220303/msgtype_47.253.49.46.2022-3-3.log': No such file or directory
++ date +%Y%m%d -d '20220303 +1day'
+ date_str=20220304
+ [[ 20220304 != \2\0\2\2\0\3\0\4 ]]
20220304
20220305
+ start_date=20220304
+ end_date=20220305
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220304
+ echo 20220304
20220304
+ [[ 20220304 != \2\0\2\2\0\3\0\5 ]]
+ echo 20220304
20220304
+ echo '/bin/bash etl-log_extract.sh 20220304'
/bin/bash etl-log_extract.sh 20220304
+ /bin/bash ../etl/log_extract.sh 20220304
2022-3-4
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-4.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-4.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-4.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-4.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220304
+ mv 'msgaction 2022-3-4.log' 'msgaction2 2022-3-4.log' 'msgtype 2022-3-4.log' 'userinfo 2022-3-4.log' 20220304
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220304'
/bin/bash etl-log_transform.sh 20220304
+ /bin/bash ../etl/log_transform.sh 20220304
2022-3-4
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220304/msgaction 2022-3-4.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220304/msgaction2 2022-3-4.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220304/msgtype 2022-3-4.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220304/userinfo 2022-3-4.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220304
+ mv enemy_relationship_47.253.49.46.2022-3-4.log friend_relationship_47.253.49.46.2022-3-4.log msgaction2_47.253.49.46.2022-3-4.log msgaction_47.253.49.46.2022-3-4.log msgtype_47.253.49.46.2022-3-4.log user_equipment_47.253.49.46.2022-3-4.log user_eudemons_47.253.49.46.2022-3-4.log user_extension_47.253.49.46.2022-3-4.log user_family_47.253.49.46.2022-3-4.log user_login_47.253.49.46.2022-3-4.log 20220304
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220304'
/bin/bash etl-log_load.sh 20220304
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220304
2022-3-4
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220304/user_login_47.253.49.46.2022-3-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220304/user_family_47.253.49.46.2022-3-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220304/user_eudemons_47.253.49.46.2022-3-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220304/user_equipment_47.253.49.46.2022-3-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220304/friend_relationship_47.253.49.46.2022-3-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220304/enemy_relationship_47.253.49.46.2022-3-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220304/user_extension_47.253.49.46.2022-3-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220304/msgaction_47.253.49.46.2022-3-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220304/msgaction2_47.253.49.46.2022-3-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220304/msgtype_47.253.49.46.2022-3-4.log': No such file or directory
++ date +%Y%m%d -d '20220304 +1day'
+ date_str=20220305
+ [[ 20220305 != \2\0\2\2\0\3\0\5 ]]
20220305
20220306
+ start_date=20220305
+ end_date=20220306
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220305
+ echo 20220305
20220305
+ [[ 20220305 != \2\0\2\2\0\3\0\6 ]]
+ echo 20220305
20220305
+ echo '/bin/bash etl-log_extract.sh 20220305'
/bin/bash etl-log_extract.sh 20220305
+ /bin/bash ../etl/log_extract.sh 20220305
2022-3-5
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-5.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-5.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-5.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-5.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220305
+ mv 'msgaction 2022-3-5.log' 'msgaction2 2022-3-5.log' 'msgtype 2022-3-5.log' 'userinfo 2022-3-5.log' 20220305
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220305'
/bin/bash etl-log_transform.sh 20220305
+ /bin/bash ../etl/log_transform.sh 20220305
2022-3-5
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220305/msgaction 2022-3-5.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220305/msgaction2 2022-3-5.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220305/msgtype 2022-3-5.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220305/userinfo 2022-3-5.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220305
+ mv enemy_relationship_47.253.49.46.2022-3-5.log friend_relationship_47.253.49.46.2022-3-5.log msgaction2_47.253.49.46.2022-3-5.log msgaction_47.253.49.46.2022-3-5.log msgtype_47.253.49.46.2022-3-5.log user_equipment_47.253.49.46.2022-3-5.log user_eudemons_47.253.49.46.2022-3-5.log user_extension_47.253.49.46.2022-3-5.log user_family_47.253.49.46.2022-3-5.log user_login_47.253.49.46.2022-3-5.log 20220305
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220305'
/bin/bash etl-log_load.sh 20220305
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220305
2022-3-5
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220305/user_login_47.253.49.46.2022-3-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220305/user_family_47.253.49.46.2022-3-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220305/user_eudemons_47.253.49.46.2022-3-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220305/user_equipment_47.253.49.46.2022-3-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220305/friend_relationship_47.253.49.46.2022-3-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220305/enemy_relationship_47.253.49.46.2022-3-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220305/user_extension_47.253.49.46.2022-3-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220305/msgaction_47.253.49.46.2022-3-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220305/msgaction2_47.253.49.46.2022-3-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220305/msgtype_47.253.49.46.2022-3-5.log': No such file or directory
++ date +%Y%m%d -d '20220305 +1day'
+ date_str=20220306
+ [[ 20220306 != \2\0\2\2\0\3\0\6 ]]
20220306
20220307
+ start_date=20220306
+ end_date=20220307
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220306
+ echo 20220306
20220306
+ [[ 20220306 != \2\0\2\2\0\3\0\7 ]]
+ echo 20220306
20220306
+ echo '/bin/bash etl-log_extract.sh 20220306'
/bin/bash etl-log_extract.sh 20220306
+ /bin/bash ../etl/log_extract.sh 20220306
2022-3-6
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-6.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-6.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-6.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-6.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220306
+ mv 'msgaction 2022-3-6.log' 'msgaction2 2022-3-6.log' 'msgtype 2022-3-6.log' 'userinfo 2022-3-6.log' 20220306
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220306'
/bin/bash etl-log_transform.sh 20220306
+ /bin/bash ../etl/log_transform.sh 20220306
2022-3-6
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220306/msgaction 2022-3-6.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220306/msgaction2 2022-3-6.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220306/msgtype 2022-3-6.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220306/userinfo 2022-3-6.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220306
+ mv enemy_relationship_47.253.49.46.2022-3-6.log friend_relationship_47.253.49.46.2022-3-6.log msgaction2_47.253.49.46.2022-3-6.log msgaction_47.253.49.46.2022-3-6.log msgtype_47.253.49.46.2022-3-6.log user_equipment_47.253.49.46.2022-3-6.log user_eudemons_47.253.49.46.2022-3-6.log user_extension_47.253.49.46.2022-3-6.log user_family_47.253.49.46.2022-3-6.log user_login_47.253.49.46.2022-3-6.log 20220306
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220306'
/bin/bash etl-log_load.sh 20220306
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220306
2022-3-6
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220306/user_login_47.253.49.46.2022-3-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220306/user_family_47.253.49.46.2022-3-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220306/user_eudemons_47.253.49.46.2022-3-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220306/user_equipment_47.253.49.46.2022-3-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220306/friend_relationship_47.253.49.46.2022-3-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220306/enemy_relationship_47.253.49.46.2022-3-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220306/user_extension_47.253.49.46.2022-3-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220306/msgaction_47.253.49.46.2022-3-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220306/msgaction2_47.253.49.46.2022-3-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220306/msgtype_47.253.49.46.2022-3-6.log': No such file or directory
++ date +%Y%m%d -d '20220306 +1day'
+ date_str=20220307
+ [[ 20220307 != \2\0\2\2\0\3\0\7 ]]
20220307
20220308
+ start_date=20220307
+ end_date=20220308
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220307
+ echo 20220307
20220307
+ [[ 20220307 != \2\0\2\2\0\3\0\8 ]]
+ echo 20220307
20220307
+ echo '/bin/bash etl-log_extract.sh 20220307'
/bin/bash etl-log_extract.sh 20220307
+ /bin/bash ../etl/log_extract.sh 20220307
2022-3-7
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-7.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-7.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-7.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-7.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220307
+ mv 'msgaction 2022-3-7.log' 'msgaction2 2022-3-7.log' 'msgtype 2022-3-7.log' 'userinfo 2022-3-7.log' 20220307
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220307'
/bin/bash etl-log_transform.sh 20220307
+ /bin/bash ../etl/log_transform.sh 20220307
2022-3-7
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220307/msgaction 2022-3-7.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220307/msgaction2 2022-3-7.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220307/msgtype 2022-3-7.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220307/userinfo 2022-3-7.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220307
+ mv enemy_relationship_47.253.49.46.2022-3-7.log friend_relationship_47.253.49.46.2022-3-7.log msgaction2_47.253.49.46.2022-3-7.log msgaction_47.253.49.46.2022-3-7.log msgtype_47.253.49.46.2022-3-7.log user_equipment_47.253.49.46.2022-3-7.log user_eudemons_47.253.49.46.2022-3-7.log user_extension_47.253.49.46.2022-3-7.log user_family_47.253.49.46.2022-3-7.log user_login_47.253.49.46.2022-3-7.log 20220307
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220307'
/bin/bash etl-log_load.sh 20220307
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220307
2022-3-7
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220307/user_login_47.253.49.46.2022-3-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220307/user_family_47.253.49.46.2022-3-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220307/user_eudemons_47.253.49.46.2022-3-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220307/user_equipment_47.253.49.46.2022-3-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220307/friend_relationship_47.253.49.46.2022-3-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220307/enemy_relationship_47.253.49.46.2022-3-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220307/user_extension_47.253.49.46.2022-3-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220307/msgaction_47.253.49.46.2022-3-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220307/msgaction2_47.253.49.46.2022-3-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220307/msgtype_47.253.49.46.2022-3-7.log': No such file or directory
++ date +%Y%m%d -d '20220307 +1day'
+ date_str=20220308
+ [[ 20220308 != \2\0\2\2\0\3\0\8 ]]
20220308
20220309
+ start_date=20220308
+ end_date=20220309
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220308
+ echo 20220308
20220308
+ [[ 20220308 != \2\0\2\2\0\3\0\9 ]]
+ echo 20220308
20220308
+ echo '/bin/bash etl-log_extract.sh 20220308'
/bin/bash etl-log_extract.sh 20220308
+ /bin/bash ../etl/log_extract.sh 20220308
2022-3-8
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-8.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-8.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-8.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-8.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220308
+ mv 'msgaction 2022-3-8.log' 'msgaction2 2022-3-8.log' 'msgtype 2022-3-8.log' 'userinfo 2022-3-8.log' 20220308
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220308'
/bin/bash etl-log_transform.sh 20220308
+ /bin/bash ../etl/log_transform.sh 20220308
2022-3-8
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220308/msgaction 2022-3-8.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220308/msgaction2 2022-3-8.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220308/msgtype 2022-3-8.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220308/userinfo 2022-3-8.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220308
+ mv enemy_relationship_47.253.49.46.2022-3-8.log friend_relationship_47.253.49.46.2022-3-8.log msgaction2_47.253.49.46.2022-3-8.log msgaction_47.253.49.46.2022-3-8.log msgtype_47.253.49.46.2022-3-8.log user_equipment_47.253.49.46.2022-3-8.log user_eudemons_47.253.49.46.2022-3-8.log user_extension_47.253.49.46.2022-3-8.log user_family_47.253.49.46.2022-3-8.log user_login_47.253.49.46.2022-3-8.log 20220308
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220308'
/bin/bash etl-log_load.sh 20220308
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220308
2022-3-8
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220308/user_login_47.253.49.46.2022-3-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220308/user_family_47.253.49.46.2022-3-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220308/user_eudemons_47.253.49.46.2022-3-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220308/user_equipment_47.253.49.46.2022-3-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220308/friend_relationship_47.253.49.46.2022-3-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220308/enemy_relationship_47.253.49.46.2022-3-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220308/user_extension_47.253.49.46.2022-3-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220308/msgaction_47.253.49.46.2022-3-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220308/msgaction2_47.253.49.46.2022-3-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220308/msgtype_47.253.49.46.2022-3-8.log': No such file or directory
++ date +%Y%m%d -d '20220308 +1day'
+ date_str=20220309
+ [[ 20220309 != \2\0\2\2\0\3\0\9 ]]
20220309
20220310
+ start_date=20220309
+ end_date=20220310
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220309
+ echo 20220309
20220309
+ [[ 20220309 != \2\0\2\2\0\3\1\0 ]]
+ echo 20220309
20220309
+ echo '/bin/bash etl-log_extract.sh 20220309'
/bin/bash etl-log_extract.sh 20220309
+ /bin/bash ../etl/log_extract.sh 20220309
2022-3-9
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-9.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-9.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-9.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-9.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220309
+ mv 'msgaction 2022-3-9.log' 'msgaction2 2022-3-9.log' 'msgtype 2022-3-9.log' 'userinfo 2022-3-9.log' 20220309
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220309'
/bin/bash etl-log_transform.sh 20220309
+ /bin/bash ../etl/log_transform.sh 20220309
2022-3-9
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220309/msgaction 2022-3-9.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220309/msgaction2 2022-3-9.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220309/msgtype 2022-3-9.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220309/userinfo 2022-3-9.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220309
+ mv enemy_relationship_47.253.49.46.2022-3-9.log friend_relationship_47.253.49.46.2022-3-9.log msgaction2_47.253.49.46.2022-3-9.log msgaction_47.253.49.46.2022-3-9.log msgtype_47.253.49.46.2022-3-9.log user_equipment_47.253.49.46.2022-3-9.log user_eudemons_47.253.49.46.2022-3-9.log user_extension_47.253.49.46.2022-3-9.log user_family_47.253.49.46.2022-3-9.log user_login_47.253.49.46.2022-3-9.log 20220309
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220309'
/bin/bash etl-log_load.sh 20220309
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220309
2022-3-9
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220309/user_login_47.253.49.46.2022-3-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220309/user_family_47.253.49.46.2022-3-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220309/user_eudemons_47.253.49.46.2022-3-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220309/user_equipment_47.253.49.46.2022-3-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220309/friend_relationship_47.253.49.46.2022-3-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220309/enemy_relationship_47.253.49.46.2022-3-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220309/user_extension_47.253.49.46.2022-3-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220309/msgaction_47.253.49.46.2022-3-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220309/msgaction2_47.253.49.46.2022-3-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220309/msgtype_47.253.49.46.2022-3-9.log': No such file or directory
++ date +%Y%m%d -d '20220309 +1day'
+ date_str=20220310
+ [[ 20220310 != \2\0\2\2\0\3\1\0 ]]
20220310
20220311
+ start_date=20220310
+ end_date=20220311
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220310
+ echo 20220310
20220310
+ [[ 20220310 != \2\0\2\2\0\3\1\1 ]]
+ echo 20220310
20220310
+ echo '/bin/bash etl-log_extract.sh 20220310'
/bin/bash etl-log_extract.sh 20220310
+ /bin/bash ../etl/log_extract.sh 20220310
2022-3-10
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-10.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-10.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-10.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-10.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220310
+ mv 'msgaction 2022-3-10.log' 'msgaction2 2022-3-10.log' 'msgtype 2022-3-10.log' 'userinfo 2022-3-10.log' 20220310
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220310'
/bin/bash etl-log_transform.sh 20220310
+ /bin/bash ../etl/log_transform.sh 20220310
2022-3-10
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220310/msgaction 2022-3-10.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220310/msgaction2 2022-3-10.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220310/msgtype 2022-3-10.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220310/userinfo 2022-3-10.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220310
+ mv enemy_relationship_47.253.49.46.2022-3-10.log friend_relationship_47.253.49.46.2022-3-10.log msgaction2_47.253.49.46.2022-3-10.log msgaction_47.253.49.46.2022-3-10.log msgtype_47.253.49.46.2022-3-10.log user_equipment_47.253.49.46.2022-3-10.log user_eudemons_47.253.49.46.2022-3-10.log user_extension_47.253.49.46.2022-3-10.log user_family_47.253.49.46.2022-3-10.log user_login_47.253.49.46.2022-3-10.log 20220310
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220310'
/bin/bash etl-log_load.sh 20220310
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220310
2022-3-10
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220310/user_login_47.253.49.46.2022-3-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220310/user_family_47.253.49.46.2022-3-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220310/user_eudemons_47.253.49.46.2022-3-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220310/user_equipment_47.253.49.46.2022-3-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220310/friend_relationship_47.253.49.46.2022-3-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220310/enemy_relationship_47.253.49.46.2022-3-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220310/user_extension_47.253.49.46.2022-3-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220310/msgaction_47.253.49.46.2022-3-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220310/msgaction2_47.253.49.46.2022-3-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220310/msgtype_47.253.49.46.2022-3-10.log': No such file or directory
++ date +%Y%m%d -d '20220310 +1day'
+ date_str=20220311
+ [[ 20220311 != \2\0\2\2\0\3\1\1 ]]
20220311
20220312
+ start_date=20220311
+ end_date=20220312
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220311
+ echo 20220311
20220311
+ [[ 20220311 != \2\0\2\2\0\3\1\2 ]]
+ echo 20220311
20220311
+ echo '/bin/bash etl-log_extract.sh 20220311'
/bin/bash etl-log_extract.sh 20220311
+ /bin/bash ../etl/log_extract.sh 20220311
2022-3-11
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-11.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-11.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-11.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-11.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220311
+ mv 'msgaction 2022-3-11.log' 'msgaction2 2022-3-11.log' 'msgtype 2022-3-11.log' 'userinfo 2022-3-11.log' 20220311
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220311'
/bin/bash etl-log_transform.sh 20220311
+ /bin/bash ../etl/log_transform.sh 20220311
2022-3-11
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220311/msgaction 2022-3-11.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220311/msgaction2 2022-3-11.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220311/msgtype 2022-3-11.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220311/userinfo 2022-3-11.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220311
+ mv enemy_relationship_47.253.49.46.2022-3-11.log friend_relationship_47.253.49.46.2022-3-11.log msgaction2_47.253.49.46.2022-3-11.log msgaction_47.253.49.46.2022-3-11.log msgtype_47.253.49.46.2022-3-11.log user_equipment_47.253.49.46.2022-3-11.log user_eudemons_47.253.49.46.2022-3-11.log user_extension_47.253.49.46.2022-3-11.log user_family_47.253.49.46.2022-3-11.log user_login_47.253.49.46.2022-3-11.log 20220311
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220311'
/bin/bash etl-log_load.sh 20220311
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220311
2022-3-11
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220311/user_login_47.253.49.46.2022-3-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220311/user_family_47.253.49.46.2022-3-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220311/user_eudemons_47.253.49.46.2022-3-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220311/user_equipment_47.253.49.46.2022-3-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220311/friend_relationship_47.253.49.46.2022-3-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220311/enemy_relationship_47.253.49.46.2022-3-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220311/user_extension_47.253.49.46.2022-3-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220311/msgaction_47.253.49.46.2022-3-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220311/msgaction2_47.253.49.46.2022-3-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220311/msgtype_47.253.49.46.2022-3-11.log': No such file or directory
++ date +%Y%m%d -d '20220311 +1day'
+ date_str=20220312
+ [[ 20220312 != \2\0\2\2\0\3\1\2 ]]
20220312
20220313
+ start_date=20220312
+ end_date=20220313
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220312
+ echo 20220312
20220312
+ [[ 20220312 != \2\0\2\2\0\3\1\3 ]]
+ echo 20220312
20220312
+ echo '/bin/bash etl-log_extract.sh 20220312'
/bin/bash etl-log_extract.sh 20220312
+ /bin/bash ../etl/log_extract.sh 20220312
2022-3-12
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-12.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-12.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-12.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-12.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220312
+ mv 'msgaction 2022-3-12.log' 'msgaction2 2022-3-12.log' 'msgtype 2022-3-12.log' 'userinfo 2022-3-12.log' 20220312
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220312'
/bin/bash etl-log_transform.sh 20220312
+ /bin/bash ../etl/log_transform.sh 20220312
2022-3-12
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220312/msgaction 2022-3-12.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220312/msgaction2 2022-3-12.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220312/msgtype 2022-3-12.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220312/userinfo 2022-3-12.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220312
+ mv enemy_relationship_47.253.49.46.2022-3-12.log friend_relationship_47.253.49.46.2022-3-12.log msgaction2_47.253.49.46.2022-3-12.log msgaction_47.253.49.46.2022-3-12.log msgtype_47.253.49.46.2022-3-12.log user_equipment_47.253.49.46.2022-3-12.log user_eudemons_47.253.49.46.2022-3-12.log user_extension_47.253.49.46.2022-3-12.log user_family_47.253.49.46.2022-3-12.log user_login_47.253.49.46.2022-3-12.log 20220312
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220312'
/bin/bash etl-log_load.sh 20220312
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220312
2022-3-12
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220312/user_login_47.253.49.46.2022-3-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220312/user_family_47.253.49.46.2022-3-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220312/user_eudemons_47.253.49.46.2022-3-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220312/user_equipment_47.253.49.46.2022-3-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220312/friend_relationship_47.253.49.46.2022-3-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220312/enemy_relationship_47.253.49.46.2022-3-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220312/user_extension_47.253.49.46.2022-3-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220312/msgaction_47.253.49.46.2022-3-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220312/msgaction2_47.253.49.46.2022-3-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220312/msgtype_47.253.49.46.2022-3-12.log': No such file or directory
++ date +%Y%m%d -d '20220312 +1day'
+ date_str=20220313
+ [[ 20220313 != \2\0\2\2\0\3\1\3 ]]
20220313
20220314
+ start_date=20220313
+ end_date=20220314
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220313
+ echo 20220313
20220313
+ [[ 20220313 != \2\0\2\2\0\3\1\4 ]]
+ echo 20220313
20220313
+ echo '/bin/bash etl-log_extract.sh 20220313'
/bin/bash etl-log_extract.sh 20220313
+ /bin/bash ../etl/log_extract.sh 20220313
2022-3-13
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-13.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-13.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-13.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-13.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220313
+ mv 'msgaction 2022-3-13.log' 'msgaction2 2022-3-13.log' 'msgtype 2022-3-13.log' 'userinfo 2022-3-13.log' 20220313
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220313'
/bin/bash etl-log_transform.sh 20220313
+ /bin/bash ../etl/log_transform.sh 20220313
2022-3-13
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220313/msgaction 2022-3-13.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220313/msgaction2 2022-3-13.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220313/msgtype 2022-3-13.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220313/userinfo 2022-3-13.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220313
+ mv enemy_relationship_47.253.49.46.2022-3-13.log friend_relationship_47.253.49.46.2022-3-13.log msgaction2_47.253.49.46.2022-3-13.log msgaction_47.253.49.46.2022-3-13.log msgtype_47.253.49.46.2022-3-13.log user_equipment_47.253.49.46.2022-3-13.log user_eudemons_47.253.49.46.2022-3-13.log user_extension_47.253.49.46.2022-3-13.log user_family_47.253.49.46.2022-3-13.log user_login_47.253.49.46.2022-3-13.log 20220313
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220313'
/bin/bash etl-log_load.sh 20220313
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220313
2022-3-13
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220313/user_login_47.253.49.46.2022-3-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220313/user_family_47.253.49.46.2022-3-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220313/user_eudemons_47.253.49.46.2022-3-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220313/user_equipment_47.253.49.46.2022-3-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220313/friend_relationship_47.253.49.46.2022-3-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220313/enemy_relationship_47.253.49.46.2022-3-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220313/user_extension_47.253.49.46.2022-3-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220313/msgaction_47.253.49.46.2022-3-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220313/msgaction2_47.253.49.46.2022-3-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220313/msgtype_47.253.49.46.2022-3-13.log': No such file or directory
++ date +%Y%m%d -d '20220313 +1day'
+ date_str=20220314
+ [[ 20220314 != \2\0\2\2\0\3\1\4 ]]
20220314
20220315
+ start_date=20220314
+ end_date=20220315
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220314
+ echo 20220314
20220314
+ [[ 20220314 != \2\0\2\2\0\3\1\5 ]]
+ echo 20220314
20220314
+ echo '/bin/bash etl-log_extract.sh 20220314'
/bin/bash etl-log_extract.sh 20220314
+ /bin/bash ../etl/log_extract.sh 20220314
2022-3-14
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-14.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-14.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-14.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-14.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220314
+ mv 'msgaction 2022-3-14.log' 'msgaction2 2022-3-14.log' 'msgtype 2022-3-14.log' 'userinfo 2022-3-14.log' 20220314
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220314'
/bin/bash etl-log_transform.sh 20220314
+ /bin/bash ../etl/log_transform.sh 20220314
2022-3-14
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220314/msgaction 2022-3-14.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220314/msgaction2 2022-3-14.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220314/msgtype 2022-3-14.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220314/userinfo 2022-3-14.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220314
+ mv enemy_relationship_47.253.49.46.2022-3-14.log friend_relationship_47.253.49.46.2022-3-14.log msgaction2_47.253.49.46.2022-3-14.log msgaction_47.253.49.46.2022-3-14.log msgtype_47.253.49.46.2022-3-14.log user_equipment_47.253.49.46.2022-3-14.log user_eudemons_47.253.49.46.2022-3-14.log user_extension_47.253.49.46.2022-3-14.log user_family_47.253.49.46.2022-3-14.log user_login_47.253.49.46.2022-3-14.log 20220314
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220314'
/bin/bash etl-log_load.sh 20220314
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220314
2022-3-14
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220314/user_login_47.253.49.46.2022-3-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220314/user_family_47.253.49.46.2022-3-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220314/user_eudemons_47.253.49.46.2022-3-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220314/user_equipment_47.253.49.46.2022-3-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220314/friend_relationship_47.253.49.46.2022-3-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220314/enemy_relationship_47.253.49.46.2022-3-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220314/user_extension_47.253.49.46.2022-3-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220314/msgaction_47.253.49.46.2022-3-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220314/msgaction2_47.253.49.46.2022-3-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220314/msgtype_47.253.49.46.2022-3-14.log': No such file or directory
++ date +%Y%m%d -d '20220314 +1day'
+ date_str=20220315
+ [[ 20220315 != \2\0\2\2\0\3\1\5 ]]
20220315
20220316
+ start_date=20220315
+ end_date=20220316
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220315
+ echo 20220315
20220315
+ [[ 20220315 != \2\0\2\2\0\3\1\6 ]]
+ echo 20220315
20220315
+ echo '/bin/bash etl-log_extract.sh 20220315'
/bin/bash etl-log_extract.sh 20220315
+ /bin/bash ../etl/log_extract.sh 20220315
2022-3-15
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-15.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-15.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-15.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-15.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220315
+ mv 'msgaction 2022-3-15.log' 'msgaction2 2022-3-15.log' 'msgtype 2022-3-15.log' 'userinfo 2022-3-15.log' 20220315
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220315'
/bin/bash etl-log_transform.sh 20220315
+ /bin/bash ../etl/log_transform.sh 20220315
2022-3-15
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220315/msgaction 2022-3-15.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220315/msgaction2 2022-3-15.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220315/msgtype 2022-3-15.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220315/userinfo 2022-3-15.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220315
+ mv enemy_relationship_47.253.49.46.2022-3-15.log friend_relationship_47.253.49.46.2022-3-15.log msgaction2_47.253.49.46.2022-3-15.log msgaction_47.253.49.46.2022-3-15.log msgtype_47.253.49.46.2022-3-15.log user_equipment_47.253.49.46.2022-3-15.log user_eudemons_47.253.49.46.2022-3-15.log user_extension_47.253.49.46.2022-3-15.log user_family_47.253.49.46.2022-3-15.log user_login_47.253.49.46.2022-3-15.log 20220315
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220315'
/bin/bash etl-log_load.sh 20220315
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220315
2022-3-15
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220315/user_login_47.253.49.46.2022-3-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220315/user_family_47.253.49.46.2022-3-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220315/user_eudemons_47.253.49.46.2022-3-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220315/user_equipment_47.253.49.46.2022-3-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220315/friend_relationship_47.253.49.46.2022-3-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220315/enemy_relationship_47.253.49.46.2022-3-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220315/user_extension_47.253.49.46.2022-3-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220315/msgaction_47.253.49.46.2022-3-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220315/msgaction2_47.253.49.46.2022-3-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220315/msgtype_47.253.49.46.2022-3-15.log': No such file or directory
++ date +%Y%m%d -d '20220315 +1day'
+ date_str=20220316
+ [[ 20220316 != \2\0\2\2\0\3\1\6 ]]
20220316
20220317
+ start_date=20220316
+ end_date=20220317
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220316
+ echo 20220316
20220316
+ [[ 20220316 != \2\0\2\2\0\3\1\7 ]]
+ echo 20220316
20220316
+ echo '/bin/bash etl-log_extract.sh 20220316'
/bin/bash etl-log_extract.sh 20220316
+ /bin/bash ../etl/log_extract.sh 20220316
2022-3-16
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-16.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-16.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-16.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-16.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220316
+ mv 'msgaction 2022-3-16.log' 'msgaction2 2022-3-16.log' 'msgtype 2022-3-16.log' 'userinfo 2022-3-16.log' 20220316
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220316'
/bin/bash etl-log_transform.sh 20220316
+ /bin/bash ../etl/log_transform.sh 20220316
2022-3-16
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220316/msgaction 2022-3-16.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220316/msgaction2 2022-3-16.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220316/msgtype 2022-3-16.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220316/userinfo 2022-3-16.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220316
+ mv enemy_relationship_47.253.49.46.2022-3-16.log friend_relationship_47.253.49.46.2022-3-16.log msgaction2_47.253.49.46.2022-3-16.log msgaction_47.253.49.46.2022-3-16.log msgtype_47.253.49.46.2022-3-16.log user_equipment_47.253.49.46.2022-3-16.log user_eudemons_47.253.49.46.2022-3-16.log user_extension_47.253.49.46.2022-3-16.log user_family_47.253.49.46.2022-3-16.log user_login_47.253.49.46.2022-3-16.log 20220316
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220316'
/bin/bash etl-log_load.sh 20220316
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220316
2022-3-16
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220316/user_login_47.253.49.46.2022-3-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220316/user_family_47.253.49.46.2022-3-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220316/user_eudemons_47.253.49.46.2022-3-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220316/user_equipment_47.253.49.46.2022-3-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220316/friend_relationship_47.253.49.46.2022-3-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220316/enemy_relationship_47.253.49.46.2022-3-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220316/user_extension_47.253.49.46.2022-3-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220316/msgaction_47.253.49.46.2022-3-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220316/msgaction2_47.253.49.46.2022-3-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220316/msgtype_47.253.49.46.2022-3-16.log': No such file or directory
++ date +%Y%m%d -d '20220316 +1day'
+ date_str=20220317
+ [[ 20220317 != \2\0\2\2\0\3\1\7 ]]
20220317
20220318
+ start_date=20220317
+ end_date=20220318
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220317
+ echo 20220317
20220317
+ [[ 20220317 != \2\0\2\2\0\3\1\8 ]]
+ echo 20220317
20220317
+ echo '/bin/bash etl-log_extract.sh 20220317'
/bin/bash etl-log_extract.sh 20220317
+ /bin/bash ../etl/log_extract.sh 20220317
2022-3-17
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-17.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-17.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-17.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-17.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220317
+ mv 'msgaction 2022-3-17.log' 'msgaction2 2022-3-17.log' 'msgtype 2022-3-17.log' 'userinfo 2022-3-17.log' 20220317
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220317'
/bin/bash etl-log_transform.sh 20220317
+ /bin/bash ../etl/log_transform.sh 20220317
2022-3-17
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220317/msgaction 2022-3-17.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220317/msgaction2 2022-3-17.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220317/msgtype 2022-3-17.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220317/userinfo 2022-3-17.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220317
+ mv enemy_relationship_47.253.49.46.2022-3-17.log friend_relationship_47.253.49.46.2022-3-17.log msgaction2_47.253.49.46.2022-3-17.log msgaction_47.253.49.46.2022-3-17.log msgtype_47.253.49.46.2022-3-17.log user_equipment_47.253.49.46.2022-3-17.log user_eudemons_47.253.49.46.2022-3-17.log user_extension_47.253.49.46.2022-3-17.log user_family_47.253.49.46.2022-3-17.log user_login_47.253.49.46.2022-3-17.log 20220317
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220317'
/bin/bash etl-log_load.sh 20220317
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220317
2022-3-17
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220317/user_login_47.253.49.46.2022-3-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220317/user_family_47.253.49.46.2022-3-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220317/user_eudemons_47.253.49.46.2022-3-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220317/user_equipment_47.253.49.46.2022-3-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220317/friend_relationship_47.253.49.46.2022-3-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220317/enemy_relationship_47.253.49.46.2022-3-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220317/user_extension_47.253.49.46.2022-3-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220317/msgaction_47.253.49.46.2022-3-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220317/msgaction2_47.253.49.46.2022-3-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220317/msgtype_47.253.49.46.2022-3-17.log': No such file or directory
++ date +%Y%m%d -d '20220317 +1day'
+ date_str=20220318
+ [[ 20220318 != \2\0\2\2\0\3\1\8 ]]
20220318
20220319
+ start_date=20220318
+ end_date=20220319
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220318
+ echo 20220318
20220318
+ [[ 20220318 != \2\0\2\2\0\3\1\9 ]]
+ echo 20220318
20220318
+ echo '/bin/bash etl-log_extract.sh 20220318'
/bin/bash etl-log_extract.sh 20220318
+ /bin/bash ../etl/log_extract.sh 20220318
2022-3-18
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-18.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-18.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-18.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-18.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220318
+ mv 'msgaction 2022-3-18.log' 'msgaction2 2022-3-18.log' 'msgtype 2022-3-18.log' 'userinfo 2022-3-18.log' 20220318
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220318'
/bin/bash etl-log_transform.sh 20220318
+ /bin/bash ../etl/log_transform.sh 20220318
2022-3-18
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220318/msgaction 2022-3-18.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220318/msgaction2 2022-3-18.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220318/msgtype 2022-3-18.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220318/userinfo 2022-3-18.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220318
+ mv enemy_relationship_47.253.49.46.2022-3-18.log friend_relationship_47.253.49.46.2022-3-18.log msgaction2_47.253.49.46.2022-3-18.log msgaction_47.253.49.46.2022-3-18.log msgtype_47.253.49.46.2022-3-18.log user_equipment_47.253.49.46.2022-3-18.log user_eudemons_47.253.49.46.2022-3-18.log user_extension_47.253.49.46.2022-3-18.log user_family_47.253.49.46.2022-3-18.log user_login_47.253.49.46.2022-3-18.log 20220318
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220318'
/bin/bash etl-log_load.sh 20220318
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220318
2022-3-18
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220318/user_login_47.253.49.46.2022-3-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220318/user_family_47.253.49.46.2022-3-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220318/user_eudemons_47.253.49.46.2022-3-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220318/user_equipment_47.253.49.46.2022-3-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220318/friend_relationship_47.253.49.46.2022-3-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220318/enemy_relationship_47.253.49.46.2022-3-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220318/user_extension_47.253.49.46.2022-3-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220318/msgaction_47.253.49.46.2022-3-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220318/msgaction2_47.253.49.46.2022-3-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220318/msgtype_47.253.49.46.2022-3-18.log': No such file or directory
++ date +%Y%m%d -d '20220318 +1day'
+ date_str=20220319
+ [[ 20220319 != \2\0\2\2\0\3\1\9 ]]
20220319
20220320
+ start_date=20220319
+ end_date=20220320
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220319
+ echo 20220319
20220319
+ [[ 20220319 != \2\0\2\2\0\3\2\0 ]]
+ echo 20220319
20220319
+ echo '/bin/bash etl-log_extract.sh 20220319'
/bin/bash etl-log_extract.sh 20220319
+ /bin/bash ../etl/log_extract.sh 20220319
2022-3-19
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-19.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-19.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-19.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-19.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220319
+ mv 'msgaction 2022-3-19.log' 'msgaction2 2022-3-19.log' 'msgtype 2022-3-19.log' 'userinfo 2022-3-19.log' 20220319
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220319'
/bin/bash etl-log_transform.sh 20220319
+ /bin/bash ../etl/log_transform.sh 20220319
2022-3-19
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220319/msgaction 2022-3-19.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220319/msgaction2 2022-3-19.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220319/msgtype 2022-3-19.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220319/userinfo 2022-3-19.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220319
+ mv enemy_relationship_47.253.49.46.2022-3-19.log friend_relationship_47.253.49.46.2022-3-19.log msgaction2_47.253.49.46.2022-3-19.log msgaction_47.253.49.46.2022-3-19.log msgtype_47.253.49.46.2022-3-19.log user_equipment_47.253.49.46.2022-3-19.log user_eudemons_47.253.49.46.2022-3-19.log user_extension_47.253.49.46.2022-3-19.log user_family_47.253.49.46.2022-3-19.log user_login_47.253.49.46.2022-3-19.log 20220319
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220319'
/bin/bash etl-log_load.sh 20220319
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220319
2022-3-19
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220319/user_login_47.253.49.46.2022-3-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220319/user_family_47.253.49.46.2022-3-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220319/user_eudemons_47.253.49.46.2022-3-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220319/user_equipment_47.253.49.46.2022-3-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220319/friend_relationship_47.253.49.46.2022-3-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220319/enemy_relationship_47.253.49.46.2022-3-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220319/user_extension_47.253.49.46.2022-3-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220319/msgaction_47.253.49.46.2022-3-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220319/msgaction2_47.253.49.46.2022-3-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220319/msgtype_47.253.49.46.2022-3-19.log': No such file or directory
++ date +%Y%m%d -d '20220319 +1day'
+ date_str=20220320
+ [[ 20220320 != \2\0\2\2\0\3\2\0 ]]
20220320
20220321
+ start_date=20220320
+ end_date=20220321
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220320
+ echo 20220320
20220320
+ [[ 20220320 != \2\0\2\2\0\3\2\1 ]]
+ echo 20220320
20220320
+ echo '/bin/bash etl-log_extract.sh 20220320'
/bin/bash etl-log_extract.sh 20220320
+ /bin/bash ../etl/log_extract.sh 20220320
2022-3-20
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-20.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-20.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-20.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-20.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220320
+ mv 'msgaction 2022-3-20.log' 'msgaction2 2022-3-20.log' 'msgtype 2022-3-20.log' 'userinfo 2022-3-20.log' 20220320
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220320'
/bin/bash etl-log_transform.sh 20220320
+ /bin/bash ../etl/log_transform.sh 20220320
2022-3-20
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220320/msgaction 2022-3-20.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220320/msgaction2 2022-3-20.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220320/msgtype 2022-3-20.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220320/userinfo 2022-3-20.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220320
+ mv enemy_relationship_47.253.49.46.2022-3-20.log friend_relationship_47.253.49.46.2022-3-20.log msgaction2_47.253.49.46.2022-3-20.log msgaction_47.253.49.46.2022-3-20.log msgtype_47.253.49.46.2022-3-20.log user_equipment_47.253.49.46.2022-3-20.log user_eudemons_47.253.49.46.2022-3-20.log user_extension_47.253.49.46.2022-3-20.log user_family_47.253.49.46.2022-3-20.log user_login_47.253.49.46.2022-3-20.log 20220320
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220320'
/bin/bash etl-log_load.sh 20220320
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220320
2022-3-20
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220320/user_login_47.253.49.46.2022-3-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220320/user_family_47.253.49.46.2022-3-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220320/user_eudemons_47.253.49.46.2022-3-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220320/user_equipment_47.253.49.46.2022-3-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220320/friend_relationship_47.253.49.46.2022-3-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220320/enemy_relationship_47.253.49.46.2022-3-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220320/user_extension_47.253.49.46.2022-3-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220320/msgaction_47.253.49.46.2022-3-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220320/msgaction2_47.253.49.46.2022-3-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220320/msgtype_47.253.49.46.2022-3-20.log': No such file or directory
++ date +%Y%m%d -d '20220320 +1day'
+ date_str=20220321
+ [[ 20220321 != \2\0\2\2\0\3\2\1 ]]
20220321
20220322
+ start_date=20220321
+ end_date=20220322
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220321
+ echo 20220321
20220321
+ [[ 20220321 != \2\0\2\2\0\3\2\2 ]]
+ echo 20220321
20220321
+ echo '/bin/bash etl-log_extract.sh 20220321'
/bin/bash etl-log_extract.sh 20220321
+ /bin/bash ../etl/log_extract.sh 20220321
2022-3-21
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-21.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-21.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-21.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-21.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220321
+ mv 'msgaction 2022-3-21.log' 'msgaction2 2022-3-21.log' 'msgtype 2022-3-21.log' 'userinfo 2022-3-21.log' 20220321
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220321'
/bin/bash etl-log_transform.sh 20220321
+ /bin/bash ../etl/log_transform.sh 20220321
2022-3-21
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220321/msgaction 2022-3-21.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220321/msgaction2 2022-3-21.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220321/msgtype 2022-3-21.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220321/userinfo 2022-3-21.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220321
+ mv enemy_relationship_47.253.49.46.2022-3-21.log friend_relationship_47.253.49.46.2022-3-21.log msgaction2_47.253.49.46.2022-3-21.log msgaction_47.253.49.46.2022-3-21.log msgtype_47.253.49.46.2022-3-21.log user_equipment_47.253.49.46.2022-3-21.log user_eudemons_47.253.49.46.2022-3-21.log user_extension_47.253.49.46.2022-3-21.log user_family_47.253.49.46.2022-3-21.log user_login_47.253.49.46.2022-3-21.log 20220321
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220321'
/bin/bash etl-log_load.sh 20220321
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220321
2022-3-21
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220321/user_login_47.253.49.46.2022-3-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220321/user_family_47.253.49.46.2022-3-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220321/user_eudemons_47.253.49.46.2022-3-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220321/user_equipment_47.253.49.46.2022-3-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220321/friend_relationship_47.253.49.46.2022-3-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220321/enemy_relationship_47.253.49.46.2022-3-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220321/user_extension_47.253.49.46.2022-3-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220321/msgaction_47.253.49.46.2022-3-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220321/msgaction2_47.253.49.46.2022-3-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220321/msgtype_47.253.49.46.2022-3-21.log': No such file or directory
++ date +%Y%m%d -d '20220321 +1day'
+ date_str=20220322
+ [[ 20220322 != \2\0\2\2\0\3\2\2 ]]
20220322
20220323
+ start_date=20220322
+ end_date=20220323
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220322
+ echo 20220322
20220322
+ [[ 20220322 != \2\0\2\2\0\3\2\3 ]]
+ echo 20220322
20220322
+ echo '/bin/bash etl-log_extract.sh 20220322'
/bin/bash etl-log_extract.sh 20220322
+ /bin/bash ../etl/log_extract.sh 20220322
2022-3-22
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-22.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-22.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-22.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-22.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220322
+ mv 'msgaction 2022-3-22.log' 'msgaction2 2022-3-22.log' 'msgtype 2022-3-22.log' 'userinfo 2022-3-22.log' 20220322
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220322'
/bin/bash etl-log_transform.sh 20220322
+ /bin/bash ../etl/log_transform.sh 20220322
2022-3-22
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220322/msgaction 2022-3-22.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220322/msgaction2 2022-3-22.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220322/msgtype 2022-3-22.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220322/userinfo 2022-3-22.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220322
+ mv enemy_relationship_47.253.49.46.2022-3-22.log friend_relationship_47.253.49.46.2022-3-22.log msgaction2_47.253.49.46.2022-3-22.log msgaction_47.253.49.46.2022-3-22.log msgtype_47.253.49.46.2022-3-22.log user_equipment_47.253.49.46.2022-3-22.log user_eudemons_47.253.49.46.2022-3-22.log user_extension_47.253.49.46.2022-3-22.log user_family_47.253.49.46.2022-3-22.log user_login_47.253.49.46.2022-3-22.log 20220322
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220322'
/bin/bash etl-log_load.sh 20220322
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220322
2022-3-22
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220322/user_login_47.253.49.46.2022-3-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220322/user_family_47.253.49.46.2022-3-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220322/user_eudemons_47.253.49.46.2022-3-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220322/user_equipment_47.253.49.46.2022-3-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220322/friend_relationship_47.253.49.46.2022-3-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220322/enemy_relationship_47.253.49.46.2022-3-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220322/user_extension_47.253.49.46.2022-3-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220322/msgaction_47.253.49.46.2022-3-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220322/msgaction2_47.253.49.46.2022-3-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220322/msgtype_47.253.49.46.2022-3-22.log': No such file or directory
++ date +%Y%m%d -d '20220322 +1day'
+ date_str=20220323
+ [[ 20220323 != \2\0\2\2\0\3\2\3 ]]
20220323
20220324
+ start_date=20220323
+ end_date=20220324
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220323
+ echo 20220323
20220323
+ [[ 20220323 != \2\0\2\2\0\3\2\4 ]]
+ echo 20220323
20220323
+ echo '/bin/bash etl-log_extract.sh 20220323'
/bin/bash etl-log_extract.sh 20220323
+ /bin/bash ../etl/log_extract.sh 20220323
2022-3-23
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-23.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-23.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-23.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-23.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220323
+ mv 'msgaction 2022-3-23.log' 'msgaction2 2022-3-23.log' 'msgtype 2022-3-23.log' 'userinfo 2022-3-23.log' 20220323
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220323'
/bin/bash etl-log_transform.sh 20220323
+ /bin/bash ../etl/log_transform.sh 20220323
2022-3-23
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220323/msgaction 2022-3-23.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220323/msgaction2 2022-3-23.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220323/msgtype 2022-3-23.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220323/userinfo 2022-3-23.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220323
+ mv enemy_relationship_47.253.49.46.2022-3-23.log friend_relationship_47.253.49.46.2022-3-23.log msgaction2_47.253.49.46.2022-3-23.log msgaction_47.253.49.46.2022-3-23.log msgtype_47.253.49.46.2022-3-23.log user_equipment_47.253.49.46.2022-3-23.log user_eudemons_47.253.49.46.2022-3-23.log user_extension_47.253.49.46.2022-3-23.log user_family_47.253.49.46.2022-3-23.log user_login_47.253.49.46.2022-3-23.log 20220323
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220323'
/bin/bash etl-log_load.sh 20220323
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220323
2022-3-23
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220323/user_login_47.253.49.46.2022-3-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220323/user_family_47.253.49.46.2022-3-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220323/user_eudemons_47.253.49.46.2022-3-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220323/user_equipment_47.253.49.46.2022-3-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220323/friend_relationship_47.253.49.46.2022-3-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220323/enemy_relationship_47.253.49.46.2022-3-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220323/user_extension_47.253.49.46.2022-3-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220323/msgaction_47.253.49.46.2022-3-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220323/msgaction2_47.253.49.46.2022-3-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220323/msgtype_47.253.49.46.2022-3-23.log': No such file or directory
++ date +%Y%m%d -d '20220323 +1day'
+ date_str=20220324
+ [[ 20220324 != \2\0\2\2\0\3\2\4 ]]
20220324
20220325
+ start_date=20220324
+ end_date=20220325
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220324
+ echo 20220324
20220324
+ [[ 20220324 != \2\0\2\2\0\3\2\5 ]]
+ echo 20220324
20220324
+ echo '/bin/bash etl-log_extract.sh 20220324'
/bin/bash etl-log_extract.sh 20220324
+ /bin/bash ../etl/log_extract.sh 20220324
2022-3-24
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-24.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-24.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-24.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-24.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220324
+ mv 'msgaction 2022-3-24.log' 'msgaction2 2022-3-24.log' 'msgtype 2022-3-24.log' 'userinfo 2022-3-24.log' 20220324
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220324'
/bin/bash etl-log_transform.sh 20220324
+ /bin/bash ../etl/log_transform.sh 20220324
2022-3-24
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220324/msgaction 2022-3-24.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220324/msgaction2 2022-3-24.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220324/msgtype 2022-3-24.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220324/userinfo 2022-3-24.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220324
+ mv enemy_relationship_47.253.49.46.2022-3-24.log friend_relationship_47.253.49.46.2022-3-24.log msgaction2_47.253.49.46.2022-3-24.log msgaction_47.253.49.46.2022-3-24.log msgtype_47.253.49.46.2022-3-24.log user_equipment_47.253.49.46.2022-3-24.log user_eudemons_47.253.49.46.2022-3-24.log user_extension_47.253.49.46.2022-3-24.log user_family_47.253.49.46.2022-3-24.log user_login_47.253.49.46.2022-3-24.log 20220324
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220324'
/bin/bash etl-log_load.sh 20220324
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220324
2022-3-24
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220324/user_login_47.253.49.46.2022-3-24.log': No such file or directory
22/03/25 04:03:13 INFO hdfs.DataStreamer: Exception in createBlockOutputStream
java.net.SocketTimeoutException: 70000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/192.168.19.25:47357 remote=/192.168.19.26:11001]
	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at java.io.DataInputStream.read(DataInputStream.java:149)
	at java.io.DataInputStream.readFully(DataInputStream.java:195)
	at java.io.DataInputStream.readFully(DataInputStream.java:169)
	at org.apache.hadoop.security.SaslInputStream.readMoreData(SaslInputStream.java:97)
	at org.apache.hadoop.security.SaslInputStream.read(SaslInputStream.java:202)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at org.apache.hadoop.hdfs.protocolPB.PBHelperClient.vintPrefixed(PBHelperClient.java:454)
	at org.apache.hadoop.hdfs.DataStreamer.createBlockOutputStream(DataStreamer.java:1734)
	at org.apache.hadoop.hdfs.DataStreamer.nextBlockOutputStream(DataStreamer.java:1655)
	at org.apache.hadoop.hdfs.DataStreamer.run(DataStreamer.java:710)
22/03/25 04:03:13 WARN hdfs.DataStreamer: Abandoning BP-589364582-192.168.19.25-1618816133583:blk_1092979286_19290320
22/03/25 04:03:13 WARN hdfs.DataStreamer: Excluding datanode DatanodeInfoWithStorage[192.168.19.26:11001,DS-87d3351a-f1d4-41f3-8126-07fb1ef12d6a,DISK]
22/03/25 04:03:13 WARN hdfs.DataStreamer: Slow waitForAckedSeqno took 72522ms (threshold=30000ms). File being written: /user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220324/user_login_47.253.49.46.2022-3-24.log._COPYING_, block: BP-589364582-192.168.19.25-1618816133583:blk_1092979289_19290323, Write pipeline datanodes: [DatanodeInfoWithStorage[192.168.19.44:11001,DS-b45254f8-c84b-4dcd-b605-3950cba6a54c,DISK]].
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220324/user_family_47.253.49.46.2022-3-24.log': No such file or directory
22/03/25 04:04:35 INFO hdfs.DataStreamer: Exception in createBlockOutputStream
java.net.SocketTimeoutException: 70000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/192.168.19.25:47368 remote=/192.168.19.26:11001]
	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at java.io.DataInputStream.read(DataInputStream.java:149)
	at java.io.DataInputStream.readFully(DataInputStream.java:195)
	at java.io.DataInputStream.readFully(DataInputStream.java:169)
	at org.apache.hadoop.security.SaslInputStream.readMoreData(SaslInputStream.java:97)
	at org.apache.hadoop.security.SaslInputStream.read(SaslInputStream.java:202)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at org.apache.hadoop.hdfs.protocolPB.PBHelperClient.vintPrefixed(PBHelperClient.java:454)
	at org.apache.hadoop.hdfs.DataStreamer.createBlockOutputStream(DataStreamer.java:1734)
	at org.apache.hadoop.hdfs.DataStreamer.nextBlockOutputStream(DataStreamer.java:1655)
	at org.apache.hadoop.hdfs.DataStreamer.run(DataStreamer.java:710)
22/03/25 04:04:35 WARN hdfs.DataStreamer: Abandoning BP-589364582-192.168.19.25-1618816133583:blk_1092979290_19290324
22/03/25 04:04:35 WARN hdfs.DataStreamer: Excluding datanode DatanodeInfoWithStorage[192.168.19.26:11001,DS-87d3351a-f1d4-41f3-8126-07fb1ef12d6a,DISK]
22/03/25 04:04:35 WARN hdfs.DataStreamer: Slow waitForAckedSeqno took 76662ms (threshold=30000ms). File being written: /user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220324/user_family_47.253.49.46.2022-3-24.log._COPYING_, block: BP-589364582-192.168.19.25-1618816133583:blk_1092979295_19290329, Write pipeline datanodes: [DatanodeInfoWithStorage[192.168.19.44:11001,DS-b45254f8-c84b-4dcd-b605-3950cba6a54c,DISK]].
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220324/user_eudemons_47.253.49.46.2022-3-24.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220324/user_equipment_47.253.49.46.2022-3-24.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220324/friend_relationship_47.253.49.46.2022-3-24.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220324/enemy_relationship_47.253.49.46.2022-3-24.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220324/user_extension_47.253.49.46.2022-3-24.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220324/msgaction_47.253.49.46.2022-3-24.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220324/msgaction2_47.253.49.46.2022-3-24.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220324/msgtype_47.253.49.46.2022-3-24.log': No such file or directory
++ date +%Y%m%d -d '20220324 +1day'
+ date_str=20220325
+ [[ 20220325 != \2\0\2\2\0\3\2\5 ]]
20220325
20220326
+ start_date=20220325
+ end_date=20220326
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220325
+ echo 20220325
20220325
+ [[ 20220325 != \2\0\2\2\0\3\2\6 ]]
+ echo 20220325
20220325
+ echo '/bin/bash etl-log_extract.sh 20220325'
/bin/bash etl-log_extract.sh 20220325
+ /bin/bash ../etl/log_extract.sh 20220325
2022-3-25
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-25.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-25.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-25.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-25.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220325
+ mv 'msgaction 2022-3-25.log' 'msgaction2 2022-3-25.log' 'msgtype 2022-3-25.log' 'userinfo 2022-3-25.log' 20220325
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220325'
/bin/bash etl-log_transform.sh 20220325
+ /bin/bash ../etl/log_transform.sh 20220325
2022-3-25
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220325/msgaction 2022-3-25.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220325/msgaction2 2022-3-25.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220325/msgtype 2022-3-25.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220325/userinfo 2022-3-25.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220325
+ mv enemy_relationship_47.253.49.46.2022-3-25.log friend_relationship_47.253.49.46.2022-3-25.log msgaction2_47.253.49.46.2022-3-25.log msgaction_47.253.49.46.2022-3-25.log msgtype_47.253.49.46.2022-3-25.log user_equipment_47.253.49.46.2022-3-25.log user_eudemons_47.253.49.46.2022-3-25.log user_extension_47.253.49.46.2022-3-25.log user_family_47.253.49.46.2022-3-25.log user_login_47.253.49.46.2022-3-25.log 20220325
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220325'
/bin/bash etl-log_load.sh 20220325
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220325
2022-3-25
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220325/user_login_47.253.49.46.2022-3-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220325/user_family_47.253.49.46.2022-3-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220325/user_eudemons_47.253.49.46.2022-3-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220325/user_equipment_47.253.49.46.2022-3-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220325/friend_relationship_47.253.49.46.2022-3-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220325/enemy_relationship_47.253.49.46.2022-3-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220325/user_extension_47.253.49.46.2022-3-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220325/msgaction_47.253.49.46.2022-3-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220325/msgaction2_47.253.49.46.2022-3-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220325/msgtype_47.253.49.46.2022-3-25.log': No such file or directory
++ date +%Y%m%d -d '20220325 +1day'
+ date_str=20220326
+ [[ 20220326 != \2\0\2\2\0\3\2\6 ]]
20220326
20220327
+ start_date=20220326
+ end_date=20220327
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220326
+ echo 20220326
20220326
+ [[ 20220326 != \2\0\2\2\0\3\2\7 ]]
+ echo 20220326
20220326
+ echo '/bin/bash etl-log_extract.sh 20220326'
/bin/bash etl-log_extract.sh 20220326
+ /bin/bash ../etl/log_extract.sh 20220326
2022-3-26
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-26.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-26.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-26.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-26.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220326
+ mv 'msgaction 2022-3-26.log' 'msgaction2 2022-3-26.log' 'msgtype 2022-3-26.log' 'userinfo 2022-3-26.log' 20220326
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220326'
/bin/bash etl-log_transform.sh 20220326
+ /bin/bash ../etl/log_transform.sh 20220326
2022-3-26
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220326/msgaction 2022-3-26.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220326/msgaction2 2022-3-26.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220326/msgtype 2022-3-26.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220326/userinfo 2022-3-26.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220326
+ mv enemy_relationship_47.253.49.46.2022-3-26.log friend_relationship_47.253.49.46.2022-3-26.log msgaction2_47.253.49.46.2022-3-26.log msgaction_47.253.49.46.2022-3-26.log msgtype_47.253.49.46.2022-3-26.log user_equipment_47.253.49.46.2022-3-26.log user_eudemons_47.253.49.46.2022-3-26.log user_extension_47.253.49.46.2022-3-26.log user_family_47.253.49.46.2022-3-26.log user_login_47.253.49.46.2022-3-26.log 20220326
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220326'
/bin/bash etl-log_load.sh 20220326
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220326
2022-3-26
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220326/user_login_47.253.49.46.2022-3-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220326/user_family_47.253.49.46.2022-3-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220326/user_eudemons_47.253.49.46.2022-3-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220326/user_equipment_47.253.49.46.2022-3-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220326/friend_relationship_47.253.49.46.2022-3-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220326/enemy_relationship_47.253.49.46.2022-3-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220326/user_extension_47.253.49.46.2022-3-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220326/msgaction_47.253.49.46.2022-3-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220326/msgaction2_47.253.49.46.2022-3-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220326/msgtype_47.253.49.46.2022-3-26.log': No such file or directory
++ date +%Y%m%d -d '20220326 +1day'
+ date_str=20220327
+ [[ 20220327 != \2\0\2\2\0\3\2\7 ]]
20220327
20220328
+ start_date=20220327
+ end_date=20220328
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220327
+ echo 20220327
20220327
+ [[ 20220327 != \2\0\2\2\0\3\2\8 ]]
+ echo 20220327
20220327
+ echo '/bin/bash etl-log_extract.sh 20220327'
/bin/bash etl-log_extract.sh 20220327
+ /bin/bash ../etl/log_extract.sh 20220327
2022-3-27
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-27.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-27.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-27.log"
Traceback (most recent call last):
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 852, in _read_response
    t, data = self._read_packet()
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp.py", line 201, in _read_packet
    x = self._read_all(4)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp.py", line 188, in _read_all
    raise EOFError()
EOFError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 42, in <module>
    client.download_file(
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 32, in download_file
    self.client.get(remote_file, local_file)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 811, in get
    size = self.getfo(remotepath, fl, callback, prefetch)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 786, in getfo
    return self._transfer_with_callback(
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 678, in _transfer_with_callback
    data = reader.read(32768)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/file.py", line 219, in read
    new_data = self._read(read_size)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_file.py", line 182, in _read
    data = self._read_prefetch(size)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_file.py", line 162, in _read_prefetch
    self.sftp._read_response()
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 854, in _read_response
    raise SSHException("Server connection dropped: {}".format(e))
paramiko.ssh_exception.SSHException: Server connection dropped: 
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgtype 2022-3-27.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220327
+ mv 'msgaction 2022-3-27.log' 'msgaction2 2022-3-27.log' 'msgtype 2022-3-27.log' 20220327
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220327'
/bin/bash etl-log_transform.sh 20220327
+ /bin/bash ../etl/log_transform.sh 20220327
2022-3-27
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220327/msgaction 2022-3-27.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220327/msgaction2 2022-3-27.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220327/msgtype 2022-3-27.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 103, in transform_msgtype
    msg_time = get_time_from_english_moyu(str_list[3], host)
IndexError: list index out of range

start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220327/userinfo 2022-3-27.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220327/userinfo 2022-3-27.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220327
+ mv msgaction2_47.253.49.46.2022-3-27.log msgaction_47.253.49.46.2022-3-27.log msgtype_47.253.49.46.2022-3-27.log 20220327
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220327'
/bin/bash etl-log_load.sh 20220327
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220327
2022-3-27
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220327/msgaction_47.253.49.46.2022-3-27.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220327/msgaction2_47.253.49.46.2022-3-27.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220327/msgtype_47.253.49.46.2022-3-27.log': No such file or directory
++ date +%Y%m%d -d '20220327 +1day'
+ date_str=20220328
+ [[ 20220328 != \2\0\2\2\0\3\2\8 ]]
20220328
20220329
+ start_date=20220328
+ end_date=20220329
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220328
+ echo 20220328
20220328
+ [[ 20220328 != \2\0\2\2\0\3\2\9 ]]
+ echo 20220328
20220328
+ echo '/bin/bash etl-log_extract.sh 20220328'
/bin/bash etl-log_extract.sh 20220328
+ /bin/bash ../etl/log_extract.sh 20220328
2022-3-28
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-28.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-28.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-28.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-28.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220328
+ mv 'msgaction 2022-3-28.log' 'msgaction2 2022-3-28.log' 'msgtype 2022-3-28.log' 'userinfo 2022-3-28.log' 20220328
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220328'
/bin/bash etl-log_transform.sh 20220328
+ /bin/bash ../etl/log_transform.sh 20220328
2022-3-28
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220328/msgaction 2022-3-28.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220328/msgaction2 2022-3-28.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220328/msgtype 2022-3-28.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220328/userinfo 2022-3-28.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220328
+ mv enemy_relationship_47.253.49.46.2022-3-28.log friend_relationship_47.253.49.46.2022-3-28.log msgaction2_47.253.49.46.2022-3-28.log msgaction_47.253.49.46.2022-3-28.log msgtype_47.253.49.46.2022-3-28.log user_equipment_47.253.49.46.2022-3-28.log user_eudemons_47.253.49.46.2022-3-28.log user_extension_47.253.49.46.2022-3-28.log user_family_47.253.49.46.2022-3-28.log user_login_47.253.49.46.2022-3-28.log 20220328
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220328'
/bin/bash etl-log_load.sh 20220328
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220328
2022-3-28
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220328/user_login_47.253.49.46.2022-3-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220328/user_family_47.253.49.46.2022-3-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220328/user_eudemons_47.253.49.46.2022-3-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220328/user_equipment_47.253.49.46.2022-3-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220328/friend_relationship_47.253.49.46.2022-3-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220328/enemy_relationship_47.253.49.46.2022-3-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220328/user_extension_47.253.49.46.2022-3-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220328/msgaction_47.253.49.46.2022-3-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220328/msgaction2_47.253.49.46.2022-3-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220328/msgtype_47.253.49.46.2022-3-28.log': No such file or directory
++ date +%Y%m%d -d '20220328 +1day'
+ date_str=20220329
+ [[ 20220329 != \2\0\2\2\0\3\2\9 ]]
20220329
20220330
+ start_date=20220329
+ end_date=20220330
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220329
+ echo 20220329
20220329
+ [[ 20220329 != \2\0\2\2\0\3\3\0 ]]
+ echo 20220329
20220329
+ echo '/bin/bash etl-log_extract.sh 20220329'
/bin/bash etl-log_extract.sh 20220329
+ /bin/bash ../etl/log_extract.sh 20220329
2022-3-29
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-29.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-29.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-29.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-29.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220329
+ mv 'msgaction 2022-3-29.log' 'msgaction2 2022-3-29.log' 'msgtype 2022-3-29.log' 'userinfo 2022-3-29.log' 20220329
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220329'
/bin/bash etl-log_transform.sh 20220329
+ /bin/bash ../etl/log_transform.sh 20220329
2022-3-29
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220329/msgaction 2022-3-29.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220329/msgaction2 2022-3-29.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220329/msgtype 2022-3-29.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220329/userinfo 2022-3-29.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220329
+ mv enemy_relationship_47.253.49.46.2022-3-29.log friend_relationship_47.253.49.46.2022-3-29.log msgaction2_47.253.49.46.2022-3-29.log msgaction_47.253.49.46.2022-3-29.log msgtype_47.253.49.46.2022-3-29.log user_equipment_47.253.49.46.2022-3-29.log user_eudemons_47.253.49.46.2022-3-29.log user_extension_47.253.49.46.2022-3-29.log user_family_47.253.49.46.2022-3-29.log user_login_47.253.49.46.2022-3-29.log 20220329
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220329'
/bin/bash etl-log_load.sh 20220329
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220329
2022-3-29
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220329/user_login_47.253.49.46.2022-3-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220329/user_family_47.253.49.46.2022-3-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220329/user_eudemons_47.253.49.46.2022-3-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220329/user_equipment_47.253.49.46.2022-3-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220329/friend_relationship_47.253.49.46.2022-3-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220329/enemy_relationship_47.253.49.46.2022-3-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220329/user_extension_47.253.49.46.2022-3-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220329/msgaction_47.253.49.46.2022-3-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220329/msgaction2_47.253.49.46.2022-3-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220329/msgtype_47.253.49.46.2022-3-29.log': No such file or directory
++ date +%Y%m%d -d '20220329 +1day'
+ date_str=20220330
+ [[ 20220330 != \2\0\2\2\0\3\3\0 ]]
20220330
20220331
+ start_date=20220330
+ end_date=20220331
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220330
+ echo 20220330
20220330
+ [[ 20220330 != \2\0\2\2\0\3\3\1 ]]
+ echo 20220330
20220330
+ echo '/bin/bash etl-log_extract.sh 20220330'
/bin/bash etl-log_extract.sh 20220330
+ /bin/bash ../etl/log_extract.sh 20220330
2022-3-30
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-30.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-30.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-30.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-30.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220330
+ mv 'msgaction 2022-3-30.log' 'msgaction2 2022-3-30.log' 'msgtype 2022-3-30.log' 'userinfo 2022-3-30.log' 20220330
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220330'
/bin/bash etl-log_transform.sh 20220330
+ /bin/bash ../etl/log_transform.sh 20220330
2022-3-30
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220330/msgaction 2022-3-30.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220330/msgaction2 2022-3-30.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220330/msgtype 2022-3-30.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220330/userinfo 2022-3-30.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220330
+ mv enemy_relationship_47.253.49.46.2022-3-30.log friend_relationship_47.253.49.46.2022-3-30.log msgaction2_47.253.49.46.2022-3-30.log msgaction_47.253.49.46.2022-3-30.log msgtype_47.253.49.46.2022-3-30.log user_equipment_47.253.49.46.2022-3-30.log user_eudemons_47.253.49.46.2022-3-30.log user_extension_47.253.49.46.2022-3-30.log user_family_47.253.49.46.2022-3-30.log user_login_47.253.49.46.2022-3-30.log 20220330
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220330'
/bin/bash etl-log_load.sh 20220330
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220330
2022-3-30
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220330/user_login_47.253.49.46.2022-3-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220330/user_family_47.253.49.46.2022-3-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220330/user_eudemons_47.253.49.46.2022-3-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220330/user_equipment_47.253.49.46.2022-3-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220330/friend_relationship_47.253.49.46.2022-3-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220330/enemy_relationship_47.253.49.46.2022-3-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220330/user_extension_47.253.49.46.2022-3-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220330/msgaction_47.253.49.46.2022-3-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220330/msgaction2_47.253.49.46.2022-3-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220330/msgtype_47.253.49.46.2022-3-30.log': No such file or directory
++ date +%Y%m%d -d '20220330 +1day'
+ date_str=20220331
+ [[ 20220331 != \2\0\2\2\0\3\3\1 ]]
20220331
20220401
+ start_date=20220331
+ end_date=20220401
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220331
+ echo 20220331
20220331
+ [[ 20220331 != \2\0\2\2\0\4\0\1 ]]
+ echo 20220331
20220331
+ echo '/bin/bash etl-log_extract.sh 20220331'
/bin/bash etl-log_extract.sh 20220331
+ /bin/bash ../etl/log_extract.sh 20220331
2022-3-31
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-3-31.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-3-31.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-3-31.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-3-31.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220331
+ mv 'msgaction 2022-3-31.log' 'msgaction2 2022-3-31.log' 'msgtype 2022-3-31.log' 'userinfo 2022-3-31.log' 20220331
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220331'
/bin/bash etl-log_transform.sh 20220331
+ /bin/bash ../etl/log_transform.sh 20220331
2022-3-31
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220331/msgaction 2022-3-31.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220331/msgaction2 2022-3-31.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220331/msgtype 2022-3-31.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220331/userinfo 2022-3-31.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220331
+ mv enemy_relationship_47.253.49.46.2022-3-31.log friend_relationship_47.253.49.46.2022-3-31.log msgaction2_47.253.49.46.2022-3-31.log msgaction_47.253.49.46.2022-3-31.log msgtype_47.253.49.46.2022-3-31.log user_equipment_47.253.49.46.2022-3-31.log user_eudemons_47.253.49.46.2022-3-31.log user_extension_47.253.49.46.2022-3-31.log user_family_47.253.49.46.2022-3-31.log user_login_47.253.49.46.2022-3-31.log 20220331
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220331'
/bin/bash etl-log_load.sh 20220331
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220331
2022-3-31
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220331/user_login_47.253.49.46.2022-3-31.log': No such file or directory
22/04/01 04:02:28 INFO hdfs.DataStreamer: Exception in createBlockOutputStream
java.net.SocketTimeoutException: 70000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/192.168.19.25:45527 remote=/192.168.19.26:11001]
	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at java.io.DataInputStream.read(DataInputStream.java:149)
	at java.io.DataInputStream.readFully(DataInputStream.java:195)
	at java.io.DataInputStream.readFully(DataInputStream.java:169)
	at org.apache.hadoop.security.SaslInputStream.readMoreData(SaslInputStream.java:97)
	at org.apache.hadoop.security.SaslInputStream.read(SaslInputStream.java:202)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at org.apache.hadoop.hdfs.protocolPB.PBHelperClient.vintPrefixed(PBHelperClient.java:454)
	at org.apache.hadoop.hdfs.DataStreamer.createBlockOutputStream(DataStreamer.java:1734)
	at org.apache.hadoop.hdfs.DataStreamer.nextBlockOutputStream(DataStreamer.java:1655)
	at org.apache.hadoop.hdfs.DataStreamer.run(DataStreamer.java:710)
22/04/01 04:02:28 WARN hdfs.DataStreamer: Abandoning BP-589364582-192.168.19.25-1618816133583:blk_1093059358_19370451
22/04/01 04:02:28 WARN hdfs.DataStreamer: Excluding datanode DatanodeInfoWithStorage[192.168.19.26:11001,DS-87d3351a-f1d4-41f3-8126-07fb1ef12d6a,DISK]
22/04/01 04:02:28 WARN hdfs.DataStreamer: Slow waitForAckedSeqno took 72978ms (threshold=30000ms). File being written: /user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220331/user_login_47.253.49.46.2022-3-31.log._COPYING_, block: BP-589364582-192.168.19.25-1618816133583:blk_1093059361_19370455, Write pipeline datanodes: [DatanodeInfoWithStorage[192.168.19.44:11001,DS-b45254f8-c84b-4dcd-b605-3950cba6a54c,DISK]].
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220331/user_family_47.253.49.46.2022-3-31.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220331/user_eudemons_47.253.49.46.2022-3-31.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220331/user_equipment_47.253.49.46.2022-3-31.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220331/friend_relationship_47.253.49.46.2022-3-31.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220331/enemy_relationship_47.253.49.46.2022-3-31.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220331/user_extension_47.253.49.46.2022-3-31.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220331/msgaction_47.253.49.46.2022-3-31.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220331/msgaction2_47.253.49.46.2022-3-31.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220331/msgtype_47.253.49.46.2022-3-31.log': No such file or directory
++ date +%Y%m%d -d '20220331 +1day'
+ date_str=20220401
+ [[ 20220401 != \2\0\2\2\0\4\0\1 ]]
20220401
20220402
+ start_date=20220401
+ end_date=20220402
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220401
+ echo 20220401
20220401
+ [[ 20220401 != \2\0\2\2\0\4\0\2 ]]
+ echo 20220401
20220401
+ echo '/bin/bash etl-log_extract.sh 20220401'
/bin/bash etl-log_extract.sh 20220401
+ /bin/bash ../etl/log_extract.sh 20220401
2022-4-1
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-1.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-1.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-1.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-1.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220401
+ mv 'msgaction 2022-4-1.log' 'msgaction2 2022-4-1.log' 'msgtype 2022-4-1.log' 'userinfo 2022-4-1.log' 20220401
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220401'
/bin/bash etl-log_transform.sh 20220401
+ /bin/bash ../etl/log_transform.sh 20220401
2022-4-1
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220401/msgaction 2022-4-1.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220401/msgaction2 2022-4-1.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220401/msgtype 2022-4-1.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220401/userinfo 2022-4-1.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220401
+ mv enemy_relationship_47.253.49.46.2022-4-1.log friend_relationship_47.253.49.46.2022-4-1.log msgaction2_47.253.49.46.2022-4-1.log msgaction_47.253.49.46.2022-4-1.log msgtype_47.253.49.46.2022-4-1.log user_equipment_47.253.49.46.2022-4-1.log user_eudemons_47.253.49.46.2022-4-1.log user_extension_47.253.49.46.2022-4-1.log user_family_47.253.49.46.2022-4-1.log user_login_47.253.49.46.2022-4-1.log 20220401
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220401'
/bin/bash etl-log_load.sh 20220401
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220401
2022-4-1
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220401/user_login_47.253.49.46.2022-4-1.log': No such file or directory
22/04/02 04:02:32 WARN hdfs.DataStreamer: Slow waitForAckedSeqno took 64978ms (threshold=30000ms). File being written: /user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220401/user_login_47.253.49.46.2022-4-1.log._COPYING_, block: BP-589364582-192.168.19.25-1618816133583:blk_1093081055_19392158, Write pipeline datanodes: [DatanodeInfoWithStorage[192.168.19.26:11001,DS-87d3351a-f1d4-41f3-8126-07fb1ef12d6a,DISK], DatanodeInfoWithStorage[192.168.19.44:11001,DS-b45254f8-c84b-4dcd-b605-3950cba6a54c,DISK]].
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220401/user_family_47.253.49.46.2022-4-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220401/user_eudemons_47.253.49.46.2022-4-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220401/user_equipment_47.253.49.46.2022-4-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220401/friend_relationship_47.253.49.46.2022-4-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220401/enemy_relationship_47.253.49.46.2022-4-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220401/user_extension_47.253.49.46.2022-4-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220401/msgaction_47.253.49.46.2022-4-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220401/msgaction2_47.253.49.46.2022-4-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220401/msgtype_47.253.49.46.2022-4-1.log': No such file or directory
++ date +%Y%m%d -d '20220401 +1day'
+ date_str=20220402
+ [[ 20220402 != \2\0\2\2\0\4\0\2 ]]
20220402
20220403
+ start_date=20220402
+ end_date=20220403
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220402
+ echo 20220402
20220402
+ [[ 20220402 != \2\0\2\2\0\4\0\3 ]]
+ echo 20220402
20220402
+ echo '/bin/bash etl-log_extract.sh 20220402'
/bin/bash etl-log_extract.sh 20220402
+ /bin/bash ../etl/log_extract.sh 20220402
2022-4-2
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-2.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-2.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-2.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-2.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220402
+ mv 'msgaction 2022-4-2.log' 'msgaction2 2022-4-2.log' 'msgtype 2022-4-2.log' 'userinfo 2022-4-2.log' 20220402
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220402'
/bin/bash etl-log_transform.sh 20220402
+ /bin/bash ../etl/log_transform.sh 20220402
2022-4-2
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220402/msgaction 2022-4-2.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220402/msgaction2 2022-4-2.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220402/msgtype 2022-4-2.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220402/userinfo 2022-4-2.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220402
+ mv enemy_relationship_47.253.49.46.2022-4-2.log friend_relationship_47.253.49.46.2022-4-2.log msgaction2_47.253.49.46.2022-4-2.log msgaction_47.253.49.46.2022-4-2.log msgtype_47.253.49.46.2022-4-2.log user_equipment_47.253.49.46.2022-4-2.log user_eudemons_47.253.49.46.2022-4-2.log user_extension_47.253.49.46.2022-4-2.log user_family_47.253.49.46.2022-4-2.log user_login_47.253.49.46.2022-4-2.log 20220402
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220402'
/bin/bash etl-log_load.sh 20220402
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220402
2022-4-2
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220402/user_login_47.253.49.46.2022-4-2.log': No such file or directory
22/04/03 04:02:52 INFO hdfs.DataStreamer: Exception in createBlockOutputStream
java.net.SocketTimeoutException: 70000 millis timeout while waiting for channel to be ready for read. ch : java.nio.channels.SocketChannel[connected local=/192.168.19.25:54922 remote=/192.168.19.26:11001]
	at org.apache.hadoop.net.SocketIOWithTimeout.doIO(SocketIOWithTimeout.java:164)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:161)
	at org.apache.hadoop.net.SocketInputStream.read(SocketInputStream.java:131)
	at java.io.FilterInputStream.read(FilterInputStream.java:133)
	at java.io.DataInputStream.read(DataInputStream.java:149)
	at java.io.DataInputStream.readFully(DataInputStream.java:195)
	at java.io.DataInputStream.readFully(DataInputStream.java:169)
	at org.apache.hadoop.security.SaslInputStream.readMoreData(SaslInputStream.java:97)
	at org.apache.hadoop.security.SaslInputStream.read(SaslInputStream.java:202)
	at java.io.FilterInputStream.read(FilterInputStream.java:83)
	at org.apache.hadoop.hdfs.protocolPB.PBHelperClient.vintPrefixed(PBHelperClient.java:454)
	at org.apache.hadoop.hdfs.DataStreamer.createBlockOutputStream(DataStreamer.java:1734)
	at org.apache.hadoop.hdfs.DataStreamer.nextBlockOutputStream(DataStreamer.java:1655)
	at org.apache.hadoop.hdfs.DataStreamer.run(DataStreamer.java:710)
22/04/03 04:02:52 WARN hdfs.DataStreamer: Abandoning BP-589364582-192.168.19.25-1618816133583:blk_1093103050_19414162
22/04/03 04:02:52 WARN hdfs.DataStreamer: Excluding datanode DatanodeInfoWithStorage[192.168.19.26:11001,DS-87d3351a-f1d4-41f3-8126-07fb1ef12d6a,DISK]
22/04/03 04:02:52 WARN hdfs.DataStreamer: Slow waitForAckedSeqno took 75427ms (threshold=30000ms). File being written: /user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220402/user_login_47.253.49.46.2022-4-2.log._COPYING_, block: BP-589364582-192.168.19.25-1618816133583:blk_1093103054_19414166, Write pipeline datanodes: [DatanodeInfoWithStorage[192.168.19.44:11001,DS-b45254f8-c84b-4dcd-b605-3950cba6a54c,DISK]].
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220402/user_family_47.253.49.46.2022-4-2.log': No such file or directory
22/04/03 04:03:51 WARN hdfs.DataStreamer: Slow waitForAckedSeqno took 53422ms (threshold=30000ms). File being written: /user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220402/user_family_47.253.49.46.2022-4-2.log._COPYING_, block: BP-589364582-192.168.19.25-1618816133583:blk_1093103055_19414167, Write pipeline datanodes: [DatanodeInfoWithStorage[192.168.19.44:11001,DS-b45254f8-c84b-4dcd-b605-3950cba6a54c,DISK], DatanodeInfoWithStorage[192.168.19.26:11001,DS-87d3351a-f1d4-41f3-8126-07fb1ef12d6a,DISK]].
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220402/user_eudemons_47.253.49.46.2022-4-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220402/user_equipment_47.253.49.46.2022-4-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220402/friend_relationship_47.253.49.46.2022-4-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220402/enemy_relationship_47.253.49.46.2022-4-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220402/user_extension_47.253.49.46.2022-4-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220402/msgaction_47.253.49.46.2022-4-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220402/msgaction2_47.253.49.46.2022-4-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220402/msgtype_47.253.49.46.2022-4-2.log': No such file or directory
++ date +%Y%m%d -d '20220402 +1day'
+ date_str=20220403
+ [[ 20220403 != \2\0\2\2\0\4\0\3 ]]
20220403
20220404
+ start_date=20220403
+ end_date=20220404
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220403
+ echo 20220403
20220403
+ [[ 20220403 != \2\0\2\2\0\4\0\4 ]]
+ echo 20220403
20220403
+ echo '/bin/bash etl-log_extract.sh 20220403'
/bin/bash etl-log_extract.sh 20220403
+ /bin/bash ../etl/log_extract.sh 20220403
2022-4-3
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-3.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-3.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-3.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-3.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220403
+ mv 'msgaction 2022-4-3.log' 'msgaction2 2022-4-3.log' 'msgtype 2022-4-3.log' 'userinfo 2022-4-3.log' 20220403
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220403'
/bin/bash etl-log_transform.sh 20220403
+ /bin/bash ../etl/log_transform.sh 20220403
2022-4-3
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220403/msgaction 2022-4-3.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220403/msgaction2 2022-4-3.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220403/msgtype 2022-4-3.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220403/userinfo 2022-4-3.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220403
+ mv enemy_relationship_47.253.49.46.2022-4-3.log friend_relationship_47.253.49.46.2022-4-3.log msgaction2_47.253.49.46.2022-4-3.log msgaction_47.253.49.46.2022-4-3.log msgtype_47.253.49.46.2022-4-3.log user_equipment_47.253.49.46.2022-4-3.log user_eudemons_47.253.49.46.2022-4-3.log user_extension_47.253.49.46.2022-4-3.log user_family_47.253.49.46.2022-4-3.log user_login_47.253.49.46.2022-4-3.log 20220403
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220403'
/bin/bash etl-log_load.sh 20220403
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220403
2022-4-3
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220403/user_login_47.253.49.46.2022-4-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220403/user_family_47.253.49.46.2022-4-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220403/user_eudemons_47.253.49.46.2022-4-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220403/user_equipment_47.253.49.46.2022-4-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220403/friend_relationship_47.253.49.46.2022-4-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220403/enemy_relationship_47.253.49.46.2022-4-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220403/user_extension_47.253.49.46.2022-4-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220403/msgaction_47.253.49.46.2022-4-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220403/msgaction2_47.253.49.46.2022-4-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220403/msgtype_47.253.49.46.2022-4-3.log': No such file or directory
++ date +%Y%m%d -d '20220403 +1day'
+ date_str=20220404
+ [[ 20220404 != \2\0\2\2\0\4\0\4 ]]
20220404
20220405
+ start_date=20220404
+ end_date=20220405
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220404
+ echo 20220404
20220404
+ [[ 20220404 != \2\0\2\2\0\4\0\5 ]]
+ echo 20220404
20220404
+ echo '/bin/bash etl-log_extract.sh 20220404'
/bin/bash etl-log_extract.sh 20220404
+ /bin/bash ../etl/log_extract.sh 20220404
2022-4-4
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-4.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-4.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-4.log"
20220405
20220406
+ start_date=20220405
+ end_date=20220406
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220405
+ echo 20220405
20220405
+ [[ 20220405 != \2\0\2\2\0\4\0\6 ]]
+ echo 20220405
20220405
+ echo '/bin/bash etl-log_extract.sh 20220405'
/bin/bash etl-log_extract.sh 20220405
+ /bin/bash ../etl/log_extract.sh 20220405
2022-4-5
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-5.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-5.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-5.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-5.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220405
+ mv 'msgaction 2022-4-4.log' 'msgaction 2022-4-5.log' 'msgaction2 2022-4-4.log' 'msgaction2 2022-4-5.log' 'msgtype 2022-4-4.log' 'msgtype 2022-4-5.log' 'userinfo 2022-4-5.log' 20220405
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220405'
/bin/bash etl-log_transform.sh 20220405
+ /bin/bash ../etl/log_transform.sh 20220405
2022-4-5
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220405/msgaction 2022-4-5.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220405/msgaction2 2022-4-5.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220405/msgtype 2022-4-5.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220405/userinfo 2022-4-5.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220405
+ mv enemy_relationship_47.253.49.46.2022-4-5.log friend_relationship_47.253.49.46.2022-4-5.log msgaction2_47.253.49.46.2022-4-5.log msgaction_47.253.49.46.2022-4-5.log msgtype_47.253.49.46.2022-4-5.log user_equipment_47.253.49.46.2022-4-5.log user_eudemons_47.253.49.46.2022-4-5.log user_extension_47.253.49.46.2022-4-5.log user_family_47.253.49.46.2022-4-5.log user_login_47.253.49.46.2022-4-5.log 20220405
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220405'
/bin/bash etl-log_load.sh 20220405
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220405
2022-4-5
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220405/user_login_47.253.49.46.2022-4-5.log': No such file or directory
22/04/06 04:02:26 INFO hdfs.DataStreamer: Exception in createBlockOutputStream
java.io.IOException: Got error, status=ERROR, status message , ack with firstBadLink as 192.168.19.26:11001
	at org.apache.hadoop.hdfs.protocol.datatransfer.DataTransferProtoUtil.checkBlockOpStatus(DataTransferProtoUtil.java:118)
	at org.apache.hadoop.hdfs.DataStreamer.createBlockOutputStream(DataStreamer.java:1751)
	at org.apache.hadoop.hdfs.DataStreamer.nextBlockOutputStream(DataStreamer.java:1655)
	at org.apache.hadoop.hdfs.DataStreamer.run(DataStreamer.java:710)
22/04/06 04:02:26 WARN hdfs.DataStreamer: Abandoning BP-589364582-192.168.19.25-1618816133583:blk_1093113605_19424748
22/04/06 04:02:26 WARN hdfs.DataStreamer: Excluding datanode DatanodeInfoWithStorage[192.168.19.26:11001,DS-87d3351a-f1d4-41f3-8126-07fb1ef12d6a,DISK]
22/04/06 04:02:26 WARN hdfs.DataStreamer: Slow waitForAckedSeqno took 65255ms (threshold=30000ms). File being written: /user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220405/user_login_47.253.49.46.2022-4-5.log._COPYING_, block: BP-589364582-192.168.19.25-1618816133583:blk_1093113608_19424751, Write pipeline datanodes: [DatanodeInfoWithStorage[192.168.19.44:11001,DS-b45254f8-c84b-4dcd-b605-3950cba6a54c,DISK]].
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220405/user_family_47.253.49.46.2022-4-5.log': No such file or directory
22/04/06 04:03:30 WARN hdfs.DataStreamer: Slow waitForAckedSeqno took 58180ms (threshold=30000ms). File being written: /user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220405/user_family_47.253.49.46.2022-4-5.log._COPYING_, block: BP-589364582-192.168.19.25-1618816133583:blk_1093113609_19424752, Write pipeline datanodes: [DatanodeInfoWithStorage[192.168.19.26:11001,DS-87d3351a-f1d4-41f3-8126-07fb1ef12d6a,DISK], DatanodeInfoWithStorage[192.168.19.44:11001,DS-b45254f8-c84b-4dcd-b605-3950cba6a54c,DISK]].
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220405/user_eudemons_47.253.49.46.2022-4-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220405/user_equipment_47.253.49.46.2022-4-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220405/friend_relationship_47.253.49.46.2022-4-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220405/enemy_relationship_47.253.49.46.2022-4-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220405/user_extension_47.253.49.46.2022-4-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220405/msgaction_47.253.49.46.2022-4-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220405/msgaction2_47.253.49.46.2022-4-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220405/msgtype_47.253.49.46.2022-4-5.log': No such file or directory
++ date +%Y%m%d -d '20220405 +1day'
+ date_str=20220406
+ [[ 20220406 != \2\0\2\2\0\4\0\6 ]]
20220406
20220407
+ start_date=20220406
+ end_date=20220407
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220406
+ echo 20220406
20220406
+ [[ 20220406 != \2\0\2\2\0\4\0\7 ]]
+ echo 20220406
20220406
+ echo '/bin/bash etl-log_extract.sh 20220406'
/bin/bash etl-log_extract.sh 20220406
+ /bin/bash ../etl/log_extract.sh 20220406
2022-4-6
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-6.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-6.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-6.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-6.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220406
+ mv 'msgaction 2022-4-6.log' 'msgaction2 2022-4-6.log' 'msgtype 2022-4-6.log' 'userinfo 2022-4-6.log' 20220406
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220406'
/bin/bash etl-log_transform.sh 20220406
+ /bin/bash ../etl/log_transform.sh 20220406
2022-4-6
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220406/msgaction 2022-4-6.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220406/msgaction2 2022-4-6.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220406/msgtype 2022-4-6.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220406/userinfo 2022-4-6.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220406
+ mv enemy_relationship_47.253.49.46.2022-4-6.log friend_relationship_47.253.49.46.2022-4-6.log msgaction2_47.253.49.46.2022-4-6.log msgaction_47.253.49.46.2022-4-6.log msgtype_47.253.49.46.2022-4-6.log user_equipment_47.253.49.46.2022-4-6.log user_eudemons_47.253.49.46.2022-4-6.log user_extension_47.253.49.46.2022-4-6.log user_family_47.253.49.46.2022-4-6.log user_login_47.253.49.46.2022-4-6.log 20220406
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220406'
/bin/bash etl-log_load.sh 20220406
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220406
2022-4-6
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220406/user_login_47.253.49.46.2022-4-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220406/user_family_47.253.49.46.2022-4-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220406/user_eudemons_47.253.49.46.2022-4-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220406/user_equipment_47.253.49.46.2022-4-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220406/friend_relationship_47.253.49.46.2022-4-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220406/enemy_relationship_47.253.49.46.2022-4-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220406/user_extension_47.253.49.46.2022-4-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220406/msgaction_47.253.49.46.2022-4-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220406/msgaction2_47.253.49.46.2022-4-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220406/msgtype_47.253.49.46.2022-4-6.log': No such file or directory
++ date +%Y%m%d -d '20220406 +1day'
+ date_str=20220407
+ [[ 20220407 != \2\0\2\2\0\4\0\7 ]]
20220407
20220408
+ start_date=20220407
+ end_date=20220408
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220407
+ echo 20220407
20220407
+ [[ 20220407 != \2\0\2\2\0\4\0\8 ]]
+ echo 20220407
20220407
+ echo '/bin/bash etl-log_extract.sh 20220407'
/bin/bash etl-log_extract.sh 20220407
+ /bin/bash ../etl/log_extract.sh 20220407
2022-4-7
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-7.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-7.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-7.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-7.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220407
+ mv 'msgaction 2022-4-7.log' 'msgaction2 2022-4-7.log' 'msgtype 2022-4-7.log' 'userinfo 2022-4-7.log' 20220407
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220407'
/bin/bash etl-log_transform.sh 20220407
+ /bin/bash ../etl/log_transform.sh 20220407
2022-4-7
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220407/msgaction 2022-4-7.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220407/msgaction2 2022-4-7.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220407/msgtype 2022-4-7.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220407/userinfo 2022-4-7.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220407
+ mv enemy_relationship_47.253.49.46.2022-4-7.log friend_relationship_47.253.49.46.2022-4-7.log msgaction2_47.253.49.46.2022-4-7.log msgaction_47.253.49.46.2022-4-7.log msgtype_47.253.49.46.2022-4-7.log user_equipment_47.253.49.46.2022-4-7.log user_eudemons_47.253.49.46.2022-4-7.log user_extension_47.253.49.46.2022-4-7.log user_family_47.253.49.46.2022-4-7.log user_login_47.253.49.46.2022-4-7.log 20220407
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220407'
/bin/bash etl-log_load.sh 20220407
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220407
2022-4-7
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220407/user_login_47.253.49.46.2022-4-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220407/user_family_47.253.49.46.2022-4-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220407/user_eudemons_47.253.49.46.2022-4-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220407/user_equipment_47.253.49.46.2022-4-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220407/friend_relationship_47.253.49.46.2022-4-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220407/enemy_relationship_47.253.49.46.2022-4-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220407/user_extension_47.253.49.46.2022-4-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220407/msgaction_47.253.49.46.2022-4-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220407/msgaction2_47.253.49.46.2022-4-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220407/msgtype_47.253.49.46.2022-4-7.log': No such file or directory
++ date +%Y%m%d -d '20220407 +1day'
+ date_str=20220408
+ [[ 20220408 != \2\0\2\2\0\4\0\8 ]]
20220408
20220409
+ start_date=20220408
+ end_date=20220409
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220408
+ echo 20220408
20220408
+ [[ 20220408 != \2\0\2\2\0\4\0\9 ]]
+ echo 20220408
20220408
+ echo '/bin/bash etl-log_extract.sh 20220408'
/bin/bash etl-log_extract.sh 20220408
+ /bin/bash ../etl/log_extract.sh 20220408
2022-4-8
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-8.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-8.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-8.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-8.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220408
+ mv 'msgaction 2022-4-8.log' 'msgaction2 2022-4-8.log' 'msgtype 2022-4-8.log' 'userinfo 2022-4-8.log' 20220408
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220408'
/bin/bash etl-log_transform.sh 20220408
+ /bin/bash ../etl/log_transform.sh 20220408
2022-4-8
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220408/msgaction 2022-4-8.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220408/msgaction2 2022-4-8.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220408/msgtype 2022-4-8.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220408/userinfo 2022-4-8.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220408
+ mv enemy_relationship_47.253.49.46.2022-4-8.log friend_relationship_47.253.49.46.2022-4-8.log msgaction2_47.253.49.46.2022-4-8.log msgaction_47.253.49.46.2022-4-8.log msgtype_47.253.49.46.2022-4-8.log user_equipment_47.253.49.46.2022-4-8.log user_eudemons_47.253.49.46.2022-4-8.log user_extension_47.253.49.46.2022-4-8.log user_family_47.253.49.46.2022-4-8.log user_login_47.253.49.46.2022-4-8.log 20220408
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220408'
/bin/bash etl-log_load.sh 20220408
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220408
2022-4-8
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220408/user_login_47.253.49.46.2022-4-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220408/user_family_47.253.49.46.2022-4-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220408/user_eudemons_47.253.49.46.2022-4-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220408/user_equipment_47.253.49.46.2022-4-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220408/friend_relationship_47.253.49.46.2022-4-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220408/enemy_relationship_47.253.49.46.2022-4-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220408/user_extension_47.253.49.46.2022-4-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220408/msgaction_47.253.49.46.2022-4-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220408/msgaction2_47.253.49.46.2022-4-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220408/msgtype_47.253.49.46.2022-4-8.log': No such file or directory
++ date +%Y%m%d -d '20220408 +1day'
+ date_str=20220409
+ [[ 20220409 != \2\0\2\2\0\4\0\9 ]]
20220409
20220410
+ start_date=20220409
+ end_date=20220410
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220409
+ echo 20220409
20220409
+ [[ 20220409 != \2\0\2\2\0\4\1\0 ]]
+ echo 20220409
20220409
+ echo '/bin/bash etl-log_extract.sh 20220409'
/bin/bash etl-log_extract.sh 20220409
+ /bin/bash ../etl/log_extract.sh 20220409
2022-4-9
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-9.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-9.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-9.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-9.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220409
+ mv 'msgaction 2022-4-9.log' 'msgaction2 2022-4-9.log' 'msgtype 2022-4-9.log' 'userinfo 2022-4-9.log' 20220409
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220409'
/bin/bash etl-log_transform.sh 20220409
+ /bin/bash ../etl/log_transform.sh 20220409
2022-4-9
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220409/msgaction 2022-4-9.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220409/msgaction2 2022-4-9.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220409/msgtype 2022-4-9.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220409/userinfo 2022-4-9.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220409
+ mv enemy_relationship_47.253.49.46.2022-4-9.log friend_relationship_47.253.49.46.2022-4-9.log msgaction2_47.253.49.46.2022-4-9.log msgaction_47.253.49.46.2022-4-9.log msgtype_47.253.49.46.2022-4-9.log user_equipment_47.253.49.46.2022-4-9.log user_eudemons_47.253.49.46.2022-4-9.log user_extension_47.253.49.46.2022-4-9.log user_family_47.253.49.46.2022-4-9.log user_login_47.253.49.46.2022-4-9.log 20220409
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220409'
/bin/bash etl-log_load.sh 20220409
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220409
2022-4-9
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220409/user_login_47.253.49.46.2022-4-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220409/user_family_47.253.49.46.2022-4-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220409/user_eudemons_47.253.49.46.2022-4-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220409/user_equipment_47.253.49.46.2022-4-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220409/friend_relationship_47.253.49.46.2022-4-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220409/enemy_relationship_47.253.49.46.2022-4-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220409/user_extension_47.253.49.46.2022-4-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220409/msgaction_47.253.49.46.2022-4-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220409/msgaction2_47.253.49.46.2022-4-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220409/msgtype_47.253.49.46.2022-4-9.log': No such file or directory
++ date +%Y%m%d -d '20220409 +1day'
+ date_str=20220410
+ [[ 20220410 != \2\0\2\2\0\4\1\0 ]]
20220410
20220411
+ start_date=20220410
+ end_date=20220411
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220410
+ echo 20220410
20220410
+ [[ 20220410 != \2\0\2\2\0\4\1\1 ]]
+ echo 20220410
20220410
+ echo '/bin/bash etl-log_extract.sh 20220410'
/bin/bash etl-log_extract.sh 20220410
+ /bin/bash ../etl/log_extract.sh 20220410
2022-4-10
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-10.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-10.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-10.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-10.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220410
+ mv 'msgaction 2022-4-10.log' 'msgaction2 2022-4-10.log' 'msgtype 2022-4-10.log' 'userinfo 2022-4-10.log' 20220410
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220410'
/bin/bash etl-log_transform.sh 20220410
+ /bin/bash ../etl/log_transform.sh 20220410
2022-4-10
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220410/msgaction 2022-4-10.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220410/msgaction2 2022-4-10.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220410/msgtype 2022-4-10.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220410/userinfo 2022-4-10.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220410
+ mv enemy_relationship_47.253.49.46.2022-4-10.log friend_relationship_47.253.49.46.2022-4-10.log msgaction2_47.253.49.46.2022-4-10.log msgaction_47.253.49.46.2022-4-10.log msgtype_47.253.49.46.2022-4-10.log user_equipment_47.253.49.46.2022-4-10.log user_eudemons_47.253.49.46.2022-4-10.log user_extension_47.253.49.46.2022-4-10.log user_family_47.253.49.46.2022-4-10.log user_login_47.253.49.46.2022-4-10.log 20220410
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220410'
/bin/bash etl-log_load.sh 20220410
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220410
2022-4-10
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220410/user_login_47.253.49.46.2022-4-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220410/user_family_47.253.49.46.2022-4-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220410/user_eudemons_47.253.49.46.2022-4-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220410/user_equipment_47.253.49.46.2022-4-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220410/friend_relationship_47.253.49.46.2022-4-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220410/enemy_relationship_47.253.49.46.2022-4-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220410/user_extension_47.253.49.46.2022-4-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220410/msgaction_47.253.49.46.2022-4-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220410/msgaction2_47.253.49.46.2022-4-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220410/msgtype_47.253.49.46.2022-4-10.log': No such file or directory
++ date +%Y%m%d -d '20220410 +1day'
+ date_str=20220411
+ [[ 20220411 != \2\0\2\2\0\4\1\1 ]]
20220411
20220412
+ start_date=20220411
+ end_date=20220412
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220411
+ echo 20220411
20220411
+ [[ 20220411 != \2\0\2\2\0\4\1\2 ]]
+ echo 20220411
20220411
+ echo '/bin/bash etl-log_extract.sh 20220411'
/bin/bash etl-log_extract.sh 20220411
+ /bin/bash ../etl/log_extract.sh 20220411
2022-4-11
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-11.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-11.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-11.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-11.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220411
+ mv 'msgaction 2022-4-11.log' 'msgaction2 2022-4-11.log' 'msgtype 2022-4-11.log' 'userinfo 2022-4-11.log' 20220411
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220411'
/bin/bash etl-log_transform.sh 20220411
+ /bin/bash ../etl/log_transform.sh 20220411
2022-4-11
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220411/msgaction 2022-4-11.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220411/msgaction2 2022-4-11.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220411/msgtype 2022-4-11.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220411/userinfo 2022-4-11.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220411
+ mv enemy_relationship_47.253.49.46.2022-4-11.log friend_relationship_47.253.49.46.2022-4-11.log msgaction2_47.253.49.46.2022-4-11.log msgaction_47.253.49.46.2022-4-11.log msgtype_47.253.49.46.2022-4-11.log user_equipment_47.253.49.46.2022-4-11.log user_eudemons_47.253.49.46.2022-4-11.log user_extension_47.253.49.46.2022-4-11.log user_family_47.253.49.46.2022-4-11.log user_login_47.253.49.46.2022-4-11.log 20220411
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220411'
/bin/bash etl-log_load.sh 20220411
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220411
2022-4-11
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220411/user_login_47.253.49.46.2022-4-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220411/user_family_47.253.49.46.2022-4-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220411/user_eudemons_47.253.49.46.2022-4-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220411/user_equipment_47.253.49.46.2022-4-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220411/friend_relationship_47.253.49.46.2022-4-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220411/enemy_relationship_47.253.49.46.2022-4-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220411/user_extension_47.253.49.46.2022-4-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220411/msgaction_47.253.49.46.2022-4-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220411/msgaction2_47.253.49.46.2022-4-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220411/msgtype_47.253.49.46.2022-4-11.log': No such file or directory
++ date +%Y%m%d -d '20220411 +1day'
+ date_str=20220412
+ [[ 20220412 != \2\0\2\2\0\4\1\2 ]]
20220412
20220413
+ start_date=20220412
+ end_date=20220413
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220412
+ echo 20220412
20220412
+ [[ 20220412 != \2\0\2\2\0\4\1\3 ]]
+ echo 20220412
20220412
+ echo '/bin/bash etl-log_extract.sh 20220412'
/bin/bash etl-log_extract.sh 20220412
+ /bin/bash ../etl/log_extract.sh 20220412
2022-4-12
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-12.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-12.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-12.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-12.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220412
+ mv 'msgaction 2022-4-12.log' 'msgaction2 2022-4-12.log' 'msgtype 2022-4-12.log' 'userinfo 2022-4-12.log' 20220412
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220412'
/bin/bash etl-log_transform.sh 20220412
+ /bin/bash ../etl/log_transform.sh 20220412
2022-4-12
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220412/msgaction 2022-4-12.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220412/msgaction2 2022-4-12.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220412/msgtype 2022-4-12.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220412/userinfo 2022-4-12.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220412
+ mv enemy_relationship_47.253.49.46.2022-4-12.log friend_relationship_47.253.49.46.2022-4-12.log msgaction2_47.253.49.46.2022-4-12.log msgaction_47.253.49.46.2022-4-12.log msgtype_47.253.49.46.2022-4-12.log user_equipment_47.253.49.46.2022-4-12.log user_eudemons_47.253.49.46.2022-4-12.log user_extension_47.253.49.46.2022-4-12.log user_family_47.253.49.46.2022-4-12.log user_login_47.253.49.46.2022-4-12.log 20220412
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220412'
/bin/bash etl-log_load.sh 20220412
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220412
2022-4-12
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220412/user_login_47.253.49.46.2022-4-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220412/user_family_47.253.49.46.2022-4-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220412/user_eudemons_47.253.49.46.2022-4-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220412/user_equipment_47.253.49.46.2022-4-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220412/friend_relationship_47.253.49.46.2022-4-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220412/enemy_relationship_47.253.49.46.2022-4-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220412/user_extension_47.253.49.46.2022-4-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220412/msgaction_47.253.49.46.2022-4-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220412/msgaction2_47.253.49.46.2022-4-12.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220412/msgtype_47.253.49.46.2022-4-12.log': No such file or directory
++ date +%Y%m%d -d '20220412 +1day'
+ date_str=20220413
+ [[ 20220413 != \2\0\2\2\0\4\1\3 ]]
20220413
20220414
+ start_date=20220413
+ end_date=20220414
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220413
+ echo 20220413
20220413
+ [[ 20220413 != \2\0\2\2\0\4\1\4 ]]
+ echo 20220413
20220413
+ echo '/bin/bash etl-log_extract.sh 20220413'
/bin/bash etl-log_extract.sh 20220413
+ /bin/bash ../etl/log_extract.sh 20220413
2022-4-13
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-13.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-13.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-13.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-13.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220413
+ mv 'msgaction 2022-4-13.log' 'msgaction2 2022-4-13.log' 'msgtype 2022-4-13.log' 'userinfo 2022-4-13.log' 20220413
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220413'
/bin/bash etl-log_transform.sh 20220413
+ /bin/bash ../etl/log_transform.sh 20220413
2022-4-13
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220413/msgaction 2022-4-13.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220413/msgaction2 2022-4-13.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220413/msgtype 2022-4-13.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220413/userinfo 2022-4-13.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220413
+ mv enemy_relationship_47.253.49.46.2022-4-13.log friend_relationship_47.253.49.46.2022-4-13.log msgaction2_47.253.49.46.2022-4-13.log msgaction_47.253.49.46.2022-4-13.log msgtype_47.253.49.46.2022-4-13.log user_equipment_47.253.49.46.2022-4-13.log user_eudemons_47.253.49.46.2022-4-13.log user_extension_47.253.49.46.2022-4-13.log user_family_47.253.49.46.2022-4-13.log user_login_47.253.49.46.2022-4-13.log 20220413
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220413'
/bin/bash etl-log_load.sh 20220413
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220413
2022-4-13
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220413/user_login_47.253.49.46.2022-4-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220413/user_family_47.253.49.46.2022-4-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220413/user_eudemons_47.253.49.46.2022-4-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220413/user_equipment_47.253.49.46.2022-4-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220413/friend_relationship_47.253.49.46.2022-4-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220413/enemy_relationship_47.253.49.46.2022-4-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220413/user_extension_47.253.49.46.2022-4-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220413/msgaction_47.253.49.46.2022-4-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220413/msgaction2_47.253.49.46.2022-4-13.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220413/msgtype_47.253.49.46.2022-4-13.log': No such file or directory
++ date +%Y%m%d -d '20220413 +1day'
+ date_str=20220414
+ [[ 20220414 != \2\0\2\2\0\4\1\4 ]]
20220414
20220415
+ start_date=20220414
+ end_date=20220415
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220414
+ echo 20220414
20220414
+ [[ 20220414 != \2\0\2\2\0\4\1\5 ]]
+ echo 20220414
20220414
+ echo '/bin/bash etl-log_extract.sh 20220414'
/bin/bash etl-log_extract.sh 20220414
+ /bin/bash ../etl/log_extract.sh 20220414
2022-4-14
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-14.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-14.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-14.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-14.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220414
+ mv 'msgaction 2022-4-14.log' 'msgaction2 2022-4-14.log' 'msgtype 2022-4-14.log' 'userinfo 2022-4-14.log' 20220414
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220414'
/bin/bash etl-log_transform.sh 20220414
+ /bin/bash ../etl/log_transform.sh 20220414
2022-4-14
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220414/msgaction 2022-4-14.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220414/msgaction2 2022-4-14.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220414/msgtype 2022-4-14.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220414/userinfo 2022-4-14.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220414
+ mv enemy_relationship_47.253.49.46.2022-4-14.log friend_relationship_47.253.49.46.2022-4-14.log msgaction2_47.253.49.46.2022-4-14.log msgaction_47.253.49.46.2022-4-14.log msgtype_47.253.49.46.2022-4-14.log user_equipment_47.253.49.46.2022-4-14.log user_eudemons_47.253.49.46.2022-4-14.log user_extension_47.253.49.46.2022-4-14.log user_family_47.253.49.46.2022-4-14.log user_login_47.253.49.46.2022-4-14.log 20220414
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220414'
/bin/bash etl-log_load.sh 20220414
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220414
2022-4-14
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220414/user_login_47.253.49.46.2022-4-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220414/user_family_47.253.49.46.2022-4-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220414/user_eudemons_47.253.49.46.2022-4-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220414/user_equipment_47.253.49.46.2022-4-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220414/friend_relationship_47.253.49.46.2022-4-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220414/enemy_relationship_47.253.49.46.2022-4-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220414/user_extension_47.253.49.46.2022-4-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220414/msgaction_47.253.49.46.2022-4-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220414/msgaction2_47.253.49.46.2022-4-14.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220414/msgtype_47.253.49.46.2022-4-14.log': No such file or directory
++ date +%Y%m%d -d '20220414 +1day'
+ date_str=20220415
+ [[ 20220415 != \2\0\2\2\0\4\1\5 ]]
20220415
20220416
+ start_date=20220415
+ end_date=20220416
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220415
+ echo 20220415
20220415
+ [[ 20220415 != \2\0\2\2\0\4\1\6 ]]
+ echo 20220415
20220415
+ echo '/bin/bash etl-log_extract.sh 20220415'
/bin/bash etl-log_extract.sh 20220415
+ /bin/bash ../etl/log_extract.sh 20220415
2022-4-15
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-15.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-15.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-15.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-15.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220415
+ mv 'msgaction 2022-4-15.log' 'msgaction2 2022-4-15.log' 'msgtype 2022-4-15.log' 'userinfo 2022-4-15.log' 20220415
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220415'
/bin/bash etl-log_transform.sh 20220415
+ /bin/bash ../etl/log_transform.sh 20220415
2022-4-15
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220415/msgaction 2022-4-15.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220415/msgaction2 2022-4-15.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220415/msgtype 2022-4-15.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220415/userinfo 2022-4-15.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220415
+ mv enemy_relationship_47.253.49.46.2022-4-15.log friend_relationship_47.253.49.46.2022-4-15.log msgaction2_47.253.49.46.2022-4-15.log msgaction_47.253.49.46.2022-4-15.log msgtype_47.253.49.46.2022-4-15.log user_equipment_47.253.49.46.2022-4-15.log user_eudemons_47.253.49.46.2022-4-15.log user_extension_47.253.49.46.2022-4-15.log user_family_47.253.49.46.2022-4-15.log user_login_47.253.49.46.2022-4-15.log 20220415
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220415'
/bin/bash etl-log_load.sh 20220415
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220415
2022-4-15
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220415/user_login_47.253.49.46.2022-4-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220415/user_family_47.253.49.46.2022-4-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220415/user_eudemons_47.253.49.46.2022-4-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220415/user_equipment_47.253.49.46.2022-4-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220415/friend_relationship_47.253.49.46.2022-4-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220415/enemy_relationship_47.253.49.46.2022-4-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220415/user_extension_47.253.49.46.2022-4-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220415/msgaction_47.253.49.46.2022-4-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220415/msgaction2_47.253.49.46.2022-4-15.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220415/msgtype_47.253.49.46.2022-4-15.log': No such file or directory
++ date +%Y%m%d -d '20220415 +1day'
+ date_str=20220416
+ [[ 20220416 != \2\0\2\2\0\4\1\6 ]]
20220416
20220417
+ start_date=20220416
+ end_date=20220417
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220416
+ echo 20220416
20220416
+ [[ 20220416 != \2\0\2\2\0\4\1\7 ]]
+ echo 20220416
20220416
+ echo '/bin/bash etl-log_extract.sh 20220416'
/bin/bash etl-log_extract.sh 20220416
+ /bin/bash ../etl/log_extract.sh 20220416
2022-4-16
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-16.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-16.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-16.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-16.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220416
+ mv 'msgaction 2022-4-16.log' 'msgaction2 2022-4-16.log' 'msgtype 2022-4-16.log' 'userinfo 2022-4-16.log' 20220416
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220416'
/bin/bash etl-log_transform.sh 20220416
+ /bin/bash ../etl/log_transform.sh 20220416
2022-4-16
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220416/msgaction 2022-4-16.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220416/msgaction2 2022-4-16.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220416/msgtype 2022-4-16.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220416/userinfo 2022-4-16.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220416
+ mv enemy_relationship_47.253.49.46.2022-4-16.log friend_relationship_47.253.49.46.2022-4-16.log msgaction2_47.253.49.46.2022-4-16.log msgaction_47.253.49.46.2022-4-16.log msgtype_47.253.49.46.2022-4-16.log user_equipment_47.253.49.46.2022-4-16.log user_eudemons_47.253.49.46.2022-4-16.log user_extension_47.253.49.46.2022-4-16.log user_family_47.253.49.46.2022-4-16.log user_login_47.253.49.46.2022-4-16.log 20220416
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220416'
/bin/bash etl-log_load.sh 20220416
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220416
2022-4-16
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220416/user_login_47.253.49.46.2022-4-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220416/user_family_47.253.49.46.2022-4-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220416/user_eudemons_47.253.49.46.2022-4-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220416/user_equipment_47.253.49.46.2022-4-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220416/friend_relationship_47.253.49.46.2022-4-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220416/enemy_relationship_47.253.49.46.2022-4-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220416/user_extension_47.253.49.46.2022-4-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220416/msgaction_47.253.49.46.2022-4-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220416/msgaction2_47.253.49.46.2022-4-16.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220416/msgtype_47.253.49.46.2022-4-16.log': No such file or directory
++ date +%Y%m%d -d '20220416 +1day'
+ date_str=20220417
+ [[ 20220417 != \2\0\2\2\0\4\1\7 ]]
20220417
20220418
+ start_date=20220417
+ end_date=20220418
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220417
+ echo 20220417
20220417
+ [[ 20220417 != \2\0\2\2\0\4\1\8 ]]
+ echo 20220417
20220417
+ echo '/bin/bash etl-log_extract.sh 20220417'
/bin/bash etl-log_extract.sh 20220417
+ /bin/bash ../etl/log_extract.sh 20220417
2022-4-17
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-17.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-17.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-17.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-17.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220417
+ mv 'msgaction 2022-4-17.log' 'msgaction2 2022-4-17.log' 'msgtype 2022-4-17.log' 'userinfo 2022-4-17.log' 20220417
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220417'
/bin/bash etl-log_transform.sh 20220417
+ /bin/bash ../etl/log_transform.sh 20220417
2022-4-17
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220417/msgaction 2022-4-17.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220417/msgaction2 2022-4-17.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220417/msgtype 2022-4-17.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220417/userinfo 2022-4-17.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220417
+ mv enemy_relationship_47.253.49.46.2022-4-17.log friend_relationship_47.253.49.46.2022-4-17.log msgaction2_47.253.49.46.2022-4-17.log msgaction_47.253.49.46.2022-4-17.log msgtype_47.253.49.46.2022-4-17.log user_equipment_47.253.49.46.2022-4-17.log user_eudemons_47.253.49.46.2022-4-17.log user_extension_47.253.49.46.2022-4-17.log user_family_47.253.49.46.2022-4-17.log user_login_47.253.49.46.2022-4-17.log 20220417
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220417'
/bin/bash etl-log_load.sh 20220417
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220417
2022-4-17
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220417/user_login_47.253.49.46.2022-4-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220417/user_family_47.253.49.46.2022-4-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220417/user_eudemons_47.253.49.46.2022-4-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220417/user_equipment_47.253.49.46.2022-4-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220417/friend_relationship_47.253.49.46.2022-4-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220417/enemy_relationship_47.253.49.46.2022-4-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220417/user_extension_47.253.49.46.2022-4-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220417/msgaction_47.253.49.46.2022-4-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220417/msgaction2_47.253.49.46.2022-4-17.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220417/msgtype_47.253.49.46.2022-4-17.log': No such file or directory
++ date +%Y%m%d -d '20220417 +1day'
+ date_str=20220418
+ [[ 20220418 != \2\0\2\2\0\4\1\8 ]]
20220418
20220419
+ start_date=20220418
+ end_date=20220419
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220418
+ echo 20220418
20220418
+ [[ 20220418 != \2\0\2\2\0\4\1\9 ]]
+ echo 20220418
20220418
+ echo '/bin/bash etl-log_extract.sh 20220418'
/bin/bash etl-log_extract.sh 20220418
+ /bin/bash ../etl/log_extract.sh 20220418
2022-4-18
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-18.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-18.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-18.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-18.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220418
+ mv 'msgaction 2022-4-18.log' 'msgaction2 2022-4-18.log' 'msgtype 2022-4-18.log' 'userinfo 2022-4-18.log' 20220418
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220418'
/bin/bash etl-log_transform.sh 20220418
+ /bin/bash ../etl/log_transform.sh 20220418
2022-4-18
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220418/msgaction 2022-4-18.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220418/msgaction2 2022-4-18.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220418/msgtype 2022-4-18.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220418/userinfo 2022-4-18.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220418
+ mv enemy_relationship_47.253.49.46.2022-4-18.log friend_relationship_47.253.49.46.2022-4-18.log msgaction2_47.253.49.46.2022-4-18.log msgaction_47.253.49.46.2022-4-18.log msgtype_47.253.49.46.2022-4-18.log user_equipment_47.253.49.46.2022-4-18.log user_eudemons_47.253.49.46.2022-4-18.log user_extension_47.253.49.46.2022-4-18.log user_family_47.253.49.46.2022-4-18.log user_login_47.253.49.46.2022-4-18.log 20220418
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220418'
/bin/bash etl-log_load.sh 20220418
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220418
2022-4-18
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220418/user_login_47.253.49.46.2022-4-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220418/user_family_47.253.49.46.2022-4-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220418/user_eudemons_47.253.49.46.2022-4-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220418/user_equipment_47.253.49.46.2022-4-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220418/friend_relationship_47.253.49.46.2022-4-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220418/enemy_relationship_47.253.49.46.2022-4-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220418/user_extension_47.253.49.46.2022-4-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220418/msgaction_47.253.49.46.2022-4-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220418/msgaction2_47.253.49.46.2022-4-18.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220418/msgtype_47.253.49.46.2022-4-18.log': No such file or directory
++ date +%Y%m%d -d '20220418 +1day'
+ date_str=20220419
+ [[ 20220419 != \2\0\2\2\0\4\1\9 ]]
20220419
20220420
+ start_date=20220419
+ end_date=20220420
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220419
+ echo 20220419
20220419
+ [[ 20220419 != \2\0\2\2\0\4\2\0 ]]
+ echo 20220419
20220419
+ echo '/bin/bash etl-log_extract.sh 20220419'
/bin/bash etl-log_extract.sh 20220419
+ /bin/bash ../etl/log_extract.sh 20220419
2022-4-19
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-19.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-19.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-19.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-19.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220419
+ mv 'msgaction 2022-4-19.log' 'msgaction2 2022-4-19.log' 'msgtype 2022-4-19.log' 'userinfo 2022-4-19.log' 20220419
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220419'
/bin/bash etl-log_transform.sh 20220419
+ /bin/bash ../etl/log_transform.sh 20220419
2022-4-19
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220419/msgaction 2022-4-19.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220419/msgaction2 2022-4-19.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220419/msgtype 2022-4-19.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220419/userinfo 2022-4-19.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220419
+ mv enemy_relationship_47.253.49.46.2022-4-19.log friend_relationship_47.253.49.46.2022-4-19.log msgaction2_47.253.49.46.2022-4-19.log msgaction_47.253.49.46.2022-4-19.log msgtype_47.253.49.46.2022-4-19.log user_equipment_47.253.49.46.2022-4-19.log user_eudemons_47.253.49.46.2022-4-19.log user_extension_47.253.49.46.2022-4-19.log user_family_47.253.49.46.2022-4-19.log user_login_47.253.49.46.2022-4-19.log 20220419
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220419'
/bin/bash etl-log_load.sh 20220419
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220419
2022-4-19
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220419/user_login_47.253.49.46.2022-4-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220419/user_family_47.253.49.46.2022-4-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220419/user_eudemons_47.253.49.46.2022-4-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220419/user_equipment_47.253.49.46.2022-4-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220419/friend_relationship_47.253.49.46.2022-4-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220419/enemy_relationship_47.253.49.46.2022-4-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220419/user_extension_47.253.49.46.2022-4-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220419/msgaction_47.253.49.46.2022-4-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220419/msgaction2_47.253.49.46.2022-4-19.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220419/msgtype_47.253.49.46.2022-4-19.log': No such file or directory
++ date +%Y%m%d -d '20220419 +1day'
+ date_str=20220420
+ [[ 20220420 != \2\0\2\2\0\4\2\0 ]]
20220420
20220421
+ start_date=20220420
+ end_date=20220421
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220420
+ echo 20220420
20220420
+ [[ 20220420 != \2\0\2\2\0\4\2\1 ]]
+ echo 20220420
20220420
+ echo '/bin/bash etl-log_extract.sh 20220420'
/bin/bash etl-log_extract.sh 20220420
+ /bin/bash ../etl/log_extract.sh 20220420
2022-4-20
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-20.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-20.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-20.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-20.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220420
+ mv 'msgaction 2022-4-20.log' 'msgaction2 2022-4-20.log' 'msgtype 2022-4-20.log' 'userinfo 2022-4-20.log' 20220420
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220420'
/bin/bash etl-log_transform.sh 20220420
+ /bin/bash ../etl/log_transform.sh 20220420
2022-4-20
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220420/msgaction 2022-4-20.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220420/msgaction2 2022-4-20.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220420/msgtype 2022-4-20.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220420/userinfo 2022-4-20.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220420
+ mv enemy_relationship_47.253.49.46.2022-4-20.log friend_relationship_47.253.49.46.2022-4-20.log msgaction2_47.253.49.46.2022-4-20.log msgaction_47.253.49.46.2022-4-20.log msgtype_47.253.49.46.2022-4-20.log user_equipment_47.253.49.46.2022-4-20.log user_eudemons_47.253.49.46.2022-4-20.log user_extension_47.253.49.46.2022-4-20.log user_family_47.253.49.46.2022-4-20.log user_login_47.253.49.46.2022-4-20.log 20220420
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220420'
/bin/bash etl-log_load.sh 20220420
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220420
2022-4-20
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220420/user_login_47.253.49.46.2022-4-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220420/user_family_47.253.49.46.2022-4-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220420/user_eudemons_47.253.49.46.2022-4-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220420/user_equipment_47.253.49.46.2022-4-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220420/friend_relationship_47.253.49.46.2022-4-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220420/enemy_relationship_47.253.49.46.2022-4-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220420/user_extension_47.253.49.46.2022-4-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220420/msgaction_47.253.49.46.2022-4-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220420/msgaction2_47.253.49.46.2022-4-20.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220420/msgtype_47.253.49.46.2022-4-20.log': No such file or directory
++ date +%Y%m%d -d '20220420 +1day'
+ date_str=20220421
+ [[ 20220421 != \2\0\2\2\0\4\2\1 ]]
20220421
20220422
+ start_date=20220421
+ end_date=20220422
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220421
+ echo 20220421
20220421
+ [[ 20220421 != \2\0\2\2\0\4\2\2 ]]
+ echo 20220421
20220421
+ echo '/bin/bash etl-log_extract.sh 20220421'
/bin/bash etl-log_extract.sh 20220421
+ /bin/bash ../etl/log_extract.sh 20220421
2022-4-21
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-21.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-21.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-21.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-21.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220421
+ mv 'msgaction 2022-4-21.log' 'msgaction2 2022-4-21.log' 'msgtype 2022-4-21.log' 'userinfo 2022-4-21.log' 20220421
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220421'
/bin/bash etl-log_transform.sh 20220421
+ /bin/bash ../etl/log_transform.sh 20220421
2022-4-21
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220421/msgaction 2022-4-21.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220421/msgaction2 2022-4-21.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220421/msgtype 2022-4-21.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220421/userinfo 2022-4-21.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220421
+ mv enemy_relationship_47.253.49.46.2022-4-21.log friend_relationship_47.253.49.46.2022-4-21.log msgaction2_47.253.49.46.2022-4-21.log msgaction_47.253.49.46.2022-4-21.log msgtype_47.253.49.46.2022-4-21.log user_equipment_47.253.49.46.2022-4-21.log user_eudemons_47.253.49.46.2022-4-21.log user_extension_47.253.49.46.2022-4-21.log user_family_47.253.49.46.2022-4-21.log user_login_47.253.49.46.2022-4-21.log 20220421
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220421'
/bin/bash etl-log_load.sh 20220421
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220421
2022-4-21
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220421/user_login_47.253.49.46.2022-4-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220421/user_family_47.253.49.46.2022-4-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220421/user_eudemons_47.253.49.46.2022-4-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220421/user_equipment_47.253.49.46.2022-4-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220421/friend_relationship_47.253.49.46.2022-4-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220421/enemy_relationship_47.253.49.46.2022-4-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220421/user_extension_47.253.49.46.2022-4-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220421/msgaction_47.253.49.46.2022-4-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220421/msgaction2_47.253.49.46.2022-4-21.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220421/msgtype_47.253.49.46.2022-4-21.log': No such file or directory
++ date +%Y%m%d -d '20220421 +1day'
+ date_str=20220422
+ [[ 20220422 != \2\0\2\2\0\4\2\2 ]]
20220422
20220423
+ start_date=20220422
+ end_date=20220423
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220422
+ echo 20220422
20220422
+ [[ 20220422 != \2\0\2\2\0\4\2\3 ]]
+ echo 20220422
20220422
+ echo '/bin/bash etl-log_extract.sh 20220422'
/bin/bash etl-log_extract.sh 20220422
+ /bin/bash ../etl/log_extract.sh 20220422
2022-4-22
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-22.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-22.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-22.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-22.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220422
+ mv 'msgaction 2022-4-22.log' 'msgaction2 2022-4-22.log' 'msgtype 2022-4-22.log' 'userinfo 2022-4-22.log' 20220422
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220422'
/bin/bash etl-log_transform.sh 20220422
+ /bin/bash ../etl/log_transform.sh 20220422
2022-4-22
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220422/msgaction 2022-4-22.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220422/msgaction2 2022-4-22.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220422/msgtype 2022-4-22.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220422/userinfo 2022-4-22.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220422
+ mv enemy_relationship_47.253.49.46.2022-4-22.log friend_relationship_47.253.49.46.2022-4-22.log msgaction2_47.253.49.46.2022-4-22.log msgaction_47.253.49.46.2022-4-22.log msgtype_47.253.49.46.2022-4-22.log user_equipment_47.253.49.46.2022-4-22.log user_eudemons_47.253.49.46.2022-4-22.log user_extension_47.253.49.46.2022-4-22.log user_family_47.253.49.46.2022-4-22.log user_login_47.253.49.46.2022-4-22.log 20220422
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220422'
/bin/bash etl-log_load.sh 20220422
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220422
2022-4-22
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220422/user_login_47.253.49.46.2022-4-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220422/user_family_47.253.49.46.2022-4-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220422/user_eudemons_47.253.49.46.2022-4-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220422/user_equipment_47.253.49.46.2022-4-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220422/friend_relationship_47.253.49.46.2022-4-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220422/enemy_relationship_47.253.49.46.2022-4-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220422/user_extension_47.253.49.46.2022-4-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220422/msgaction_47.253.49.46.2022-4-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220422/msgaction2_47.253.49.46.2022-4-22.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220422/msgtype_47.253.49.46.2022-4-22.log': No such file or directory
++ date +%Y%m%d -d '20220422 +1day'
+ date_str=20220423
+ [[ 20220423 != \2\0\2\2\0\4\2\3 ]]
20220423
20220424
+ start_date=20220423
+ end_date=20220424
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220423
+ echo 20220423
20220423
+ [[ 20220423 != \2\0\2\2\0\4\2\4 ]]
+ echo 20220423
20220423
+ echo '/bin/bash etl-log_extract.sh 20220423'
/bin/bash etl-log_extract.sh 20220423
+ /bin/bash ../etl/log_extract.sh 20220423
2022-4-23
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-23.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-23.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-23.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-23.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220423
+ mv 'msgaction 2022-4-23.log' 'msgaction2 2022-4-23.log' 'msgtype 2022-4-23.log' 'userinfo 2022-4-23.log' 20220423
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220423'
/bin/bash etl-log_transform.sh 20220423
+ /bin/bash ../etl/log_transform.sh 20220423
2022-4-23
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220423/msgaction 2022-4-23.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220423/msgaction2 2022-4-23.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220423/msgtype 2022-4-23.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220423/userinfo 2022-4-23.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220423
+ mv enemy_relationship_47.253.49.46.2022-4-23.log friend_relationship_47.253.49.46.2022-4-23.log msgaction2_47.253.49.46.2022-4-23.log msgaction_47.253.49.46.2022-4-23.log msgtype_47.253.49.46.2022-4-23.log user_equipment_47.253.49.46.2022-4-23.log user_eudemons_47.253.49.46.2022-4-23.log user_extension_47.253.49.46.2022-4-23.log user_family_47.253.49.46.2022-4-23.log user_login_47.253.49.46.2022-4-23.log 20220423
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220423'
/bin/bash etl-log_load.sh 20220423
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220423
2022-4-23
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220423/user_login_47.253.49.46.2022-4-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220423/user_family_47.253.49.46.2022-4-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220423/user_eudemons_47.253.49.46.2022-4-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220423/user_equipment_47.253.49.46.2022-4-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220423/friend_relationship_47.253.49.46.2022-4-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220423/enemy_relationship_47.253.49.46.2022-4-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220423/user_extension_47.253.49.46.2022-4-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220423/msgaction_47.253.49.46.2022-4-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220423/msgaction2_47.253.49.46.2022-4-23.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220423/msgtype_47.253.49.46.2022-4-23.log': No such file or directory
++ date +%Y%m%d -d '20220423 +1day'
+ date_str=20220424
+ [[ 20220424 != \2\0\2\2\0\4\2\4 ]]
20220424
20220425
+ start_date=20220424
+ end_date=20220425
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220424
+ echo 20220424
20220424
+ [[ 20220424 != \2\0\2\2\0\4\2\5 ]]
+ echo 20220424
20220424
+ echo '/bin/bash etl-log_extract.sh 20220424'
/bin/bash etl-log_extract.sh 20220424
+ /bin/bash ../etl/log_extract.sh 20220424
2022-4-24
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-24.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-24.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-24.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-24.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220424
+ mv 'msgaction 2022-4-24.log' 'msgaction2 2022-4-24.log' 'msgtype 2022-4-24.log' 'userinfo 2022-4-24.log' 20220424
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220424'
/bin/bash etl-log_transform.sh 20220424
+ /bin/bash ../etl/log_transform.sh 20220424
2022-4-24
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220424/msgaction 2022-4-24.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220424/msgaction2 2022-4-24.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220424/msgtype 2022-4-24.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220424/userinfo 2022-4-24.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220424
+ mv enemy_relationship_47.253.49.46.2022-4-24.log friend_relationship_47.253.49.46.2022-4-24.log msgaction2_47.253.49.46.2022-4-24.log msgaction_47.253.49.46.2022-4-24.log msgtype_47.253.49.46.2022-4-24.log user_equipment_47.253.49.46.2022-4-24.log user_eudemons_47.253.49.46.2022-4-24.log user_extension_47.253.49.46.2022-4-24.log user_family_47.253.49.46.2022-4-24.log user_login_47.253.49.46.2022-4-24.log 20220424
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220424'
/bin/bash etl-log_load.sh 20220424
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220424
2022-4-24
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220424/user_login_47.253.49.46.2022-4-24.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220424/user_family_47.253.49.46.2022-4-24.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220424/user_eudemons_47.253.49.46.2022-4-24.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220424/user_equipment_47.253.49.46.2022-4-24.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220424/friend_relationship_47.253.49.46.2022-4-24.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220424/enemy_relationship_47.253.49.46.2022-4-24.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220424/user_extension_47.253.49.46.2022-4-24.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220424/msgaction_47.253.49.46.2022-4-24.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220424/msgaction2_47.253.49.46.2022-4-24.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220424/msgtype_47.253.49.46.2022-4-24.log': No such file or directory
++ date +%Y%m%d -d '20220424 +1day'
+ date_str=20220425
+ [[ 20220425 != \2\0\2\2\0\4\2\5 ]]
20220425
20220426
+ start_date=20220425
+ end_date=20220426
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220425
+ echo 20220425
20220425
+ [[ 20220425 != \2\0\2\2\0\4\2\6 ]]
+ echo 20220425
20220425
+ echo '/bin/bash etl-log_extract.sh 20220425'
/bin/bash etl-log_extract.sh 20220425
+ /bin/bash ../etl/log_extract.sh 20220425
2022-4-25
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-25.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-25.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-25.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-25.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220425
+ mv 'msgaction 2022-4-25.log' 'msgaction2 2022-4-25.log' 'msgtype 2022-4-25.log' 'userinfo 2022-4-25.log' 20220425
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220425'
/bin/bash etl-log_transform.sh 20220425
+ /bin/bash ../etl/log_transform.sh 20220425
2022-4-25
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220425/msgaction 2022-4-25.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220425/msgaction2 2022-4-25.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220425/msgtype 2022-4-25.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220425/userinfo 2022-4-25.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220425
+ mv enemy_relationship_47.253.49.46.2022-4-25.log friend_relationship_47.253.49.46.2022-4-25.log msgaction2_47.253.49.46.2022-4-25.log msgaction_47.253.49.46.2022-4-25.log msgtype_47.253.49.46.2022-4-25.log user_equipment_47.253.49.46.2022-4-25.log user_eudemons_47.253.49.46.2022-4-25.log user_extension_47.253.49.46.2022-4-25.log user_family_47.253.49.46.2022-4-25.log user_login_47.253.49.46.2022-4-25.log 20220425
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220425'
/bin/bash etl-log_load.sh 20220425
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220425
2022-4-25
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220425/user_login_47.253.49.46.2022-4-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220425/user_family_47.253.49.46.2022-4-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220425/user_eudemons_47.253.49.46.2022-4-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220425/user_equipment_47.253.49.46.2022-4-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220425/friend_relationship_47.253.49.46.2022-4-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220425/enemy_relationship_47.253.49.46.2022-4-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220425/user_extension_47.253.49.46.2022-4-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220425/msgaction_47.253.49.46.2022-4-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220425/msgaction2_47.253.49.46.2022-4-25.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220425/msgtype_47.253.49.46.2022-4-25.log': No such file or directory
++ date +%Y%m%d -d '20220425 +1day'
+ date_str=20220426
+ [[ 20220426 != \2\0\2\2\0\4\2\6 ]]
20220426
20220427
+ start_date=20220426
+ end_date=20220427
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220426
+ echo 20220426
20220426
+ [[ 20220426 != \2\0\2\2\0\4\2\7 ]]
+ echo 20220426
20220426
+ echo '/bin/bash etl-log_extract.sh 20220426'
/bin/bash etl-log_extract.sh 20220426
+ /bin/bash ../etl/log_extract.sh 20220426
2022-4-26
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-26.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-26.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-26.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-26.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220426
+ mv 'msgaction 2022-4-26.log' 'msgaction2 2022-4-26.log' 'msgtype 2022-4-26.log' 'userinfo 2022-4-26.log' 20220426
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220426'
/bin/bash etl-log_transform.sh 20220426
+ /bin/bash ../etl/log_transform.sh 20220426
2022-4-26
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220426/msgaction 2022-4-26.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220426/msgaction2 2022-4-26.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220426/msgtype 2022-4-26.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220426/userinfo 2022-4-26.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220426
+ mv enemy_relationship_47.253.49.46.2022-4-26.log friend_relationship_47.253.49.46.2022-4-26.log msgaction2_47.253.49.46.2022-4-26.log msgaction_47.253.49.46.2022-4-26.log msgtype_47.253.49.46.2022-4-26.log user_equipment_47.253.49.46.2022-4-26.log user_eudemons_47.253.49.46.2022-4-26.log user_extension_47.253.49.46.2022-4-26.log user_family_47.253.49.46.2022-4-26.log user_login_47.253.49.46.2022-4-26.log 20220426
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220426'
/bin/bash etl-log_load.sh 20220426
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220426
2022-4-26
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220426/user_login_47.253.49.46.2022-4-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220426/user_family_47.253.49.46.2022-4-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220426/user_eudemons_47.253.49.46.2022-4-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220426/user_equipment_47.253.49.46.2022-4-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220426/friend_relationship_47.253.49.46.2022-4-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220426/enemy_relationship_47.253.49.46.2022-4-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220426/user_extension_47.253.49.46.2022-4-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220426/msgaction_47.253.49.46.2022-4-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220426/msgaction2_47.253.49.46.2022-4-26.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220426/msgtype_47.253.49.46.2022-4-26.log': No such file or directory
++ date +%Y%m%d -d '20220426 +1day'
+ date_str=20220427
+ [[ 20220427 != \2\0\2\2\0\4\2\7 ]]
20220427
20220428
+ start_date=20220427
+ end_date=20220428
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220427
+ echo 20220427
20220427
+ [[ 20220427 != \2\0\2\2\0\4\2\8 ]]
+ echo 20220427
20220427
+ echo '/bin/bash etl-log_extract.sh 20220427'
/bin/bash etl-log_extract.sh 20220427
+ /bin/bash ../etl/log_extract.sh 20220427
2022-4-27
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-27.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-27.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-27.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-27.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220427
+ mv 'msgaction 2022-4-27.log' 'msgaction2 2022-4-27.log' 'msgtype 2022-4-27.log' 'userinfo 2022-4-27.log' 20220427
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220427'
/bin/bash etl-log_transform.sh 20220427
+ /bin/bash ../etl/log_transform.sh 20220427
2022-4-27
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220427/msgaction 2022-4-27.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220427/msgaction2 2022-4-27.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220427/msgtype 2022-4-27.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220427/userinfo 2022-4-27.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220427
+ mv enemy_relationship_47.253.49.46.2022-4-27.log friend_relationship_47.253.49.46.2022-4-27.log msgaction2_47.253.49.46.2022-4-27.log msgaction_47.253.49.46.2022-4-27.log msgtype_47.253.49.46.2022-4-27.log user_equipment_47.253.49.46.2022-4-27.log user_eudemons_47.253.49.46.2022-4-27.log user_extension_47.253.49.46.2022-4-27.log user_family_47.253.49.46.2022-4-27.log user_login_47.253.49.46.2022-4-27.log 20220427
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220427'
/bin/bash etl-log_load.sh 20220427
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220427
2022-4-27
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220427/user_login_47.253.49.46.2022-4-27.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220427/user_family_47.253.49.46.2022-4-27.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220427/user_eudemons_47.253.49.46.2022-4-27.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220427/user_equipment_47.253.49.46.2022-4-27.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220427/friend_relationship_47.253.49.46.2022-4-27.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220427/enemy_relationship_47.253.49.46.2022-4-27.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220427/user_extension_47.253.49.46.2022-4-27.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220427/msgaction_47.253.49.46.2022-4-27.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220427/msgaction2_47.253.49.46.2022-4-27.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220427/msgtype_47.253.49.46.2022-4-27.log': No such file or directory
++ date +%Y%m%d -d '20220427 +1day'
+ date_str=20220428
+ [[ 20220428 != \2\0\2\2\0\4\2\8 ]]
20220428
20220429
+ start_date=20220428
+ end_date=20220429
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220428
+ echo 20220428
20220428
+ [[ 20220428 != \2\0\2\2\0\4\2\9 ]]
+ echo 20220428
20220428
+ echo '/bin/bash etl-log_extract.sh 20220428'
/bin/bash etl-log_extract.sh 20220428
+ /bin/bash ../etl/log_extract.sh 20220428
2022-4-28
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-28.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-28.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-28.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-28.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220428
+ mv 'msgaction 2022-4-28.log' 'msgaction2 2022-4-28.log' 'msgtype 2022-4-28.log' 'userinfo 2022-4-28.log' 20220428
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220428'
/bin/bash etl-log_transform.sh 20220428
+ /bin/bash ../etl/log_transform.sh 20220428
2022-4-28
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220428/msgaction 2022-4-28.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220428/msgaction2 2022-4-28.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220428/msgtype 2022-4-28.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220428/userinfo 2022-4-28.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220428
+ mv enemy_relationship_47.253.49.46.2022-4-28.log friend_relationship_47.253.49.46.2022-4-28.log msgaction2_47.253.49.46.2022-4-28.log msgaction_47.253.49.46.2022-4-28.log msgtype_47.253.49.46.2022-4-28.log user_equipment_47.253.49.46.2022-4-28.log user_eudemons_47.253.49.46.2022-4-28.log user_extension_47.253.49.46.2022-4-28.log user_family_47.253.49.46.2022-4-28.log user_login_47.253.49.46.2022-4-28.log 20220428
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220428'
/bin/bash etl-log_load.sh 20220428
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220428
2022-4-28
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220428/user_login_47.253.49.46.2022-4-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220428/user_family_47.253.49.46.2022-4-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220428/user_eudemons_47.253.49.46.2022-4-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220428/user_equipment_47.253.49.46.2022-4-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220428/friend_relationship_47.253.49.46.2022-4-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220428/enemy_relationship_47.253.49.46.2022-4-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220428/user_extension_47.253.49.46.2022-4-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220428/msgaction_47.253.49.46.2022-4-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220428/msgaction2_47.253.49.46.2022-4-28.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220428/msgtype_47.253.49.46.2022-4-28.log': No such file or directory
++ date +%Y%m%d -d '20220428 +1day'
+ date_str=20220429
+ [[ 20220429 != \2\0\2\2\0\4\2\9 ]]
20220429
20220430
+ start_date=20220429
+ end_date=20220430
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220429
+ echo 20220429
20220429
+ [[ 20220429 != \2\0\2\2\0\4\3\0 ]]
+ echo 20220429
20220429
+ echo '/bin/bash etl-log_extract.sh 20220429'
/bin/bash etl-log_extract.sh 20220429
+ /bin/bash ../etl/log_extract.sh 20220429
2022-4-29
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-29.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-29.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-29.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-29.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220429
+ mv 'msgaction 2022-4-29.log' 'msgaction2 2022-4-29.log' 'msgtype 2022-4-29.log' 'userinfo 2022-4-29.log' 20220429
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220429'
/bin/bash etl-log_transform.sh 20220429
+ /bin/bash ../etl/log_transform.sh 20220429
2022-4-29
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220429/msgaction 2022-4-29.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220429/msgaction2 2022-4-29.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220429/msgtype 2022-4-29.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220429/userinfo 2022-4-29.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220429
+ mv enemy_relationship_47.253.49.46.2022-4-29.log friend_relationship_47.253.49.46.2022-4-29.log msgaction2_47.253.49.46.2022-4-29.log msgaction_47.253.49.46.2022-4-29.log msgtype_47.253.49.46.2022-4-29.log user_equipment_47.253.49.46.2022-4-29.log user_eudemons_47.253.49.46.2022-4-29.log user_extension_47.253.49.46.2022-4-29.log user_family_47.253.49.46.2022-4-29.log user_login_47.253.49.46.2022-4-29.log 20220429
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220429'
/bin/bash etl-log_load.sh 20220429
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220429
2022-4-29
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220429/user_login_47.253.49.46.2022-4-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220429/user_family_47.253.49.46.2022-4-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220429/user_eudemons_47.253.49.46.2022-4-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220429/user_equipment_47.253.49.46.2022-4-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220429/friend_relationship_47.253.49.46.2022-4-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220429/enemy_relationship_47.253.49.46.2022-4-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220429/user_extension_47.253.49.46.2022-4-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220429/msgaction_47.253.49.46.2022-4-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220429/msgaction2_47.253.49.46.2022-4-29.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220429/msgtype_47.253.49.46.2022-4-29.log': No such file or directory
++ date +%Y%m%d -d '20220429 +1day'
+ date_str=20220430
+ [[ 20220430 != \2\0\2\2\0\4\3\0 ]]
20220430
20220501
+ start_date=20220430
+ end_date=20220501
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220430
+ echo 20220430
20220430
+ [[ 20220430 != \2\0\2\2\0\5\0\1 ]]
+ echo 20220430
20220430
+ echo '/bin/bash etl-log_extract.sh 20220430'
/bin/bash etl-log_extract.sh 20220430
+ /bin/bash ../etl/log_extract.sh 20220430
2022-4-30
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-4-30.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-4-30.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-4-30.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-4-30.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220430
+ mv 'msgaction 2022-4-30.log' 'msgaction2 2022-4-30.log' 'msgtype 2022-4-30.log' 'userinfo 2022-4-30.log' 20220430
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220430'
/bin/bash etl-log_transform.sh 20220430
+ /bin/bash ../etl/log_transform.sh 20220430
2022-4-30
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220430/msgaction 2022-4-30.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220430/msgaction2 2022-4-30.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220430/msgtype 2022-4-30.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220430/userinfo 2022-4-30.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220430
+ mv enemy_relationship_47.253.49.46.2022-4-30.log friend_relationship_47.253.49.46.2022-4-30.log msgaction2_47.253.49.46.2022-4-30.log msgaction_47.253.49.46.2022-4-30.log msgtype_47.253.49.46.2022-4-30.log user_equipment_47.253.49.46.2022-4-30.log user_eudemons_47.253.49.46.2022-4-30.log user_extension_47.253.49.46.2022-4-30.log user_family_47.253.49.46.2022-4-30.log user_login_47.253.49.46.2022-4-30.log 20220430
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220430'
/bin/bash etl-log_load.sh 20220430
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220430
2022-4-30
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220430/user_login_47.253.49.46.2022-4-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220430/user_family_47.253.49.46.2022-4-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220430/user_eudemons_47.253.49.46.2022-4-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220430/user_equipment_47.253.49.46.2022-4-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220430/friend_relationship_47.253.49.46.2022-4-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220430/enemy_relationship_47.253.49.46.2022-4-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220430/user_extension_47.253.49.46.2022-4-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220430/msgaction_47.253.49.46.2022-4-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220430/msgaction2_47.253.49.46.2022-4-30.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220430/msgtype_47.253.49.46.2022-4-30.log': No such file or directory
++ date +%Y%m%d -d '20220430 +1day'
+ date_str=20220501
+ [[ 20220501 != \2\0\2\2\0\5\0\1 ]]
20220501
20220502
+ start_date=20220501
+ end_date=20220502
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220501
+ echo 20220501
20220501
+ [[ 20220501 != \2\0\2\2\0\5\0\2 ]]
+ echo 20220501
20220501
+ echo '/bin/bash etl-log_extract.sh 20220501'
/bin/bash etl-log_extract.sh 20220501
+ /bin/bash ../etl/log_extract.sh 20220501
2022-5-1
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-1.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-5-1.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-5-1.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-5-1.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220501
+ mv 'msgaction 2022-5-1.log' 'msgaction2 2022-5-1.log' 'msgtype 2022-5-1.log' 'userinfo 2022-5-1.log' 20220501
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220501'
/bin/bash etl-log_transform.sh 20220501
+ /bin/bash ../etl/log_transform.sh 20220501
2022-5-1
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220501/msgaction 2022-5-1.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220501/msgaction2 2022-5-1.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220501/msgtype 2022-5-1.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220501/userinfo 2022-5-1.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220501
+ mv enemy_relationship_47.253.49.46.2022-5-1.log friend_relationship_47.253.49.46.2022-5-1.log msgaction2_47.253.49.46.2022-5-1.log msgaction_47.253.49.46.2022-5-1.log msgtype_47.253.49.46.2022-5-1.log user_equipment_47.253.49.46.2022-5-1.log user_eudemons_47.253.49.46.2022-5-1.log user_extension_47.253.49.46.2022-5-1.log user_family_47.253.49.46.2022-5-1.log user_login_47.253.49.46.2022-5-1.log 20220501
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220501'
/bin/bash etl-log_load.sh 20220501
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220501
2022-5-1
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220501/user_login_47.253.49.46.2022-5-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220501/user_family_47.253.49.46.2022-5-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220501/user_eudemons_47.253.49.46.2022-5-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220501/user_equipment_47.253.49.46.2022-5-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220501/friend_relationship_47.253.49.46.2022-5-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220501/enemy_relationship_47.253.49.46.2022-5-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220501/user_extension_47.253.49.46.2022-5-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220501/msgaction_47.253.49.46.2022-5-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220501/msgaction2_47.253.49.46.2022-5-1.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220501/msgtype_47.253.49.46.2022-5-1.log': No such file or directory
++ date +%Y%m%d -d '20220501 +1day'
+ date_str=20220502
+ [[ 20220502 != \2\0\2\2\0\5\0\2 ]]
20220502
20220503
+ start_date=20220502
+ end_date=20220503
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220502
+ echo 20220502
20220502
+ [[ 20220502 != \2\0\2\2\0\5\0\3 ]]
+ echo 20220502
20220502
+ echo '/bin/bash etl-log_extract.sh 20220502'
/bin/bash etl-log_extract.sh 20220502
+ /bin/bash ../etl/log_extract.sh 20220502
2022-5-2
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-2.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-5-2.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-5-2.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-5-2.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220502
+ mv 'msgaction 2022-5-2.log' 'msgaction2 2022-5-2.log' 'msgtype 2022-5-2.log' 'userinfo 2022-5-2.log' 20220502
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220502'
/bin/bash etl-log_transform.sh 20220502
+ /bin/bash ../etl/log_transform.sh 20220502
2022-5-2
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220502/msgaction 2022-5-2.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220502/msgaction2 2022-5-2.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220502/msgtype 2022-5-2.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220502/userinfo 2022-5-2.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220502
+ mv enemy_relationship_47.253.49.46.2022-5-2.log friend_relationship_47.253.49.46.2022-5-2.log msgaction2_47.253.49.46.2022-5-2.log msgaction_47.253.49.46.2022-5-2.log msgtype_47.253.49.46.2022-5-2.log user_equipment_47.253.49.46.2022-5-2.log user_eudemons_47.253.49.46.2022-5-2.log user_extension_47.253.49.46.2022-5-2.log user_family_47.253.49.46.2022-5-2.log user_login_47.253.49.46.2022-5-2.log 20220502
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220502'
/bin/bash etl-log_load.sh 20220502
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220502
2022-5-2
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220502/user_login_47.253.49.46.2022-5-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220502/user_family_47.253.49.46.2022-5-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220502/user_eudemons_47.253.49.46.2022-5-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220502/user_equipment_47.253.49.46.2022-5-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220502/friend_relationship_47.253.49.46.2022-5-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220502/enemy_relationship_47.253.49.46.2022-5-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220502/user_extension_47.253.49.46.2022-5-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220502/msgaction_47.253.49.46.2022-5-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220502/msgaction2_47.253.49.46.2022-5-2.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220502/msgtype_47.253.49.46.2022-5-2.log': No such file or directory
++ date +%Y%m%d -d '20220502 +1day'
+ date_str=20220503
+ [[ 20220503 != \2\0\2\2\0\5\0\3 ]]
20220503
20220504
+ start_date=20220503
+ end_date=20220504
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220503
+ echo 20220503
20220503
+ [[ 20220503 != \2\0\2\2\0\5\0\4 ]]
+ echo 20220503
20220503
+ echo '/bin/bash etl-log_extract.sh 20220503'
/bin/bash etl-log_extract.sh 20220503
+ /bin/bash ../etl/log_extract.sh 20220503
2022-5-3
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-3.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-5-3.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-5-3.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-5-3.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220503
+ mv 'msgaction 2022-5-3.log' 'msgaction2 2022-5-3.log' 'msgtype 2022-5-3.log' 'userinfo 2022-5-3.log' 20220503
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220503'
/bin/bash etl-log_transform.sh 20220503
+ /bin/bash ../etl/log_transform.sh 20220503
2022-5-3
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220503/msgaction 2022-5-3.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220503/msgaction2 2022-5-3.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220503/msgtype 2022-5-3.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220503/userinfo 2022-5-3.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220503
+ mv enemy_relationship_47.253.49.46.2022-5-3.log friend_relationship_47.253.49.46.2022-5-3.log msgaction2_47.253.49.46.2022-5-3.log msgaction_47.253.49.46.2022-5-3.log msgtype_47.253.49.46.2022-5-3.log user_equipment_47.253.49.46.2022-5-3.log user_eudemons_47.253.49.46.2022-5-3.log user_extension_47.253.49.46.2022-5-3.log user_family_47.253.49.46.2022-5-3.log user_login_47.253.49.46.2022-5-3.log 20220503
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220503'
/bin/bash etl-log_load.sh 20220503
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220503
2022-5-3
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220503/user_login_47.253.49.46.2022-5-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220503/user_family_47.253.49.46.2022-5-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220503/user_eudemons_47.253.49.46.2022-5-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220503/user_equipment_47.253.49.46.2022-5-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220503/friend_relationship_47.253.49.46.2022-5-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220503/enemy_relationship_47.253.49.46.2022-5-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220503/user_extension_47.253.49.46.2022-5-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220503/msgaction_47.253.49.46.2022-5-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220503/msgaction2_47.253.49.46.2022-5-3.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220503/msgtype_47.253.49.46.2022-5-3.log': No such file or directory
++ date +%Y%m%d -d '20220503 +1day'
+ date_str=20220504
+ [[ 20220504 != \2\0\2\2\0\5\0\4 ]]
20220504
20220505
+ start_date=20220504
+ end_date=20220505
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220504
+ echo 20220504
20220504
+ [[ 20220504 != \2\0\2\2\0\5\0\5 ]]
+ echo 20220504
20220504
+ echo '/bin/bash etl-log_extract.sh 20220504'
/bin/bash etl-log_extract.sh 20220504
+ /bin/bash ../etl/log_extract.sh 20220504
2022-5-4
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-4.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-5-4.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-5-4.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-5-4.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220504
+ mv 'msgaction 2022-5-4.log' 'msgaction2 2022-5-4.log' 'msgtype 2022-5-4.log' 'userinfo 2022-5-4.log' 20220504
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220504'
/bin/bash etl-log_transform.sh 20220504
+ /bin/bash ../etl/log_transform.sh 20220504
2022-5-4
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220504/msgaction 2022-5-4.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220504/msgaction2 2022-5-4.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220504/msgtype 2022-5-4.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220504/userinfo 2022-5-4.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220504
+ mv enemy_relationship_47.253.49.46.2022-5-4.log friend_relationship_47.253.49.46.2022-5-4.log msgaction2_47.253.49.46.2022-5-4.log msgaction_47.253.49.46.2022-5-4.log msgtype_47.253.49.46.2022-5-4.log user_equipment_47.253.49.46.2022-5-4.log user_eudemons_47.253.49.46.2022-5-4.log user_extension_47.253.49.46.2022-5-4.log user_family_47.253.49.46.2022-5-4.log user_login_47.253.49.46.2022-5-4.log 20220504
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220504'
/bin/bash etl-log_load.sh 20220504
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220504
2022-5-4
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220504/user_login_47.253.49.46.2022-5-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220504/user_family_47.253.49.46.2022-5-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220504/user_eudemons_47.253.49.46.2022-5-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220504/user_equipment_47.253.49.46.2022-5-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220504/friend_relationship_47.253.49.46.2022-5-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220504/enemy_relationship_47.253.49.46.2022-5-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220504/user_extension_47.253.49.46.2022-5-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220504/msgaction_47.253.49.46.2022-5-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220504/msgaction2_47.253.49.46.2022-5-4.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220504/msgtype_47.253.49.46.2022-5-4.log': No such file or directory
++ date +%Y%m%d -d '20220504 +1day'
+ date_str=20220505
+ [[ 20220505 != \2\0\2\2\0\5\0\5 ]]
20220505
20220506
+ start_date=20220505
+ end_date=20220506
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220505
+ echo 20220505
20220505
+ [[ 20220505 != \2\0\2\2\0\5\0\6 ]]
+ echo 20220505
20220505
+ echo '/bin/bash etl-log_extract.sh 20220505'
/bin/bash etl-log_extract.sh 20220505
+ /bin/bash ../etl/log_extract.sh 20220505
2022-5-5
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-5.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-5-5.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-5-5.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-5-5.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220505
+ mv 'msgaction 2022-5-5.log' 'msgaction2 2022-5-5.log' 'msgtype 2022-5-5.log' 'userinfo 2022-5-5.log' 20220505
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220505'
/bin/bash etl-log_transform.sh 20220505
+ /bin/bash ../etl/log_transform.sh 20220505
2022-5-5
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220505/msgaction 2022-5-5.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220505/msgaction2 2022-5-5.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220505/msgtype 2022-5-5.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220505/userinfo 2022-5-5.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220505
+ mv enemy_relationship_47.253.49.46.2022-5-5.log friend_relationship_47.253.49.46.2022-5-5.log msgaction2_47.253.49.46.2022-5-5.log msgaction_47.253.49.46.2022-5-5.log msgtype_47.253.49.46.2022-5-5.log user_equipment_47.253.49.46.2022-5-5.log user_eudemons_47.253.49.46.2022-5-5.log user_extension_47.253.49.46.2022-5-5.log user_family_47.253.49.46.2022-5-5.log user_login_47.253.49.46.2022-5-5.log 20220505
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220505'
/bin/bash etl-log_load.sh 20220505
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220505
2022-5-5
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220505/user_login_47.253.49.46.2022-5-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220505/user_family_47.253.49.46.2022-5-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220505/user_eudemons_47.253.49.46.2022-5-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220505/user_equipment_47.253.49.46.2022-5-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220505/friend_relationship_47.253.49.46.2022-5-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220505/enemy_relationship_47.253.49.46.2022-5-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220505/user_extension_47.253.49.46.2022-5-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220505/msgaction_47.253.49.46.2022-5-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220505/msgaction2_47.253.49.46.2022-5-5.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220505/msgtype_47.253.49.46.2022-5-5.log': No such file or directory
++ date +%Y%m%d -d '20220505 +1day'
+ date_str=20220506
+ [[ 20220506 != \2\0\2\2\0\5\0\6 ]]
20220506
20220507
+ start_date=20220506
+ end_date=20220507
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220506
+ echo 20220506
20220506
+ [[ 20220506 != \2\0\2\2\0\5\0\7 ]]
+ echo 20220506
20220506
+ echo '/bin/bash etl-log_extract.sh 20220506'
/bin/bash etl-log_extract.sh 20220506
+ /bin/bash ../etl/log_extract.sh 20220506
2022-5-6
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-6.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-5-6.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-5-6.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-5-6.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220506
+ mv 'msgaction 2022-5-6.log' 'msgaction2 2022-5-6.log' 'msgtype 2022-5-6.log' 'userinfo 2022-5-6.log' 20220506
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220506'
/bin/bash etl-log_transform.sh 20220506
+ /bin/bash ../etl/log_transform.sh 20220506
2022-5-6
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220506/msgaction 2022-5-6.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220506/msgaction2 2022-5-6.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220506/msgtype 2022-5-6.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220506/userinfo 2022-5-6.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220506
+ mv enemy_relationship_47.253.49.46.2022-5-6.log friend_relationship_47.253.49.46.2022-5-6.log msgaction2_47.253.49.46.2022-5-6.log msgaction_47.253.49.46.2022-5-6.log msgtype_47.253.49.46.2022-5-6.log user_equipment_47.253.49.46.2022-5-6.log user_eudemons_47.253.49.46.2022-5-6.log user_extension_47.253.49.46.2022-5-6.log user_family_47.253.49.46.2022-5-6.log user_login_47.253.49.46.2022-5-6.log 20220506
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220506'
/bin/bash etl-log_load.sh 20220506
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220506
2022-5-6
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220506/user_login_47.253.49.46.2022-5-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220506/user_family_47.253.49.46.2022-5-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220506/user_eudemons_47.253.49.46.2022-5-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220506/user_equipment_47.253.49.46.2022-5-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220506/friend_relationship_47.253.49.46.2022-5-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220506/enemy_relationship_47.253.49.46.2022-5-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220506/user_extension_47.253.49.46.2022-5-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220506/msgaction_47.253.49.46.2022-5-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220506/msgaction2_47.253.49.46.2022-5-6.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220506/msgtype_47.253.49.46.2022-5-6.log': No such file or directory
++ date +%Y%m%d -d '20220506 +1day'
+ date_str=20220507
+ [[ 20220507 != \2\0\2\2\0\5\0\7 ]]
20220507
20220508
+ start_date=20220507
+ end_date=20220508
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220507
+ echo 20220507
20220507
+ [[ 20220507 != \2\0\2\2\0\5\0\8 ]]
+ echo 20220507
20220507
+ echo '/bin/bash etl-log_extract.sh 20220507'
/bin/bash etl-log_extract.sh 20220507
+ /bin/bash ../etl/log_extract.sh 20220507
2022-5-7
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-7.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-5-7.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-5-7.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-5-7.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220507
+ mv 'msgaction 2022-5-7.log' 'msgaction2 2022-5-7.log' 'msgtype 2022-5-7.log' 'userinfo 2022-5-7.log' 20220507
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220507'
/bin/bash etl-log_transform.sh 20220507
+ /bin/bash ../etl/log_transform.sh 20220507
2022-5-7
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220507/msgaction 2022-5-7.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220507/msgaction2 2022-5-7.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220507/msgtype 2022-5-7.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220507/userinfo 2022-5-7.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220507
+ mv enemy_relationship_47.253.49.46.2022-5-7.log friend_relationship_47.253.49.46.2022-5-7.log msgaction2_47.253.49.46.2022-5-7.log msgaction_47.253.49.46.2022-5-7.log msgtype_47.253.49.46.2022-5-7.log user_equipment_47.253.49.46.2022-5-7.log user_eudemons_47.253.49.46.2022-5-7.log user_extension_47.253.49.46.2022-5-7.log user_family_47.253.49.46.2022-5-7.log user_login_47.253.49.46.2022-5-7.log 20220507
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220507'
/bin/bash etl-log_load.sh 20220507
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220507
2022-5-7
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220507/user_login_47.253.49.46.2022-5-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220507/user_family_47.253.49.46.2022-5-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220507/user_eudemons_47.253.49.46.2022-5-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220507/user_equipment_47.253.49.46.2022-5-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220507/friend_relationship_47.253.49.46.2022-5-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220507/enemy_relationship_47.253.49.46.2022-5-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220507/user_extension_47.253.49.46.2022-5-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220507/msgaction_47.253.49.46.2022-5-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220507/msgaction2_47.253.49.46.2022-5-7.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220507/msgtype_47.253.49.46.2022-5-7.log': No such file or directory
++ date +%Y%m%d -d '20220507 +1day'
+ date_str=20220508
+ [[ 20220508 != \2\0\2\2\0\5\0\8 ]]
20220508
20220509
+ start_date=20220508
+ end_date=20220509
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220508
+ echo 20220508
20220508
+ [[ 20220508 != \2\0\2\2\0\5\0\9 ]]
+ echo 20220508
20220508
+ echo '/bin/bash etl-log_extract.sh 20220508'
/bin/bash etl-log_extract.sh 20220508
+ /bin/bash ../etl/log_extract.sh 20220508
2022-5-8
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-8.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-5-8.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-5-8.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-5-8.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220508
+ mv 'msgaction 2022-5-8.log' 'msgaction2 2022-5-8.log' 'msgtype 2022-5-8.log' 'userinfo 2022-5-8.log' 20220508
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220508'
/bin/bash etl-log_transform.sh 20220508
+ /bin/bash ../etl/log_transform.sh 20220508
2022-5-8
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220508/msgaction 2022-5-8.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220508/msgaction2 2022-5-8.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220508/msgtype 2022-5-8.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220508/userinfo 2022-5-8.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220508
+ mv enemy_relationship_47.253.49.46.2022-5-8.log friend_relationship_47.253.49.46.2022-5-8.log msgaction2_47.253.49.46.2022-5-8.log msgaction_47.253.49.46.2022-5-8.log msgtype_47.253.49.46.2022-5-8.log user_equipment_47.253.49.46.2022-5-8.log user_eudemons_47.253.49.46.2022-5-8.log user_extension_47.253.49.46.2022-5-8.log user_family_47.253.49.46.2022-5-8.log user_login_47.253.49.46.2022-5-8.log 20220508
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220508'
/bin/bash etl-log_load.sh 20220508
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220508
2022-5-8
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220508/user_login_47.253.49.46.2022-5-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220508/user_family_47.253.49.46.2022-5-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220508/user_eudemons_47.253.49.46.2022-5-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220508/user_equipment_47.253.49.46.2022-5-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220508/friend_relationship_47.253.49.46.2022-5-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220508/enemy_relationship_47.253.49.46.2022-5-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220508/user_extension_47.253.49.46.2022-5-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220508/msgaction_47.253.49.46.2022-5-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220508/msgaction2_47.253.49.46.2022-5-8.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220508/msgtype_47.253.49.46.2022-5-8.log': No such file or directory
++ date +%Y%m%d -d '20220508 +1day'
+ date_str=20220509
+ [[ 20220509 != \2\0\2\2\0\5\0\9 ]]
20220509
20220510
+ start_date=20220509
+ end_date=20220510
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220509
+ echo 20220509
20220509
+ [[ 20220509 != \2\0\2\2\0\5\1\0 ]]
+ echo 20220509
20220509
+ echo '/bin/bash etl-log_extract.sh 20220509'
/bin/bash etl-log_extract.sh 20220509
+ /bin/bash ../etl/log_extract.sh 20220509
2022-5-9
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-9.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-5-9.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-5-9.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-5-9.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220509
+ mv 'msgaction 2022-5-9.log' 'msgaction2 2022-5-9.log' 'msgtype 2022-5-9.log' 'userinfo 2022-5-9.log' 20220509
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220509'
/bin/bash etl-log_transform.sh 20220509
+ /bin/bash ../etl/log_transform.sh 20220509
2022-5-9
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220509/msgaction 2022-5-9.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220509/msgaction2 2022-5-9.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220509/msgtype 2022-5-9.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220509/userinfo 2022-5-9.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220509
+ mv enemy_relationship_47.253.49.46.2022-5-9.log friend_relationship_47.253.49.46.2022-5-9.log msgaction2_47.253.49.46.2022-5-9.log msgaction_47.253.49.46.2022-5-9.log msgtype_47.253.49.46.2022-5-9.log user_equipment_47.253.49.46.2022-5-9.log user_eudemons_47.253.49.46.2022-5-9.log user_extension_47.253.49.46.2022-5-9.log user_family_47.253.49.46.2022-5-9.log user_login_47.253.49.46.2022-5-9.log 20220509
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220509'
/bin/bash etl-log_load.sh 20220509
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220509
2022-5-9
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220509/user_login_47.253.49.46.2022-5-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220509/user_family_47.253.49.46.2022-5-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220509/user_eudemons_47.253.49.46.2022-5-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220509/user_equipment_47.253.49.46.2022-5-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220509/friend_relationship_47.253.49.46.2022-5-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220509/enemy_relationship_47.253.49.46.2022-5-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220509/user_extension_47.253.49.46.2022-5-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220509/msgaction_47.253.49.46.2022-5-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220509/msgaction2_47.253.49.46.2022-5-9.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220509/msgtype_47.253.49.46.2022-5-9.log': No such file or directory
++ date +%Y%m%d -d '20220509 +1day'
+ date_str=20220510
+ [[ 20220510 != \2\0\2\2\0\5\1\0 ]]
20220510
20220511
+ start_date=20220510
+ end_date=20220511
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220510
+ echo 20220510
20220510
+ [[ 20220510 != \2\0\2\2\0\5\1\1 ]]
+ echo 20220510
20220510
+ echo '/bin/bash etl-log_extract.sh 20220510'
/bin/bash etl-log_extract.sh 20220510
+ /bin/bash ../etl/log_extract.sh 20220510
2022-5-10
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-10.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-5-10.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-5-10.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-5-10.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220510
+ mv 'msgaction 2022-5-10.log' 'msgaction2 2022-5-10.log' 'msgtype 2022-5-10.log' 'userinfo 2022-5-10.log' 20220510
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220510'
/bin/bash etl-log_transform.sh 20220510
+ /bin/bash ../etl/log_transform.sh 20220510
2022-5-10
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220510/msgaction 2022-5-10.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220510/msgaction2 2022-5-10.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220510/msgtype 2022-5-10.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220510/userinfo 2022-5-10.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220510
+ mv enemy_relationship_47.253.49.46.2022-5-10.log friend_relationship_47.253.49.46.2022-5-10.log msgaction2_47.253.49.46.2022-5-10.log msgaction_47.253.49.46.2022-5-10.log msgtype_47.253.49.46.2022-5-10.log user_equipment_47.253.49.46.2022-5-10.log user_eudemons_47.253.49.46.2022-5-10.log user_extension_47.253.49.46.2022-5-10.log user_family_47.253.49.46.2022-5-10.log user_login_47.253.49.46.2022-5-10.log 20220510
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220510'
/bin/bash etl-log_load.sh 20220510
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220510
2022-5-10
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220510/user_login_47.253.49.46.2022-5-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220510/user_family_47.253.49.46.2022-5-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220510/user_eudemons_47.253.49.46.2022-5-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220510/user_equipment_47.253.49.46.2022-5-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220510/friend_relationship_47.253.49.46.2022-5-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220510/enemy_relationship_47.253.49.46.2022-5-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220510/user_extension_47.253.49.46.2022-5-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220510/msgaction_47.253.49.46.2022-5-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220510/msgaction2_47.253.49.46.2022-5-10.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220510/msgtype_47.253.49.46.2022-5-10.log': No such file or directory
++ date +%Y%m%d -d '20220510 +1day'
+ date_str=20220511
+ [[ 20220511 != \2\0\2\2\0\5\1\1 ]]
20220511
20220512
+ start_date=20220511
+ end_date=20220512
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220511
+ echo 20220511
20220511
+ [[ 20220511 != \2\0\2\2\0\5\1\2 ]]
+ echo 20220511
20220511
+ echo '/bin/bash etl-log_extract.sh 20220511'
/bin/bash etl-log_extract.sh 20220511
+ /bin/bash ../etl/log_extract.sh 20220511
2022-5-11
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-11.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction2 2022-5-11.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgtype 2022-5-11.log"
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/userinfo 2022-5-11.log"
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220511
+ mv 'msgaction 2022-5-11.log' 'msgaction2 2022-5-11.log' 'msgtype 2022-5-11.log' 'userinfo 2022-5-11.log' 20220511
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220511'
/bin/bash etl-log_transform.sh 20220511
+ /bin/bash ../etl/log_transform.sh 20220511
2022-5-11
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220511/msgaction 2022-5-11.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220511/msgaction2 2022-5-11.log
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220511/msgtype 2022-5-11.log
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220511/userinfo 2022-5-11.log
+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220511
+ mv enemy_relationship_47.253.49.46.2022-5-11.log friend_relationship_47.253.49.46.2022-5-11.log msgaction2_47.253.49.46.2022-5-11.log msgaction_47.253.49.46.2022-5-11.log msgtype_47.253.49.46.2022-5-11.log user_equipment_47.253.49.46.2022-5-11.log user_eudemons_47.253.49.46.2022-5-11.log user_extension_47.253.49.46.2022-5-11.log user_family_47.253.49.46.2022-5-11.log user_login_47.253.49.46.2022-5-11.log 20220511
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220511'
/bin/bash etl-log_load.sh 20220511
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220511
2022-5-11
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_login/47.253.49.46/20220511/user_login_47.253.49.46.2022-5-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_family/47.253.49.46/20220511/user_family_47.253.49.46.2022-5-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_eudemons/47.253.49.46/20220511/user_eudemons_47.253.49.46.2022-5-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_equipment/47.253.49.46/20220511/user_equipment_47.253.49.46.2022-5-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_friend_relationship/47.253.49.46/20220511/friend_relationship_47.253.49.46.2022-5-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_enemy_relationship/47.253.49.46/20220511/enemy_relationship_47.253.49.46.2022-5-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_user_extension/47.253.49.46/20220511/user_extension_47.253.49.46.2022-5-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220511/msgaction_47.253.49.46.2022-5-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction2/47.253.49.46/20220511/msgaction2_47.253.49.46.2022-5-11.log': No such file or directory
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgtype/47.253.49.46/20220511/msgtype_47.253.49.46.2022-5-11.log': No such file or directory
++ date +%Y%m%d -d '20220511 +1day'
+ date_str=20220512
+ [[ 20220512 != \2\0\2\2\0\5\1\2 ]]
20220512
20220513
+ start_date=20220512
+ end_date=20220513
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220512
+ echo 20220512
20220512
+ [[ 20220512 != \2\0\2\2\0\5\1\3 ]]
+ echo 20220512
20220512
+ echo '/bin/bash etl-log_extract.sh 20220512'
/bin/bash etl-log_extract.sh 20220512
+ /bin/bash ../etl/log_extract.sh 20220512
2022-5-12
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-12.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 42, in <module>
    client.download_file(
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 32, in download_file
    self.client.get(remote_file, local_file)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 811, in get
    size = self.getfo(remotepath, fl, callback, prefetch)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 782, in getfo
    file_size = self.stat(remotepath).st_size
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 493, in stat
    t, msg = self._request(CMD_STAT, path)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 822, in _request
    return self._read_response(num)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 874, in _read_response
    self._convert_status(msg)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 903, in _convert_status
    raise IOError(errno.ENOENT, text)
FileNotFoundError: [Errno 2] No Such File
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-12.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220512
+ mv 'msgaction 2022-5-12.log' 20220512
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220512'
/bin/bash etl-log_transform.sh 20220512
+ /bin/bash ../etl/log_transform.sh 20220512
2022-5-12
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220512/msgaction 2022-5-12.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220512/msgaction2 2022-5-12.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220512/msgaction2 2022-5-12.log 2022-5-12 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220512/msgtype 2022-5-12.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220512/msgtype 2022-5-12.log 2022-5-12 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220512/userinfo 2022-5-12.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220512/userinfo 2022-5-12.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220512
+ mv msgaction_47.253.49.46.2022-5-12.log 20220512
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220512'
/bin/bash etl-log_load.sh 20220512
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220512
2022-5-12
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220512/msgaction_47.253.49.46.2022-5-12.log': No such file or directory
++ date +%Y%m%d -d '20220512 +1day'
+ date_str=20220513
+ [[ 20220513 != \2\0\2\2\0\5\1\3 ]]
20220513
20220514
+ start_date=20220513
+ end_date=20220514
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220513
+ echo 20220513
20220513
+ [[ 20220513 != \2\0\2\2\0\5\1\4 ]]
+ echo 20220513
20220513
+ echo '/bin/bash etl-log_extract.sh 20220513'
/bin/bash etl-log_extract.sh 20220513
+ /bin/bash ../etl/log_extract.sh 20220513
2022-5-13
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-13.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 42, in <module>
    client.download_file(
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 32, in download_file
    self.client.get(remote_file, local_file)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 811, in get
    size = self.getfo(remotepath, fl, callback, prefetch)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 782, in getfo
    file_size = self.stat(remotepath).st_size
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 493, in stat
    t, msg = self._request(CMD_STAT, path)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 822, in _request
    return self._read_response(num)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 874, in _read_response
    self._convert_status(msg)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 903, in _convert_status
    raise IOError(errno.ENOENT, text)
FileNotFoundError: [Errno 2] No Such File
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-13.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220513
+ mv 'msgaction 2022-5-13.log' 20220513
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220513'
/bin/bash etl-log_transform.sh 20220513
+ /bin/bash ../etl/log_transform.sh 20220513
2022-5-13
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220513/msgaction 2022-5-13.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220513/msgaction2 2022-5-13.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220513/msgaction2 2022-5-13.log 2022-5-13 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220513/msgtype 2022-5-13.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220513/msgtype 2022-5-13.log 2022-5-13 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220513/userinfo 2022-5-13.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220513/userinfo 2022-5-13.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220513
+ mv msgaction_47.253.49.46.2022-5-13.log 20220513
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220513'
/bin/bash etl-log_load.sh 20220513
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220513
2022-5-13
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220513/msgaction_47.253.49.46.2022-5-13.log': No such file or directory
++ date +%Y%m%d -d '20220513 +1day'
+ date_str=20220514
+ [[ 20220514 != \2\0\2\2\0\5\1\4 ]]
20220514
20220515
+ start_date=20220514
+ end_date=20220515
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220514
+ echo 20220514
20220514
+ [[ 20220514 != \2\0\2\2\0\5\1\5 ]]
+ echo 20220514
20220514
+ echo '/bin/bash etl-log_extract.sh 20220514'
/bin/bash etl-log_extract.sh 20220514
+ /bin/bash ../etl/log_extract.sh 20220514
2022-5-14
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-14.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 42, in <module>
    client.download_file(
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 32, in download_file
    self.client.get(remote_file, local_file)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 811, in get
    size = self.getfo(remotepath, fl, callback, prefetch)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 782, in getfo
    file_size = self.stat(remotepath).st_size
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 493, in stat
    t, msg = self._request(CMD_STAT, path)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 822, in _request
    return self._read_response(num)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 874, in _read_response
    self._convert_status(msg)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 903, in _convert_status
    raise IOError(errno.ENOENT, text)
FileNotFoundError: [Errno 2] No Such File
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-14.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220514
+ mv 'msgaction 2022-5-14.log' 20220514
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220514'
/bin/bash etl-log_transform.sh 20220514
+ /bin/bash ../etl/log_transform.sh 20220514
2022-5-14
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220514/msgaction 2022-5-14.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220514/msgaction2 2022-5-14.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220514/msgaction2 2022-5-14.log 2022-5-14 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220514/msgtype 2022-5-14.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220514/msgtype 2022-5-14.log 2022-5-14 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220514/userinfo 2022-5-14.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220514/userinfo 2022-5-14.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220514
+ mv msgaction_47.253.49.46.2022-5-14.log 20220514
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220514'
/bin/bash etl-log_load.sh 20220514
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220514
2022-5-14
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220514/msgaction_47.253.49.46.2022-5-14.log': No such file or directory
++ date +%Y%m%d -d '20220514 +1day'
+ date_str=20220515
+ [[ 20220515 != \2\0\2\2\0\5\1\5 ]]
20220515
20220516
+ start_date=20220515
+ end_date=20220516
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220515
+ echo 20220515
20220515
+ [[ 20220515 != \2\0\2\2\0\5\1\6 ]]
+ echo 20220515
20220515
+ echo '/bin/bash etl-log_extract.sh 20220515'
/bin/bash etl-log_extract.sh 20220515
+ /bin/bash ../etl/log_extract.sh 20220515
2022-5-15
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-15.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 42, in <module>
    client.download_file(
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 32, in download_file
    self.client.get(remote_file, local_file)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 811, in get
    size = self.getfo(remotepath, fl, callback, prefetch)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 782, in getfo
    file_size = self.stat(remotepath).st_size
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 493, in stat
    t, msg = self._request(CMD_STAT, path)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 822, in _request
    return self._read_response(num)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 874, in _read_response
    self._convert_status(msg)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 903, in _convert_status
    raise IOError(errno.ENOENT, text)
FileNotFoundError: [Errno 2] No Such File
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-15.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220515
+ mv 'msgaction 2022-5-15.log' 20220515
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220515'
/bin/bash etl-log_transform.sh 20220515
+ /bin/bash ../etl/log_transform.sh 20220515
2022-5-15
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220515/msgaction 2022-5-15.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220515/msgaction2 2022-5-15.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220515/msgaction2 2022-5-15.log 2022-5-15 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220515/msgtype 2022-5-15.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220515/msgtype 2022-5-15.log 2022-5-15 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220515/userinfo 2022-5-15.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220515/userinfo 2022-5-15.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220515
+ mv msgaction_47.253.49.46.2022-5-15.log 20220515
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220515'
/bin/bash etl-log_load.sh 20220515
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220515
2022-5-15
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220515/msgaction_47.253.49.46.2022-5-15.log': No such file or directory
++ date +%Y%m%d -d '20220515 +1day'
+ date_str=20220516
+ [[ 20220516 != \2\0\2\2\0\5\1\6 ]]
20220516
20220517
+ start_date=20220516
+ end_date=20220517
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220516
+ echo 20220516
20220516
+ [[ 20220516 != \2\0\2\2\0\5\1\7 ]]
+ echo 20220516
20220516
+ echo '/bin/bash etl-log_extract.sh 20220516'
/bin/bash etl-log_extract.sh 20220516
+ /bin/bash ../etl/log_extract.sh 20220516
2022-5-16
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-16.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 42, in <module>
    client.download_file(
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 32, in download_file
    self.client.get(remote_file, local_file)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 811, in get
    size = self.getfo(remotepath, fl, callback, prefetch)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 782, in getfo
    file_size = self.stat(remotepath).st_size
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 493, in stat
    t, msg = self._request(CMD_STAT, path)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 822, in _request
    return self._read_response(num)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 874, in _read_response
    self._convert_status(msg)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 903, in _convert_status
    raise IOError(errno.ENOENT, text)
FileNotFoundError: [Errno 2] No Such File
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-16.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220516
+ mv 'msgaction 2022-5-16.log' 20220516
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220516'
/bin/bash etl-log_transform.sh 20220516
+ /bin/bash ../etl/log_transform.sh 20220516
2022-5-16
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220516/msgaction 2022-5-16.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220516/msgaction2 2022-5-16.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220516/msgaction2 2022-5-16.log 2022-5-16 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220516/msgtype 2022-5-16.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220516/msgtype 2022-5-16.log 2022-5-16 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220516/userinfo 2022-5-16.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220516/userinfo 2022-5-16.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220516
+ mv msgaction_47.253.49.46.2022-5-16.log 20220516
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220516'
/bin/bash etl-log_load.sh 20220516
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220516
2022-5-16
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220516/msgaction_47.253.49.46.2022-5-16.log': No such file or directory
++ date +%Y%m%d -d '20220516 +1day'
+ date_str=20220517
+ [[ 20220517 != \2\0\2\2\0\5\1\7 ]]
20220517
20220518
+ start_date=20220517
+ end_date=20220518
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220517
+ echo 20220517
20220517
+ [[ 20220517 != \2\0\2\2\0\5\1\8 ]]
+ echo 20220517
20220517
+ echo '/bin/bash etl-log_extract.sh 20220517'
/bin/bash etl-log_extract.sh 20220517
+ /bin/bash ../etl/log_extract.sh 20220517
2022-5-17
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-17.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 42, in <module>
    client.download_file(
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 32, in download_file
    self.client.get(remote_file, local_file)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 811, in get
    size = self.getfo(remotepath, fl, callback, prefetch)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 782, in getfo
    file_size = self.stat(remotepath).st_size
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 493, in stat
    t, msg = self._request(CMD_STAT, path)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 822, in _request
    return self._read_response(num)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 874, in _read_response
    self._convert_status(msg)
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/sftp_client.py", line 903, in _convert_status
    raise IOError(errno.ENOENT, text)
FileNotFoundError: [Errno 2] No Such File
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-17.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220517
+ mv 'msgaction 2022-5-17.log' 20220517
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220517'
/bin/bash etl-log_transform.sh 20220517
+ /bin/bash ../etl/log_transform.sh 20220517
2022-5-17
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220517/msgaction 2022-5-17.log
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220517/msgaction2 2022-5-17.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220517/msgaction2 2022-5-17.log 2022-5-17 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220517/msgtype 2022-5-17.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220517/msgtype 2022-5-17.log 2022-5-17 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220517/userinfo 2022-5-17.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220517/userinfo 2022-5-17.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220517
+ mv msgaction_47.253.49.46.2022-5-17.log 20220517
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220517'
/bin/bash etl-log_load.sh 20220517
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220517
2022-5-17
rm: `/user/nd_rdg/raw-data/offline/english_moyu/raw_msgaction/47.253.49.46/20220517/msgaction_47.253.49.46.2022-5-17.log': No such file or directory
++ date +%Y%m%d -d '20220517 +1day'
+ date_str=20220518
+ [[ 20220518 != \2\0\2\2\0\5\1\8 ]]
20220518
20220519
+ start_date=20220518
+ end_date=20220519
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220518
+ echo 20220518
20220518
+ [[ 20220518 != \2\0\2\2\0\5\1\9 ]]
+ echo 20220518
20220518
+ echo '/bin/bash etl-log_extract.sh 20220518'
/bin/bash etl-log_extract.sh 20220518
+ /bin/bash ../etl/log_extract.sh 20220518
2022-5-18
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-18.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-18.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220518
+ mv '*.log' 20220518
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220518'
/bin/bash etl-log_transform.sh 20220518
+ /bin/bash ../etl/log_transform.sh 20220518
2022-5-18
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220518/msgaction 2022-5-18.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220518/msgaction 2022-5-18.log 2022-5-18 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220518/msgaction2 2022-5-18.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220518/msgaction2 2022-5-18.log 2022-5-18 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220518/msgtype 2022-5-18.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220518/msgtype 2022-5-18.log 2022-5-18 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220518/userinfo 2022-5-18.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220518/userinfo 2022-5-18.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220518
+ mv '*.log' 20220518
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220518'
/bin/bash etl-log_load.sh 20220518
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220518
2022-5-18
++ date +%Y%m%d -d '20220518 +1day'
+ date_str=20220519
+ [[ 20220519 != \2\0\2\2\0\5\1\9 ]]
20220519
20220520
+ start_date=20220519
+ end_date=20220520
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220519
+ echo 20220519
20220519
+ [[ 20220519 != \2\0\2\2\0\5\2\0 ]]
+ echo 20220519
20220519
+ echo '/bin/bash etl-log_extract.sh 20220519'
/bin/bash etl-log_extract.sh 20220519
+ /bin/bash ../etl/log_extract.sh 20220519
2022-5-19
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-19.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-19.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220519
+ mv '*.log' 20220519
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220519'
/bin/bash etl-log_transform.sh 20220519
+ /bin/bash ../etl/log_transform.sh 20220519
2022-5-19
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220519/msgaction 2022-5-19.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220519/msgaction 2022-5-19.log 2022-5-19 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220519/msgaction2 2022-5-19.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220519/msgaction2 2022-5-19.log 2022-5-19 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220519/msgtype 2022-5-19.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220519/msgtype 2022-5-19.log 2022-5-19 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220519/userinfo 2022-5-19.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220519/userinfo 2022-5-19.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220519
+ mv '*.log' 20220519
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220519'
/bin/bash etl-log_load.sh 20220519
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220519
2022-5-19
++ date +%Y%m%d -d '20220519 +1day'
+ date_str=20220520
+ [[ 20220520 != \2\0\2\2\0\5\2\0 ]]
20220520
20220521
+ start_date=20220520
+ end_date=20220521
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220520
+ echo 20220520
20220520
+ [[ 20220520 != \2\0\2\2\0\5\2\1 ]]
+ echo 20220520
20220520
+ echo '/bin/bash etl-log_extract.sh 20220520'
/bin/bash etl-log_extract.sh 20220520
+ /bin/bash ../etl/log_extract.sh 20220520
2022-5-20
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-20.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-20.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220520
+ mv '*.log' 20220520
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220520'
/bin/bash etl-log_transform.sh 20220520
+ /bin/bash ../etl/log_transform.sh 20220520
2022-5-20
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220520/msgaction 2022-5-20.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220520/msgaction 2022-5-20.log 2022-5-20 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220520/msgaction2 2022-5-20.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220520/msgaction2 2022-5-20.log 2022-5-20 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220520/msgtype 2022-5-20.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220520/msgtype 2022-5-20.log 2022-5-20 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220520/userinfo 2022-5-20.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220520/userinfo 2022-5-20.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220520
+ mv '*.log' 20220520
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220520'
/bin/bash etl-log_load.sh 20220520
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220520
2022-5-20
++ date +%Y%m%d -d '20220520 +1day'
+ date_str=20220521
+ [[ 20220521 != \2\0\2\2\0\5\2\1 ]]
20220521
20220522
+ start_date=20220521
+ end_date=20220522
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220521
+ echo 20220521
20220521
+ [[ 20220521 != \2\0\2\2\0\5\2\2 ]]
+ echo 20220521
20220521
+ echo '/bin/bash etl-log_extract.sh 20220521'
/bin/bash etl-log_extract.sh 20220521
+ /bin/bash ../etl/log_extract.sh 20220521
2022-5-21
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-21.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-21.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220521
+ mv '*.log' 20220521
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220521'
/bin/bash etl-log_transform.sh 20220521
+ /bin/bash ../etl/log_transform.sh 20220521
2022-5-21
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220521/msgaction 2022-5-21.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220521/msgaction 2022-5-21.log 2022-5-21 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220521/msgaction2 2022-5-21.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220521/msgaction2 2022-5-21.log 2022-5-21 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220521/msgtype 2022-5-21.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220521/msgtype 2022-5-21.log 2022-5-21 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220521/userinfo 2022-5-21.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220521/userinfo 2022-5-21.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220521
+ mv '*.log' 20220521
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220521'
/bin/bash etl-log_load.sh 20220521
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220521
2022-5-21
++ date +%Y%m%d -d '20220521 +1day'
+ date_str=20220522
+ [[ 20220522 != \2\0\2\2\0\5\2\2 ]]
20220522
20220523
+ start_date=20220522
+ end_date=20220523
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220522
+ echo 20220522
20220522
+ [[ 20220522 != \2\0\2\2\0\5\2\3 ]]
+ echo 20220522
20220522
+ echo '/bin/bash etl-log_extract.sh 20220522'
/bin/bash etl-log_extract.sh 20220522
+ /bin/bash ../etl/log_extract.sh 20220522
2022-5-22
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-22.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-22.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220522
+ mv '*.log' 20220522
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220522'
/bin/bash etl-log_transform.sh 20220522
+ /bin/bash ../etl/log_transform.sh 20220522
2022-5-22
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220522/msgaction 2022-5-22.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220522/msgaction 2022-5-22.log 2022-5-22 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220522/msgaction2 2022-5-22.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220522/msgaction2 2022-5-22.log 2022-5-22 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220522/msgtype 2022-5-22.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220522/msgtype 2022-5-22.log 2022-5-22 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220522/userinfo 2022-5-22.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220522/userinfo 2022-5-22.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220522
+ mv '*.log' 20220522
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220522'
/bin/bash etl-log_load.sh 20220522
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220522
2022-5-22
++ date +%Y%m%d -d '20220522 +1day'
+ date_str=20220523
+ [[ 20220523 != \2\0\2\2\0\5\2\3 ]]
20220523
20220524
+ start_date=20220523
+ end_date=20220524
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220523
+ echo 20220523
20220523
+ [[ 20220523 != \2\0\2\2\0\5\2\4 ]]
+ echo 20220523
20220523
+ echo '/bin/bash etl-log_extract.sh 20220523'
/bin/bash etl-log_extract.sh 20220523
+ /bin/bash ../etl/log_extract.sh 20220523
2022-5-23
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-23.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-23.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220523
+ mv '*.log' 20220523
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220523'
/bin/bash etl-log_transform.sh 20220523
+ /bin/bash ../etl/log_transform.sh 20220523
2022-5-23
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220523/msgaction 2022-5-23.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220523/msgaction 2022-5-23.log 2022-5-23 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220523/msgaction2 2022-5-23.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220523/msgaction2 2022-5-23.log 2022-5-23 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220523/msgtype 2022-5-23.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220523/msgtype 2022-5-23.log 2022-5-23 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220523/userinfo 2022-5-23.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220523/userinfo 2022-5-23.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220523
+ mv '*.log' 20220523
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220523'
/bin/bash etl-log_load.sh 20220523
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220523
2022-5-23
++ date +%Y%m%d -d '20220523 +1day'
+ date_str=20220524
+ [[ 20220524 != \2\0\2\2\0\5\2\4 ]]
20220524
20220525
+ start_date=20220524
+ end_date=20220525
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220524
+ echo 20220524
20220524
+ [[ 20220524 != \2\0\2\2\0\5\2\5 ]]
+ echo 20220524
20220524
+ echo '/bin/bash etl-log_extract.sh 20220524'
/bin/bash etl-log_extract.sh 20220524
+ /bin/bash ../etl/log_extract.sh 20220524
2022-5-24
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-24.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-24.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220524
+ mv '*.log' 20220524
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220524'
/bin/bash etl-log_transform.sh 20220524
+ /bin/bash ../etl/log_transform.sh 20220524
2022-5-24
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220524/msgaction 2022-5-24.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220524/msgaction 2022-5-24.log 2022-5-24 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220524/msgaction2 2022-5-24.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220524/msgaction2 2022-5-24.log 2022-5-24 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220524/msgtype 2022-5-24.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220524/msgtype 2022-5-24.log 2022-5-24 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220524/userinfo 2022-5-24.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220524/userinfo 2022-5-24.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220524
+ mv '*.log' 20220524
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220524'
/bin/bash etl-log_load.sh 20220524
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220524
2022-5-24
++ date +%Y%m%d -d '20220524 +1day'
+ date_str=20220525
+ [[ 20220525 != \2\0\2\2\0\5\2\5 ]]
20220525
20220526
+ start_date=20220525
+ end_date=20220526
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220525
+ echo 20220525
20220525
+ [[ 20220525 != \2\0\2\2\0\5\2\6 ]]
+ echo 20220525
20220525
+ echo '/bin/bash etl-log_extract.sh 20220525'
/bin/bash etl-log_extract.sh 20220525
+ /bin/bash ../etl/log_extract.sh 20220525
2022-5-25
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-25.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-25.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220525
+ mv '*.log' 20220525
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220525'
/bin/bash etl-log_transform.sh 20220525
+ /bin/bash ../etl/log_transform.sh 20220525
2022-5-25
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220525/msgaction 2022-5-25.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220525/msgaction 2022-5-25.log 2022-5-25 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220525/msgaction2 2022-5-25.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220525/msgaction2 2022-5-25.log 2022-5-25 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220525/msgtype 2022-5-25.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220525/msgtype 2022-5-25.log 2022-5-25 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220525/userinfo 2022-5-25.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220525/userinfo 2022-5-25.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220525
+ mv '*.log' 20220525
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220525'
/bin/bash etl-log_load.sh 20220525
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220525
2022-5-25
++ date +%Y%m%d -d '20220525 +1day'
+ date_str=20220526
+ [[ 20220526 != \2\0\2\2\0\5\2\6 ]]
20220526
20220527
+ start_date=20220526
+ end_date=20220527
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220526
+ echo 20220526
20220526
+ [[ 20220526 != \2\0\2\2\0\5\2\7 ]]
+ echo 20220526
20220526
+ echo '/bin/bash etl-log_extract.sh 20220526'
/bin/bash etl-log_extract.sh 20220526
+ /bin/bash ../etl/log_extract.sh 20220526
2022-5-26
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-26.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-26.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220526
+ mv '*.log' 20220526
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220526'
/bin/bash etl-log_transform.sh 20220526
+ /bin/bash ../etl/log_transform.sh 20220526
2022-5-26
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220526/msgaction 2022-5-26.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220526/msgaction 2022-5-26.log 2022-5-26 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220526/msgaction2 2022-5-26.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220526/msgaction2 2022-5-26.log 2022-5-26 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220526/msgtype 2022-5-26.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220526/msgtype 2022-5-26.log 2022-5-26 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220526/userinfo 2022-5-26.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220526/userinfo 2022-5-26.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220526
+ mv '*.log' 20220526
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220526'
/bin/bash etl-log_load.sh 20220526
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220526
2022-5-26
++ date +%Y%m%d -d '20220526 +1day'
+ date_str=20220527
+ [[ 20220527 != \2\0\2\2\0\5\2\7 ]]
20220527
20220528
+ start_date=20220527
+ end_date=20220528
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220527
+ echo 20220527
20220527
+ [[ 20220527 != \2\0\2\2\0\5\2\8 ]]
+ echo 20220527
20220527
+ echo '/bin/bash etl-log_extract.sh 20220527'
/bin/bash etl-log_extract.sh 20220527
+ /bin/bash ../etl/log_extract.sh 20220527
2022-5-27
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-27.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-27.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220527
+ mv '*.log' 20220527
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220527'
/bin/bash etl-log_transform.sh 20220527
+ /bin/bash ../etl/log_transform.sh 20220527
2022-5-27
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220527/msgaction 2022-5-27.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220527/msgaction 2022-5-27.log 2022-5-27 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220527/msgaction2 2022-5-27.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220527/msgaction2 2022-5-27.log 2022-5-27 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220527/msgtype 2022-5-27.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220527/msgtype 2022-5-27.log 2022-5-27 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220527/userinfo 2022-5-27.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220527/userinfo 2022-5-27.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220527
+ mv '*.log' 20220527
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220527'
/bin/bash etl-log_load.sh 20220527
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220527
2022-5-27
++ date +%Y%m%d -d '20220527 +1day'
+ date_str=20220528
+ [[ 20220528 != \2\0\2\2\0\5\2\8 ]]
20220528
20220529
+ start_date=20220528
+ end_date=20220529
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220528
+ echo 20220528
20220528
+ [[ 20220528 != \2\0\2\2\0\5\2\9 ]]
+ echo 20220528
20220528
+ echo '/bin/bash etl-log_extract.sh 20220528'
/bin/bash etl-log_extract.sh 20220528
+ /bin/bash ../etl/log_extract.sh 20220528
2022-5-28
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-28.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-28.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220528
+ mv '*.log' 20220528
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220528'
/bin/bash etl-log_transform.sh 20220528
+ /bin/bash ../etl/log_transform.sh 20220528
2022-5-28
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220528/msgaction 2022-5-28.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220528/msgaction 2022-5-28.log 2022-5-28 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220528/msgaction2 2022-5-28.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220528/msgaction2 2022-5-28.log 2022-5-28 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220528/msgtype 2022-5-28.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220528/msgtype 2022-5-28.log 2022-5-28 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220528/userinfo 2022-5-28.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220528/userinfo 2022-5-28.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220528
+ mv '*.log' 20220528
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220528'
/bin/bash etl-log_load.sh 20220528
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220528
2022-5-28
++ date +%Y%m%d -d '20220528 +1day'
+ date_str=20220529
+ [[ 20220529 != \2\0\2\2\0\5\2\9 ]]
20220529
20220530
+ start_date=20220529
+ end_date=20220530
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220529
+ echo 20220529
20220529
+ [[ 20220529 != \2\0\2\2\0\5\3\0 ]]
+ echo 20220529
20220529
+ echo '/bin/bash etl-log_extract.sh 20220529'
/bin/bash etl-log_extract.sh 20220529
+ /bin/bash ../etl/log_extract.sh 20220529
2022-5-29
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-29.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-29.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220529
+ mv '*.log' 20220529
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220529'
/bin/bash etl-log_transform.sh 20220529
+ /bin/bash ../etl/log_transform.sh 20220529
2022-5-29
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220529/msgaction 2022-5-29.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220529/msgaction 2022-5-29.log 2022-5-29 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220529/msgaction2 2022-5-29.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220529/msgaction2 2022-5-29.log 2022-5-29 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220529/msgtype 2022-5-29.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220529/msgtype 2022-5-29.log 2022-5-29 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220529/userinfo 2022-5-29.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220529/userinfo 2022-5-29.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220529
+ mv '*.log' 20220529
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220529'
/bin/bash etl-log_load.sh 20220529
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220529
2022-5-29
++ date +%Y%m%d -d '20220529 +1day'
+ date_str=20220530
+ [[ 20220530 != \2\0\2\2\0\5\3\0 ]]
20220530
20220531
+ start_date=20220530
+ end_date=20220531
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220530
+ echo 20220530
20220530
+ [[ 20220530 != \2\0\2\2\0\5\3\1 ]]
+ echo 20220530
20220530
+ echo '/bin/bash etl-log_extract.sh 20220530'
/bin/bash etl-log_extract.sh 20220530
+ /bin/bash ../etl/log_extract.sh 20220530
2022-5-30
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-30.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-30.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220530
+ mv '*.log' 20220530
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220530'
/bin/bash etl-log_transform.sh 20220530
+ /bin/bash ../etl/log_transform.sh 20220530
2022-5-30
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220530/msgaction 2022-5-30.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220530/msgaction 2022-5-30.log 2022-5-30 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220530/msgaction2 2022-5-30.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220530/msgaction2 2022-5-30.log 2022-5-30 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220530/msgtype 2022-5-30.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220530/msgtype 2022-5-30.log 2022-5-30 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220530/userinfo 2022-5-30.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220530/userinfo 2022-5-30.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220530
+ mv '*.log' 20220530
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220530'
/bin/bash etl-log_load.sh 20220530
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220530
2022-5-30
++ date +%Y%m%d -d '20220530 +1day'
+ date_str=20220531
+ [[ 20220531 != \2\0\2\2\0\5\3\1 ]]
20220531
20220601
+ start_date=20220531
+ end_date=20220601
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220531
+ echo 20220531
20220531
+ [[ 20220531 != \2\0\2\2\0\6\0\1 ]]
+ echo 20220531
20220531
+ echo '/bin/bash etl-log_extract.sh 20220531'
/bin/bash etl-log_extract.sh 20220531
+ /bin/bash ../etl/log_extract.sh 20220531
2022-5-31
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-5-31.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-5-31.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220531
+ mv '*.log' 20220531
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220531'
/bin/bash etl-log_transform.sh 20220531
+ /bin/bash ../etl/log_transform.sh 20220531
2022-5-31
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220531/msgaction 2022-5-31.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220531/msgaction 2022-5-31.log 2022-5-31 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220531/msgaction2 2022-5-31.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220531/msgaction2 2022-5-31.log 2022-5-31 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220531/msgtype 2022-5-31.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220531/msgtype 2022-5-31.log 2022-5-31 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220531/userinfo 2022-5-31.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220531/userinfo 2022-5-31.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220531
+ mv '*.log' 20220531
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220531'
/bin/bash etl-log_load.sh 20220531
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220531
2022-5-31
++ date +%Y%m%d -d '20220531 +1day'
+ date_str=20220601
+ [[ 20220601 != \2\0\2\2\0\6\0\1 ]]
20220601
20220602
+ start_date=20220601
+ end_date=20220602
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220601
+ echo 20220601
20220601
+ [[ 20220601 != \2\0\2\2\0\6\0\2 ]]
+ echo 20220601
20220601
+ echo '/bin/bash etl-log_extract.sh 20220601'
/bin/bash etl-log_extract.sh 20220601
+ /bin/bash ../etl/log_extract.sh 20220601
2022-6-1
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-1.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-1.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220601
+ mv '*.log' 20220601
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220601'
/bin/bash etl-log_transform.sh 20220601
+ /bin/bash ../etl/log_transform.sh 20220601
2022-6-1
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220601/msgaction 2022-6-1.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220601/msgaction 2022-6-1.log 2022-6-1 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220601/msgaction2 2022-6-1.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220601/msgaction2 2022-6-1.log 2022-6-1 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220601/msgtype 2022-6-1.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220601/msgtype 2022-6-1.log 2022-6-1 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220601/userinfo 2022-6-1.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220601/userinfo 2022-6-1.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220601
+ mv '*.log' 20220601
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220601'
/bin/bash etl-log_load.sh 20220601
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220601
2022-6-1
++ date +%Y%m%d -d '20220601 +1day'
+ date_str=20220602
+ [[ 20220602 != \2\0\2\2\0\6\0\2 ]]
20220602
20220603
+ start_date=20220602
+ end_date=20220603
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220602
+ echo 20220602
20220602
+ [[ 20220602 != \2\0\2\2\0\6\0\3 ]]
+ echo 20220602
20220602
+ echo '/bin/bash etl-log_extract.sh 20220602'
/bin/bash etl-log_extract.sh 20220602
+ /bin/bash ../etl/log_extract.sh 20220602
2022-6-2
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-2.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-2.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220602
+ mv '*.log' 20220602
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220602'
/bin/bash etl-log_transform.sh 20220602
+ /bin/bash ../etl/log_transform.sh 20220602
2022-6-2
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220602/msgaction 2022-6-2.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220602/msgaction 2022-6-2.log 2022-6-2 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220602/msgaction2 2022-6-2.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220602/msgaction2 2022-6-2.log 2022-6-2 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220602/msgtype 2022-6-2.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220602/msgtype 2022-6-2.log 2022-6-2 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220602/userinfo 2022-6-2.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220602/userinfo 2022-6-2.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220602
+ mv '*.log' 20220602
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220602'
/bin/bash etl-log_load.sh 20220602
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220602
2022-6-2
++ date +%Y%m%d -d '20220602 +1day'
+ date_str=20220603
+ [[ 20220603 != \2\0\2\2\0\6\0\3 ]]
20220603
20220604
+ start_date=20220603
+ end_date=20220604
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220603
+ echo 20220603
20220603
+ [[ 20220603 != \2\0\2\2\0\6\0\4 ]]
+ echo 20220603
20220603
+ echo '/bin/bash etl-log_extract.sh 20220603'
/bin/bash etl-log_extract.sh 20220603
+ /bin/bash ../etl/log_extract.sh 20220603
2022-6-3
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-3.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-3.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220603
+ mv '*.log' 20220603
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220603'
/bin/bash etl-log_transform.sh 20220603
+ /bin/bash ../etl/log_transform.sh 20220603
2022-6-3
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220603/msgaction 2022-6-3.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220603/msgaction 2022-6-3.log 2022-6-3 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220603/msgaction2 2022-6-3.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220603/msgaction2 2022-6-3.log 2022-6-3 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220603/msgtype 2022-6-3.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220603/msgtype 2022-6-3.log 2022-6-3 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220603/userinfo 2022-6-3.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220603/userinfo 2022-6-3.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220603
+ mv '*.log' 20220603
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220603'
/bin/bash etl-log_load.sh 20220603
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220603
2022-6-3
++ date +%Y%m%d -d '20220603 +1day'
+ date_str=20220604
+ [[ 20220604 != \2\0\2\2\0\6\0\4 ]]
20220604
20220605
+ start_date=20220604
+ end_date=20220605
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220604
+ echo 20220604
20220604
+ [[ 20220604 != \2\0\2\2\0\6\0\5 ]]
+ echo 20220604
20220604
+ echo '/bin/bash etl-log_extract.sh 20220604'
/bin/bash etl-log_extract.sh 20220604
+ /bin/bash ../etl/log_extract.sh 20220604
2022-6-4
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-4.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-4.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220604
+ mv '*.log' 20220604
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220604'
/bin/bash etl-log_transform.sh 20220604
+ /bin/bash ../etl/log_transform.sh 20220604
2022-6-4
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220604/msgaction 2022-6-4.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220604/msgaction 2022-6-4.log 2022-6-4 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220604/msgaction2 2022-6-4.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220604/msgaction2 2022-6-4.log 2022-6-4 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220604/msgtype 2022-6-4.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220604/msgtype 2022-6-4.log 2022-6-4 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220604/userinfo 2022-6-4.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220604/userinfo 2022-6-4.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220604
+ mv '*.log' 20220604
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220604'
/bin/bash etl-log_load.sh 20220604
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220604
2022-6-4
++ date +%Y%m%d -d '20220604 +1day'
+ date_str=20220605
+ [[ 20220605 != \2\0\2\2\0\6\0\5 ]]
20220605
20220606
+ start_date=20220605
+ end_date=20220606
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220605
+ echo 20220605
20220605
+ [[ 20220605 != \2\0\2\2\0\6\0\6 ]]
+ echo 20220605
20220605
+ echo '/bin/bash etl-log_extract.sh 20220605'
/bin/bash etl-log_extract.sh 20220605
+ /bin/bash ../etl/log_extract.sh 20220605
2022-6-5
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-5.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-5.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220605
+ mv '*.log' 20220605
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220605'
/bin/bash etl-log_transform.sh 20220605
+ /bin/bash ../etl/log_transform.sh 20220605
2022-6-5
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220605/msgaction 2022-6-5.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220605/msgaction 2022-6-5.log 2022-6-5 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220605/msgaction2 2022-6-5.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220605/msgaction2 2022-6-5.log 2022-6-5 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220605/msgtype 2022-6-5.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220605/msgtype 2022-6-5.log 2022-6-5 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220605/userinfo 2022-6-5.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220605/userinfo 2022-6-5.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220605
+ mv '*.log' 20220605
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220605'
/bin/bash etl-log_load.sh 20220605
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220605
2022-6-5
++ date +%Y%m%d -d '20220605 +1day'
+ date_str=20220606
+ [[ 20220606 != \2\0\2\2\0\6\0\6 ]]
20220606
20220607
+ start_date=20220606
+ end_date=20220607
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220606
+ echo 20220606
20220606
+ [[ 20220606 != \2\0\2\2\0\6\0\7 ]]
+ echo 20220606
20220606
+ echo '/bin/bash etl-log_extract.sh 20220606'
/bin/bash etl-log_extract.sh 20220606
+ /bin/bash ../etl/log_extract.sh 20220606
2022-6-6
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-6.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-6.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220606
+ mv '*.log' 20220606
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220606'
/bin/bash etl-log_transform.sh 20220606
+ /bin/bash ../etl/log_transform.sh 20220606
2022-6-6
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220606/msgaction 2022-6-6.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220606/msgaction 2022-6-6.log 2022-6-6 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220606/msgaction2 2022-6-6.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220606/msgaction2 2022-6-6.log 2022-6-6 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220606/msgtype 2022-6-6.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220606/msgtype 2022-6-6.log 2022-6-6 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220606/userinfo 2022-6-6.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220606/userinfo 2022-6-6.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220606
+ mv '*.log' 20220606
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220606'
/bin/bash etl-log_load.sh 20220606
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220606
2022-6-6
++ date +%Y%m%d -d '20220606 +1day'
+ date_str=20220607
+ [[ 20220607 != \2\0\2\2\0\6\0\7 ]]
20220607
20220608
+ start_date=20220607
+ end_date=20220608
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220607
+ echo 20220607
20220607
+ [[ 20220607 != \2\0\2\2\0\6\0\8 ]]
+ echo 20220607
20220607
+ echo '/bin/bash etl-log_extract.sh 20220607'
/bin/bash etl-log_extract.sh 20220607
+ /bin/bash ../etl/log_extract.sh 20220607
2022-6-7
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-7.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-7.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220607
+ mv '*.log' 20220607
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220607'
/bin/bash etl-log_transform.sh 20220607
+ /bin/bash ../etl/log_transform.sh 20220607
2022-6-7
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220607/msgaction 2022-6-7.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220607/msgaction 2022-6-7.log 2022-6-7 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220607/msgaction2 2022-6-7.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220607/msgaction2 2022-6-7.log 2022-6-7 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220607/msgtype 2022-6-7.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220607/msgtype 2022-6-7.log 2022-6-7 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220607/userinfo 2022-6-7.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220607/userinfo 2022-6-7.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220607
+ mv '*.log' 20220607
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220607'
/bin/bash etl-log_load.sh 20220607
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220607
2022-6-7
++ date +%Y%m%d -d '20220607 +1day'
+ date_str=20220608
+ [[ 20220608 != \2\0\2\2\0\6\0\8 ]]
20220608
20220609
+ start_date=20220608
+ end_date=20220609
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220608
+ echo 20220608
20220608
+ [[ 20220608 != \2\0\2\2\0\6\0\9 ]]
+ echo 20220608
20220608
+ echo '/bin/bash etl-log_extract.sh 20220608'
/bin/bash etl-log_extract.sh 20220608
+ /bin/bash ../etl/log_extract.sh 20220608
2022-6-8
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-8.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-8.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220608
+ mv '*.log' 20220608
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220608'
/bin/bash etl-log_transform.sh 20220608
+ /bin/bash ../etl/log_transform.sh 20220608
2022-6-8
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220608/msgaction 2022-6-8.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220608/msgaction 2022-6-8.log 2022-6-8 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220608/msgaction2 2022-6-8.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220608/msgaction2 2022-6-8.log 2022-6-8 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220608/msgtype 2022-6-8.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220608/msgtype 2022-6-8.log 2022-6-8 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220608/userinfo 2022-6-8.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220608/userinfo 2022-6-8.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220608
+ mv '*.log' 20220608
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220608'
/bin/bash etl-log_load.sh 20220608
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220608
2022-6-8
++ date +%Y%m%d -d '20220608 +1day'
+ date_str=20220609
+ [[ 20220609 != \2\0\2\2\0\6\0\9 ]]
20220609
20220610
+ start_date=20220609
+ end_date=20220610
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220609
+ echo 20220609
20220609
+ [[ 20220609 != \2\0\2\2\0\6\1\0 ]]
+ echo 20220609
20220609
+ echo '/bin/bash etl-log_extract.sh 20220609'
/bin/bash etl-log_extract.sh 20220609
+ /bin/bash ../etl/log_extract.sh 20220609
2022-6-9
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-9.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-9.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220609
+ mv '*.log' 20220609
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220609'
/bin/bash etl-log_transform.sh 20220609
+ /bin/bash ../etl/log_transform.sh 20220609
2022-6-9
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220609/msgaction 2022-6-9.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220609/msgaction 2022-6-9.log 2022-6-9 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220609/msgaction2 2022-6-9.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220609/msgaction2 2022-6-9.log 2022-6-9 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220609/msgtype 2022-6-9.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220609/msgtype 2022-6-9.log 2022-6-9 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220609/userinfo 2022-6-9.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220609/userinfo 2022-6-9.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220609
+ mv '*.log' 20220609
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220609'
/bin/bash etl-log_load.sh 20220609
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220609
2022-6-9
++ date +%Y%m%d -d '20220609 +1day'
+ date_str=20220610
+ [[ 20220610 != \2\0\2\2\0\6\1\0 ]]
20220610
20220611
+ start_date=20220610
+ end_date=20220611
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220610
+ echo 20220610
20220610
+ [[ 20220610 != \2\0\2\2\0\6\1\1 ]]
+ echo 20220610
20220610
+ echo '/bin/bash etl-log_extract.sh 20220610'
/bin/bash etl-log_extract.sh 20220610
+ /bin/bash ../etl/log_extract.sh 20220610
2022-6-10
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-10.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-10.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220610
+ mv '*.log' 20220610
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220610'
/bin/bash etl-log_transform.sh 20220610
+ /bin/bash ../etl/log_transform.sh 20220610
2022-6-10
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220610/msgaction 2022-6-10.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220610/msgaction 2022-6-10.log 2022-6-10 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220610/msgaction2 2022-6-10.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220610/msgaction2 2022-6-10.log 2022-6-10 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220610/msgtype 2022-6-10.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220610/msgtype 2022-6-10.log 2022-6-10 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220610/userinfo 2022-6-10.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220610/userinfo 2022-6-10.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220610
+ mv '*.log' 20220610
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220610'
/bin/bash etl-log_load.sh 20220610
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220610
2022-6-10
++ date +%Y%m%d -d '20220610 +1day'
+ date_str=20220611
+ [[ 20220611 != \2\0\2\2\0\6\1\1 ]]
20220611
20220612
+ start_date=20220611
+ end_date=20220612
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220611
+ echo 20220611
20220611
+ [[ 20220611 != \2\0\2\2\0\6\1\2 ]]
+ echo 20220611
20220611
+ echo '/bin/bash etl-log_extract.sh 20220611'
/bin/bash etl-log_extract.sh 20220611
+ /bin/bash ../etl/log_extract.sh 20220611
2022-6-11
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-11.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-11.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220611
+ mv '*.log' 20220611
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220611'
/bin/bash etl-log_transform.sh 20220611
+ /bin/bash ../etl/log_transform.sh 20220611
2022-6-11
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220611/msgaction 2022-6-11.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220611/msgaction 2022-6-11.log 2022-6-11 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220611/msgaction2 2022-6-11.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220611/msgaction2 2022-6-11.log 2022-6-11 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220611/msgtype 2022-6-11.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220611/msgtype 2022-6-11.log 2022-6-11 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220611/userinfo 2022-6-11.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220611/userinfo 2022-6-11.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220611
+ mv '*.log' 20220611
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220611'
/bin/bash etl-log_load.sh 20220611
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220611
2022-6-11
++ date +%Y%m%d -d '20220611 +1day'
+ date_str=20220612
+ [[ 20220612 != \2\0\2\2\0\6\1\2 ]]
20220612
20220613
+ start_date=20220612
+ end_date=20220613
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220612
+ echo 20220612
20220612
+ [[ 20220612 != \2\0\2\2\0\6\1\3 ]]
+ echo 20220612
20220612
+ echo '/bin/bash etl-log_extract.sh 20220612'
/bin/bash etl-log_extract.sh 20220612
+ /bin/bash ../etl/log_extract.sh 20220612
2022-6-12
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-12.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-12.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220612
+ mv '*.log' 20220612
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220612'
/bin/bash etl-log_transform.sh 20220612
+ /bin/bash ../etl/log_transform.sh 20220612
2022-6-12
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220612/msgaction 2022-6-12.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220612/msgaction 2022-6-12.log 2022-6-12 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220612/msgaction2 2022-6-12.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220612/msgaction2 2022-6-12.log 2022-6-12 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220612/msgtype 2022-6-12.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220612/msgtype 2022-6-12.log 2022-6-12 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220612/userinfo 2022-6-12.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220612/userinfo 2022-6-12.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220612
+ mv '*.log' 20220612
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220612'
/bin/bash etl-log_load.sh 20220612
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220612
2022-6-12
++ date +%Y%m%d -d '20220612 +1day'
+ date_str=20220613
+ [[ 20220613 != \2\0\2\2\0\6\1\3 ]]
20220613
20220614
+ start_date=20220613
+ end_date=20220614
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220613
+ echo 20220613
20220613
+ [[ 20220613 != \2\0\2\2\0\6\1\4 ]]
+ echo 20220613
20220613
+ echo '/bin/bash etl-log_extract.sh 20220613'
/bin/bash etl-log_extract.sh 20220613
+ /bin/bash ../etl/log_extract.sh 20220613
2022-6-13
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-13.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-13.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220613
+ mv '*.log' 20220613
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220613'
/bin/bash etl-log_transform.sh 20220613
+ /bin/bash ../etl/log_transform.sh 20220613
2022-6-13
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220613/msgaction 2022-6-13.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220613/msgaction 2022-6-13.log 2022-6-13 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220613/msgaction2 2022-6-13.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220613/msgaction2 2022-6-13.log 2022-6-13 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220613/msgtype 2022-6-13.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220613/msgtype 2022-6-13.log 2022-6-13 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220613/userinfo 2022-6-13.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220613/userinfo 2022-6-13.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220613
+ mv '*.log' 20220613
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220613'
/bin/bash etl-log_load.sh 20220613
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220613
2022-6-13
++ date +%Y%m%d -d '20220613 +1day'
+ date_str=20220614
+ [[ 20220614 != \2\0\2\2\0\6\1\4 ]]
20220614
20220615
+ start_date=20220614
+ end_date=20220615
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220614
+ echo 20220614
20220614
+ [[ 20220614 != \2\0\2\2\0\6\1\5 ]]
+ echo 20220614
20220614
+ echo '/bin/bash etl-log_extract.sh 20220614'
/bin/bash etl-log_extract.sh 20220614
+ /bin/bash ../etl/log_extract.sh 20220614
2022-6-14
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-14.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-14.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220614
+ mv '*.log' 20220614
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220614'
/bin/bash etl-log_transform.sh 20220614
+ /bin/bash ../etl/log_transform.sh 20220614
2022-6-14
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220614/msgaction 2022-6-14.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220614/msgaction 2022-6-14.log 2022-6-14 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220614/msgaction2 2022-6-14.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220614/msgaction2 2022-6-14.log 2022-6-14 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220614/msgtype 2022-6-14.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220614/msgtype 2022-6-14.log 2022-6-14 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220614/userinfo 2022-6-14.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220614/userinfo 2022-6-14.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220614
+ mv '*.log' 20220614
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220614'
/bin/bash etl-log_load.sh 20220614
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220614
2022-6-14
++ date +%Y%m%d -d '20220614 +1day'
+ date_str=20220615
+ [[ 20220615 != \2\0\2\2\0\6\1\5 ]]
20220615
20220616
+ start_date=20220615
+ end_date=20220616
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220615
+ echo 20220615
20220615
+ [[ 20220615 != \2\0\2\2\0\6\1\6 ]]
+ echo 20220615
20220615
+ echo '/bin/bash etl-log_extract.sh 20220615'
/bin/bash etl-log_extract.sh 20220615
+ /bin/bash ../etl/log_extract.sh 20220615
2022-6-15
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-15.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-15.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220615
+ mv '*.log' 20220615
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220615'
/bin/bash etl-log_transform.sh 20220615
+ /bin/bash ../etl/log_transform.sh 20220615
2022-6-15
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220615/msgaction 2022-6-15.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220615/msgaction 2022-6-15.log 2022-6-15 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220615/msgaction2 2022-6-15.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220615/msgaction2 2022-6-15.log 2022-6-15 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220615/msgtype 2022-6-15.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220615/msgtype 2022-6-15.log 2022-6-15 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220615/userinfo 2022-6-15.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220615/userinfo 2022-6-15.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220615
+ mv '*.log' 20220615
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220615'
/bin/bash etl-log_load.sh 20220615
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220615
2022-6-15
++ date +%Y%m%d -d '20220615 +1day'
+ date_str=20220616
+ [[ 20220616 != \2\0\2\2\0\6\1\6 ]]
20220616
20220617
+ start_date=20220616
+ end_date=20220617
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220616
+ echo 20220616
20220616
+ [[ 20220616 != \2\0\2\2\0\6\1\7 ]]
+ echo 20220616
20220616
+ echo '/bin/bash etl-log_extract.sh 20220616'
/bin/bash etl-log_extract.sh 20220616
+ /bin/bash ../etl/log_extract.sh 20220616
2022-6-16
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-16.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-16.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220616
+ mv '*.log' 20220616
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220616'
/bin/bash etl-log_transform.sh 20220616
+ /bin/bash ../etl/log_transform.sh 20220616
2022-6-16
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220616/msgaction 2022-6-16.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220616/msgaction 2022-6-16.log 2022-6-16 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220616/msgaction2 2022-6-16.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220616/msgaction2 2022-6-16.log 2022-6-16 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220616/msgtype 2022-6-16.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220616/msgtype 2022-6-16.log 2022-6-16 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220616/userinfo 2022-6-16.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220616/userinfo 2022-6-16.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220616
+ mv '*.log' 20220616
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220616'
/bin/bash etl-log_load.sh 20220616
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220616
2022-6-16
++ date +%Y%m%d -d '20220616 +1day'
+ date_str=20220617
+ [[ 20220617 != \2\0\2\2\0\6\1\7 ]]
20220617
20220618
+ start_date=20220617
+ end_date=20220618
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220617
+ echo 20220617
20220617
+ [[ 20220617 != \2\0\2\2\0\6\1\8 ]]
+ echo 20220617
20220617
+ echo '/bin/bash etl-log_extract.sh 20220617'
/bin/bash etl-log_extract.sh 20220617
+ /bin/bash ../etl/log_extract.sh 20220617
2022-6-17
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-17.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-17.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220617
+ mv '*.log' 20220617
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220617'
/bin/bash etl-log_transform.sh 20220617
+ /bin/bash ../etl/log_transform.sh 20220617
2022-6-17
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220617/msgaction 2022-6-17.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220617/msgaction 2022-6-17.log 2022-6-17 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220617/msgaction2 2022-6-17.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220617/msgaction2 2022-6-17.log 2022-6-17 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220617/msgtype 2022-6-17.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220617/msgtype 2022-6-17.log 2022-6-17 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220617/userinfo 2022-6-17.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220617/userinfo 2022-6-17.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220617
+ mv '*.log' 20220617
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220617'
/bin/bash etl-log_load.sh 20220617
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220617
2022-6-17
++ date +%Y%m%d -d '20220617 +1day'
+ date_str=20220618
+ [[ 20220618 != \2\0\2\2\0\6\1\8 ]]
20220618
20220619
+ start_date=20220618
+ end_date=20220619
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220618
+ echo 20220618
20220618
+ [[ 20220618 != \2\0\2\2\0\6\1\9 ]]
+ echo 20220618
20220618
+ echo '/bin/bash etl-log_extract.sh 20220618'
/bin/bash etl-log_extract.sh 20220618
+ /bin/bash ../etl/log_extract.sh 20220618
2022-6-18
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-18.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-18.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220618
+ mv '*.log' 20220618
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220618'
/bin/bash etl-log_transform.sh 20220618
+ /bin/bash ../etl/log_transform.sh 20220618
2022-6-18
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220618/msgaction 2022-6-18.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220618/msgaction 2022-6-18.log 2022-6-18 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220618/msgaction2 2022-6-18.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220618/msgaction2 2022-6-18.log 2022-6-18 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220618/msgtype 2022-6-18.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220618/msgtype 2022-6-18.log 2022-6-18 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220618/userinfo 2022-6-18.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220618/userinfo 2022-6-18.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220618
+ mv '*.log' 20220618
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220618'
/bin/bash etl-log_load.sh 20220618
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220618
2022-6-18
++ date +%Y%m%d -d '20220618 +1day'
+ date_str=20220619
+ [[ 20220619 != \2\0\2\2\0\6\1\9 ]]
20220619
20220620
+ start_date=20220619
+ end_date=20220620
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220619
+ echo 20220619
20220619
+ [[ 20220619 != \2\0\2\2\0\6\2\0 ]]
+ echo 20220619
20220619
+ echo '/bin/bash etl-log_extract.sh 20220619'
/bin/bash etl-log_extract.sh 20220619
+ /bin/bash ../etl/log_extract.sh 20220619
2022-6-19
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-19.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-19.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220619
+ mv '*.log' 20220619
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220619'
/bin/bash etl-log_transform.sh 20220619
+ /bin/bash ../etl/log_transform.sh 20220619
2022-6-19
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220619/msgaction 2022-6-19.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220619/msgaction 2022-6-19.log 2022-6-19 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220619/msgaction2 2022-6-19.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220619/msgaction2 2022-6-19.log 2022-6-19 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220619/msgtype 2022-6-19.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220619/msgtype 2022-6-19.log 2022-6-19 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220619/userinfo 2022-6-19.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220619/userinfo 2022-6-19.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220619
+ mv '*.log' 20220619
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220619'
/bin/bash etl-log_load.sh 20220619
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220619
2022-6-19
++ date +%Y%m%d -d '20220619 +1day'
+ date_str=20220620
+ [[ 20220620 != \2\0\2\2\0\6\2\0 ]]
20220620
20220621
+ start_date=20220620
+ end_date=20220621
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220620
+ echo 20220620
20220620
+ [[ 20220620 != \2\0\2\2\0\6\2\1 ]]
+ echo 20220620
20220620
+ echo '/bin/bash etl-log_extract.sh 20220620'
/bin/bash etl-log_extract.sh 20220620
+ /bin/bash ../etl/log_extract.sh 20220620
2022-6-20
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-20.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-20.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220620
+ mv '*.log' 20220620
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220620'
/bin/bash etl-log_transform.sh 20220620
+ /bin/bash ../etl/log_transform.sh 20220620
2022-6-20
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220620/msgaction 2022-6-20.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220620/msgaction 2022-6-20.log 2022-6-20 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220620/msgaction2 2022-6-20.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220620/msgaction2 2022-6-20.log 2022-6-20 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220620/msgtype 2022-6-20.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220620/msgtype 2022-6-20.log 2022-6-20 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220620/userinfo 2022-6-20.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220620/userinfo 2022-6-20.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220620
+ mv '*.log' 20220620
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220620'
/bin/bash etl-log_load.sh 20220620
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220620
2022-6-20
++ date +%Y%m%d -d '20220620 +1day'
+ date_str=20220621
+ [[ 20220621 != \2\0\2\2\0\6\2\1 ]]
20220621
20220622
+ start_date=20220621
+ end_date=20220622
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220621
+ echo 20220621
20220621
+ [[ 20220621 != \2\0\2\2\0\6\2\2 ]]
+ echo 20220621
20220621
+ echo '/bin/bash etl-log_extract.sh 20220621'
/bin/bash etl-log_extract.sh 20220621
+ /bin/bash ../etl/log_extract.sh 20220621
2022-6-21
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-21.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-21.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220621
+ mv '*.log' 20220621
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220621'
/bin/bash etl-log_transform.sh 20220621
+ /bin/bash ../etl/log_transform.sh 20220621
2022-6-21
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220621/msgaction 2022-6-21.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220621/msgaction 2022-6-21.log 2022-6-21 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220621/msgaction2 2022-6-21.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220621/msgaction2 2022-6-21.log 2022-6-21 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220621/msgtype 2022-6-21.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220621/msgtype 2022-6-21.log 2022-6-21 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220621/userinfo 2022-6-21.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220621/userinfo 2022-6-21.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220621
+ mv '*.log' 20220621
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220621'
/bin/bash etl-log_load.sh 20220621
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220621
2022-6-21
++ date +%Y%m%d -d '20220621 +1day'
+ date_str=20220622
+ [[ 20220622 != \2\0\2\2\0\6\2\2 ]]
20220622
20220623
+ start_date=20220622
+ end_date=20220623
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220622
+ echo 20220622
20220622
+ [[ 20220622 != \2\0\2\2\0\6\2\3 ]]
+ echo 20220622
20220622
+ echo '/bin/bash etl-log_extract.sh 20220622'
/bin/bash etl-log_extract.sh 20220622
+ /bin/bash ../etl/log_extract.sh 20220622
2022-6-22
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-22.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-22.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220622
+ mv '*.log' 20220622
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220622'
/bin/bash etl-log_transform.sh 20220622
+ /bin/bash ../etl/log_transform.sh 20220622
2022-6-22
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220622/msgaction 2022-6-22.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220622/msgaction 2022-6-22.log 2022-6-22 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220622/msgaction2 2022-6-22.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220622/msgaction2 2022-6-22.log 2022-6-22 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220622/msgtype 2022-6-22.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220622/msgtype 2022-6-22.log 2022-6-22 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220622/userinfo 2022-6-22.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220622/userinfo 2022-6-22.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220622
+ mv '*.log' 20220622
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220622'
/bin/bash etl-log_load.sh 20220622
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220622
2022-6-22
++ date +%Y%m%d -d '20220622 +1day'
+ date_str=20220623
+ [[ 20220623 != \2\0\2\2\0\6\2\3 ]]
20220623
20220624
+ start_date=20220623
+ end_date=20220624
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220623
+ echo 20220623
20220623
+ [[ 20220623 != \2\0\2\2\0\6\2\4 ]]
+ echo 20220623
20220623
+ echo '/bin/bash etl-log_extract.sh 20220623'
/bin/bash etl-log_extract.sh 20220623
+ /bin/bash ../etl/log_extract.sh 20220623
2022-6-23
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-23.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-23.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220623
+ mv '*.log' 20220623
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220623'
/bin/bash etl-log_transform.sh 20220623
+ /bin/bash ../etl/log_transform.sh 20220623
2022-6-23
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220623/msgaction 2022-6-23.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220623/msgaction 2022-6-23.log 2022-6-23 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220623/msgaction2 2022-6-23.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220623/msgaction2 2022-6-23.log 2022-6-23 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220623/msgtype 2022-6-23.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220623/msgtype 2022-6-23.log 2022-6-23 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220623/userinfo 2022-6-23.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220623/userinfo 2022-6-23.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220623
+ mv '*.log' 20220623
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220623'
/bin/bash etl-log_load.sh 20220623
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220623
2022-6-23
++ date +%Y%m%d -d '20220623 +1day'
+ date_str=20220624
+ [[ 20220624 != \2\0\2\2\0\6\2\4 ]]
20220624
20220625
+ start_date=20220624
+ end_date=20220625
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220624
+ echo 20220624
20220624
+ [[ 20220624 != \2\0\2\2\0\6\2\5 ]]
+ echo 20220624
20220624
+ echo '/bin/bash etl-log_extract.sh 20220624'
/bin/bash etl-log_extract.sh 20220624
+ /bin/bash ../etl/log_extract.sh 20220624
2022-6-24
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-24.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-24.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220624
+ mv '*.log' 20220624
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220624'
/bin/bash etl-log_transform.sh 20220624
+ /bin/bash ../etl/log_transform.sh 20220624
2022-6-24
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220624/msgaction 2022-6-24.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220624/msgaction 2022-6-24.log 2022-6-24 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220624/msgaction2 2022-6-24.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220624/msgaction2 2022-6-24.log 2022-6-24 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220624/msgtype 2022-6-24.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220624/msgtype 2022-6-24.log 2022-6-24 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220624/userinfo 2022-6-24.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220624/userinfo 2022-6-24.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220624
+ mv '*.log' 20220624
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220624'
/bin/bash etl-log_load.sh 20220624
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220624
2022-6-24
++ date +%Y%m%d -d '20220624 +1day'
+ date_str=20220625
+ [[ 20220625 != \2\0\2\2\0\6\2\5 ]]
20220625
20220626
+ start_date=20220625
+ end_date=20220626
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220625
+ echo 20220625
20220625
+ [[ 20220625 != \2\0\2\2\0\6\2\6 ]]
+ echo 20220625
20220625
+ echo '/bin/bash etl-log_extract.sh 20220625'
/bin/bash etl-log_extract.sh 20220625
+ /bin/bash ../etl/log_extract.sh 20220625
2022-6-25
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-25.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-25.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220625
+ mv '*.log' 20220625
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220625'
/bin/bash etl-log_transform.sh 20220625
+ /bin/bash ../etl/log_transform.sh 20220625
2022-6-25
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220625/msgaction 2022-6-25.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220625/msgaction 2022-6-25.log 2022-6-25 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220625/msgaction2 2022-6-25.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220625/msgaction2 2022-6-25.log 2022-6-25 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220625/msgtype 2022-6-25.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220625/msgtype 2022-6-25.log 2022-6-25 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220625/userinfo 2022-6-25.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220625/userinfo 2022-6-25.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220625
+ mv '*.log' 20220625
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220625'
/bin/bash etl-log_load.sh 20220625
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220625
2022-6-25
++ date +%Y%m%d -d '20220625 +1day'
+ date_str=20220626
+ [[ 20220626 != \2\0\2\2\0\6\2\6 ]]
20220626
20220627
+ start_date=20220626
+ end_date=20220627
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220626
+ echo 20220626
20220626
+ [[ 20220626 != \2\0\2\2\0\6\2\7 ]]
+ echo 20220626
20220626
+ echo '/bin/bash etl-log_extract.sh 20220626'
/bin/bash etl-log_extract.sh 20220626
+ /bin/bash ../etl/log_extract.sh 20220626
2022-6-26
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-26.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-26.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220626
+ mv '*.log' 20220626
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220626'
/bin/bash etl-log_transform.sh 20220626
+ /bin/bash ../etl/log_transform.sh 20220626
2022-6-26
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220626/msgaction 2022-6-26.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220626/msgaction 2022-6-26.log 2022-6-26 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220626/msgaction2 2022-6-26.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220626/msgaction2 2022-6-26.log 2022-6-26 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220626/msgtype 2022-6-26.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220626/msgtype 2022-6-26.log 2022-6-26 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220626/userinfo 2022-6-26.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220626/userinfo 2022-6-26.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220626
+ mv '*.log' 20220626
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220626'
/bin/bash etl-log_load.sh 20220626
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220626
2022-6-26
++ date +%Y%m%d -d '20220626 +1day'
+ date_str=20220627
+ [[ 20220627 != \2\0\2\2\0\6\2\7 ]]
20220627
20220628
+ start_date=20220627
+ end_date=20220628
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220627
+ echo 20220627
20220627
+ [[ 20220627 != \2\0\2\2\0\6\2\8 ]]
+ echo 20220627
20220627
+ echo '/bin/bash etl-log_extract.sh 20220627'
/bin/bash etl-log_extract.sh 20220627
+ /bin/bash ../etl/log_extract.sh 20220627
2022-6-27
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-27.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-27.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220627
+ mv '*.log' 20220627
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220627'
/bin/bash etl-log_transform.sh 20220627
+ /bin/bash ../etl/log_transform.sh 20220627
2022-6-27
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220627/msgaction 2022-6-27.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220627/msgaction 2022-6-27.log 2022-6-27 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220627/msgaction2 2022-6-27.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220627/msgaction2 2022-6-27.log 2022-6-27 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220627/msgtype 2022-6-27.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220627/msgtype 2022-6-27.log 2022-6-27 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220627/userinfo 2022-6-27.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220627/userinfo 2022-6-27.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220627
+ mv '*.log' 20220627
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220627'
/bin/bash etl-log_load.sh 20220627
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220627
2022-6-27
++ date +%Y%m%d -d '20220627 +1day'
+ date_str=20220628
+ [[ 20220628 != \2\0\2\2\0\6\2\8 ]]
20220628
20220629
+ start_date=20220628
+ end_date=20220629
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220628
+ echo 20220628
20220628
+ [[ 20220628 != \2\0\2\2\0\6\2\9 ]]
+ echo 20220628
20220628
+ echo '/bin/bash etl-log_extract.sh 20220628'
/bin/bash etl-log_extract.sh 20220628
+ /bin/bash ../etl/log_extract.sh 20220628
2022-6-28
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-28.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-28.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220628
+ mv '*.log' 20220628
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220628'
/bin/bash etl-log_transform.sh 20220628
+ /bin/bash ../etl/log_transform.sh 20220628
2022-6-28
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220628/msgaction 2022-6-28.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220628/msgaction 2022-6-28.log 2022-6-28 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220628/msgaction2 2022-6-28.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220628/msgaction2 2022-6-28.log 2022-6-28 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220628/msgtype 2022-6-28.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220628/msgtype 2022-6-28.log 2022-6-28 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220628/userinfo 2022-6-28.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220628/userinfo 2022-6-28.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220628
+ mv '*.log' 20220628
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220628'
/bin/bash etl-log_load.sh 20220628
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220628
2022-6-28
++ date +%Y%m%d -d '20220628 +1day'
+ date_str=20220629
+ [[ 20220629 != \2\0\2\2\0\6\2\9 ]]
20220629
20220630
+ start_date=20220629
+ end_date=20220630
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220629
+ echo 20220629
20220629
+ [[ 20220629 != \2\0\2\2\0\6\3\0 ]]
+ echo 20220629
20220629
+ echo '/bin/bash etl-log_extract.sh 20220629'
/bin/bash etl-log_extract.sh 20220629
+ /bin/bash ../etl/log_extract.sh 20220629
2022-6-29
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-29.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-29.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220629
+ mv '*.log' 20220629
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220629'
/bin/bash etl-log_transform.sh 20220629
+ /bin/bash ../etl/log_transform.sh 20220629
2022-6-29
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220629/msgaction 2022-6-29.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220629/msgaction 2022-6-29.log 2022-6-29 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220629/msgaction2 2022-6-29.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220629/msgaction2 2022-6-29.log 2022-6-29 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220629/msgtype 2022-6-29.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220629/msgtype 2022-6-29.log 2022-6-29 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220629/userinfo 2022-6-29.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220629/userinfo 2022-6-29.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220629
+ mv '*.log' 20220629
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220629'
/bin/bash etl-log_load.sh 20220629
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220629
2022-6-29
++ date +%Y%m%d -d '20220629 +1day'
+ date_str=20220630
+ [[ 20220630 != \2\0\2\2\0\6\3\0 ]]
20220630
20220701
+ start_date=20220630
+ end_date=20220701
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220630
+ echo 20220630
20220630
+ [[ 20220630 != \2\0\2\2\0\7\0\1 ]]
+ echo 20220630
20220630
+ echo '/bin/bash etl-log_extract.sh 20220630'
/bin/bash etl-log_extract.sh 20220630
+ /bin/bash ../etl/log_extract.sh 20220630
2022-6-30
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-6-30.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-6-30.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220630
+ mv '*.log' 20220630
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220630'
/bin/bash etl-log_transform.sh 20220630
+ /bin/bash ../etl/log_transform.sh 20220630
2022-6-30
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220630/msgaction 2022-6-30.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220630/msgaction 2022-6-30.log 2022-6-30 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220630/msgaction2 2022-6-30.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220630/msgaction2 2022-6-30.log 2022-6-30 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220630/msgtype 2022-6-30.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220630/msgtype 2022-6-30.log 2022-6-30 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220630/userinfo 2022-6-30.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220630/userinfo 2022-6-30.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220630
+ mv '*.log' 20220630
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220630'
/bin/bash etl-log_load.sh 20220630
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220630
2022-6-30
++ date +%Y%m%d -d '20220630 +1day'
+ date_str=20220701
+ [[ 20220701 != \2\0\2\2\0\7\0\1 ]]
20220701
20220702
+ start_date=20220701
+ end_date=20220702
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220701
+ echo 20220701
20220701
+ [[ 20220701 != \2\0\2\2\0\7\0\2 ]]
+ echo 20220701
20220701
+ echo '/bin/bash etl-log_extract.sh 20220701'
/bin/bash etl-log_extract.sh 20220701
+ /bin/bash ../etl/log_extract.sh 20220701
2022-7-1
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-7-1.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-7-1.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220701
+ mv '*.log' 20220701
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220701'
/bin/bash etl-log_transform.sh 20220701
+ /bin/bash ../etl/log_transform.sh 20220701
2022-7-1
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220701/msgaction 2022-7-1.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220701/msgaction 2022-7-1.log 2022-7-1 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220701/msgaction2 2022-7-1.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220701/msgaction2 2022-7-1.log 2022-7-1 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220701/msgtype 2022-7-1.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220701/msgtype 2022-7-1.log 2022-7-1 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220701/userinfo 2022-7-1.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220701/userinfo 2022-7-1.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220701
+ mv '*.log' 20220701
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220701'
/bin/bash etl-log_load.sh 20220701
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220701
2022-7-1
++ date +%Y%m%d -d '20220701 +1day'
+ date_str=20220702
+ [[ 20220702 != \2\0\2\2\0\7\0\2 ]]
20220702
20220703
+ start_date=20220702
+ end_date=20220703
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220702
+ echo 20220702
20220702
+ [[ 20220702 != \2\0\2\2\0\7\0\3 ]]
+ echo 20220702
20220702
+ echo '/bin/bash etl-log_extract.sh 20220702'
/bin/bash etl-log_extract.sh 20220702
+ /bin/bash ../etl/log_extract.sh 20220702
2022-7-2
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-7-2.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-7-2.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220702
+ mv '*.log' 20220702
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220702'
/bin/bash etl-log_transform.sh 20220702
+ /bin/bash ../etl/log_transform.sh 20220702
2022-7-2
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220702/msgaction 2022-7-2.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220702/msgaction 2022-7-2.log 2022-7-2 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220702/msgaction2 2022-7-2.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220702/msgaction2 2022-7-2.log 2022-7-2 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220702/msgtype 2022-7-2.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220702/msgtype 2022-7-2.log 2022-7-2 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220702/userinfo 2022-7-2.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220702/userinfo 2022-7-2.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220702
+ mv '*.log' 20220702
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220702'
/bin/bash etl-log_load.sh 20220702
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220702
2022-7-2
++ date +%Y%m%d -d '20220702 +1day'
+ date_str=20220703
+ [[ 20220703 != \2\0\2\2\0\7\0\3 ]]
20220703
20220704
+ start_date=20220703
+ end_date=20220704
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220703
+ echo 20220703
20220703
+ [[ 20220703 != \2\0\2\2\0\7\0\4 ]]
+ echo 20220703
20220703
+ echo '/bin/bash etl-log_extract.sh 20220703'
/bin/bash etl-log_extract.sh 20220703
+ /bin/bash ../etl/log_extract.sh 20220703
2022-7-3
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-7-3.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-7-3.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220703
+ mv '*.log' 20220703
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220703'
/bin/bash etl-log_transform.sh 20220703
+ /bin/bash ../etl/log_transform.sh 20220703
2022-7-3
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220703/msgaction 2022-7-3.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220703/msgaction 2022-7-3.log 2022-7-3 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220703/msgaction2 2022-7-3.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220703/msgaction2 2022-7-3.log 2022-7-3 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220703/msgtype 2022-7-3.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220703/msgtype 2022-7-3.log 2022-7-3 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220703/userinfo 2022-7-3.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220703/userinfo 2022-7-3.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220703
+ mv '*.log' 20220703
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220703'
/bin/bash etl-log_load.sh 20220703
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220703
2022-7-3
++ date +%Y%m%d -d '20220703 +1day'
+ date_str=20220704
+ [[ 20220704 != \2\0\2\2\0\7\0\4 ]]
20220704
20220705
+ start_date=20220704
+ end_date=20220705
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220704
+ echo 20220704
20220704
+ [[ 20220704 != \2\0\2\2\0\7\0\5 ]]
+ echo 20220704
20220704
+ echo '/bin/bash etl-log_extract.sh 20220704'
/bin/bash etl-log_extract.sh 20220704
+ /bin/bash ../etl/log_extract.sh 20220704
2022-7-4
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-7-4.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-7-4.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220704
+ mv '*.log' 20220704
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220704'
/bin/bash etl-log_transform.sh 20220704
+ /bin/bash ../etl/log_transform.sh 20220704
2022-7-4
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220704/msgaction 2022-7-4.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220704/msgaction 2022-7-4.log 2022-7-4 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220704/msgaction2 2022-7-4.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220704/msgaction2 2022-7-4.log 2022-7-4 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220704/msgtype 2022-7-4.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220704/msgtype 2022-7-4.log 2022-7-4 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220704/userinfo 2022-7-4.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220704/userinfo 2022-7-4.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220704
+ mv '*.log' 20220704
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220704'
/bin/bash etl-log_load.sh 20220704
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220704
2022-7-4
++ date +%Y%m%d -d '20220704 +1day'
+ date_str=20220705
+ [[ 20220705 != \2\0\2\2\0\7\0\5 ]]
20220705
20220706
+ start_date=20220705
+ end_date=20220706
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220705
+ echo 20220705
20220705
+ [[ 20220705 != \2\0\2\2\0\7\0\6 ]]
+ echo 20220705
20220705
+ echo '/bin/bash etl-log_extract.sh 20220705'
/bin/bash etl-log_extract.sh 20220705
+ /bin/bash ../etl/log_extract.sh 20220705
2022-7-5
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-7-5.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-7-5.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220705
+ mv '*.log' 20220705
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220705'
/bin/bash etl-log_transform.sh 20220705
+ /bin/bash ../etl/log_transform.sh 20220705
2022-7-5
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220705/msgaction 2022-7-5.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220705/msgaction 2022-7-5.log 2022-7-5 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220705/msgaction2 2022-7-5.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220705/msgaction2 2022-7-5.log 2022-7-5 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220705/msgtype 2022-7-5.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220705/msgtype 2022-7-5.log 2022-7-5 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220705/userinfo 2022-7-5.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220705/userinfo 2022-7-5.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220705
+ mv '*.log' 20220705
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220705'
/bin/bash etl-log_load.sh 20220705
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220705
2022-7-5
++ date +%Y%m%d -d '20220705 +1day'
+ date_str=20220706
+ [[ 20220706 != \2\0\2\2\0\7\0\6 ]]
20220706
20220707
+ start_date=20220706
+ end_date=20220707
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220706
+ echo 20220706
20220706
+ [[ 20220706 != \2\0\2\2\0\7\0\7 ]]
+ echo 20220706
20220706
+ echo '/bin/bash etl-log_extract.sh 20220706'
/bin/bash etl-log_extract.sh 20220706
+ /bin/bash ../etl/log_extract.sh 20220706
2022-7-6
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-7-6.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-7-6.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220706
+ mv '*.log' 20220706
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220706'
/bin/bash etl-log_transform.sh 20220706
+ /bin/bash ../etl/log_transform.sh 20220706
2022-7-6
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220706/msgaction 2022-7-6.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220706/msgaction 2022-7-6.log 2022-7-6 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220706/msgaction2 2022-7-6.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220706/msgaction2 2022-7-6.log 2022-7-6 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220706/msgtype 2022-7-6.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220706/msgtype 2022-7-6.log 2022-7-6 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220706/userinfo 2022-7-6.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220706/userinfo 2022-7-6.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220706
+ mv '*.log' 20220706
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220706'
/bin/bash etl-log_load.sh 20220706
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220706
2022-7-6
++ date +%Y%m%d -d '20220706 +1day'
+ date_str=20220707
+ [[ 20220707 != \2\0\2\2\0\7\0\7 ]]
20220707
20220708
+ start_date=20220707
+ end_date=20220708
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220707
+ echo 20220707
20220707
+ [[ 20220707 != \2\0\2\2\0\7\0\8 ]]
+ echo 20220707
20220707
+ echo '/bin/bash etl-log_extract.sh 20220707'
/bin/bash etl-log_extract.sh 20220707
+ /bin/bash ../etl/log_extract.sh 20220707
2022-7-7
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-7-7.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-7-7.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220707
+ mv '*.log' 20220707
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220707'
/bin/bash etl-log_transform.sh 20220707
+ /bin/bash ../etl/log_transform.sh 20220707
2022-7-7
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220707/msgaction 2022-7-7.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220707/msgaction 2022-7-7.log 2022-7-7 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220707/msgaction2 2022-7-7.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220707/msgaction2 2022-7-7.log 2022-7-7 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220707/msgtype 2022-7-7.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220707/msgtype 2022-7-7.log 2022-7-7 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220707/userinfo 2022-7-7.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220707/userinfo 2022-7-7.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220707
+ mv '*.log' 20220707
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220707'
/bin/bash etl-log_load.sh 20220707
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220707
2022-7-7
++ date +%Y%m%d -d '20220707 +1day'
+ date_str=20220708
+ [[ 20220708 != \2\0\2\2\0\7\0\8 ]]
20220708
20220709
+ start_date=20220708
+ end_date=20220709
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220708
+ echo 20220708
20220708
+ [[ 20220708 != \2\0\2\2\0\7\0\9 ]]
+ echo 20220708
20220708
+ echo '/bin/bash etl-log_extract.sh 20220708'
/bin/bash etl-log_extract.sh 20220708
+ /bin/bash ../etl/log_extract.sh 20220708
2022-7-8
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-7-8.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-7-8.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220708
+ mv '*.log' 20220708
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220708'
/bin/bash etl-log_transform.sh 20220708
+ /bin/bash ../etl/log_transform.sh 20220708
2022-7-8
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220708/msgaction 2022-7-8.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220708/msgaction 2022-7-8.log 2022-7-8 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220708/msgaction2 2022-7-8.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220708/msgaction2 2022-7-8.log 2022-7-8 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220708/msgtype 2022-7-8.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220708/msgtype 2022-7-8.log 2022-7-8 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220708/userinfo 2022-7-8.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220708/userinfo 2022-7-8.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220708
+ mv '*.log' 20220708
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220708'
/bin/bash etl-log_load.sh 20220708
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220708
2022-7-8
++ date +%Y%m%d -d '20220708 +1day'
+ date_str=20220709
+ [[ 20220709 != \2\0\2\2\0\7\0\9 ]]
20220709
20220710
+ start_date=20220709
+ end_date=20220710
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220709
+ echo 20220709
20220709
+ [[ 20220709 != \2\0\2\2\0\7\1\0 ]]
+ echo 20220709
20220709
+ echo '/bin/bash etl-log_extract.sh 20220709'
/bin/bash etl-log_extract.sh 20220709
+ /bin/bash ../etl/log_extract.sh 20220709
2022-7-9
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-7-9.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-7-9.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220709
+ mv '*.log' 20220709
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220709'
/bin/bash etl-log_transform.sh 20220709
+ /bin/bash ../etl/log_transform.sh 20220709
2022-7-9
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220709/msgaction 2022-7-9.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220709/msgaction 2022-7-9.log 2022-7-9 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220709/msgaction2 2022-7-9.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220709/msgaction2 2022-7-9.log 2022-7-9 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220709/msgtype 2022-7-9.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220709/msgtype 2022-7-9.log 2022-7-9 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220709/userinfo 2022-7-9.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220709/userinfo 2022-7-9.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220709
+ mv '*.log' 20220709
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220709'
/bin/bash etl-log_load.sh 20220709
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220709
2022-7-9
++ date +%Y%m%d -d '20220709 +1day'
+ date_str=20220710
+ [[ 20220710 != \2\0\2\2\0\7\1\0 ]]
20220710
20220711
+ start_date=20220710
+ end_date=20220711
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220710
+ echo 20220710
20220710
+ [[ 20220710 != \2\0\2\2\0\7\1\1 ]]
+ echo 20220710
20220710
+ echo '/bin/bash etl-log_extract.sh 20220710'
/bin/bash etl-log_extract.sh 20220710
+ /bin/bash ../etl/log_extract.sh 20220710
2022-7-10
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-7-10.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-7-10.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220710
+ mv '*.log' 20220710
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220710'
/bin/bash etl-log_transform.sh 20220710
+ /bin/bash ../etl/log_transform.sh 20220710
2022-7-10
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220710/msgaction 2022-7-10.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220710/msgaction 2022-7-10.log 2022-7-10 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220710/msgaction2 2022-7-10.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220710/msgaction2 2022-7-10.log 2022-7-10 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220710/msgtype 2022-7-10.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220710/msgtype 2022-7-10.log 2022-7-10 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220710/userinfo 2022-7-10.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220710/userinfo 2022-7-10.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220710
+ mv '*.log' 20220710
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220710'
/bin/bash etl-log_load.sh 20220710
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220710
2022-7-10
++ date +%Y%m%d -d '20220710 +1day'
+ date_str=20220711
+ [[ 20220711 != \2\0\2\2\0\7\1\1 ]]
20220711
20220712
+ start_date=20220711
+ end_date=20220712
+ host=47.253.49.46
+ source /home/wuxin/miniconda3/bin/activate moyu-ml-python
++ _CONDA_ROOT=/home/wuxin/miniconda3
++ . /home/wuxin/miniconda3/etc/profile.d/conda.sh
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ '[' -z '' ']'
+++ export CONDA_SHLVL=0
+++ CONDA_SHLVL=0
+++ '[' -n '' ']'
+++++ dirname /home/wuxin/miniconda3/bin/conda
++++ dirname /home/wuxin/miniconda3/bin
+++ PATH=/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ '[' -z '' ']'
+++ PS1=
++ conda activate moyu-ml-python
++ local cmd=activate
++ case "$cmd" in
++ __conda_activate activate moyu-ml-python
++ '[' -n '' ']'
++ local ask_conda
+++ PS1=
+++ __conda_exe shell.posix activate moyu-ml-python
+++ __add_sys_prefix_to_path
+++ '[' -n '' ']'
++++ dirname /home/wuxin/miniconda3/bin/conda
+++ SYSP=/home/wuxin/miniconda3/bin
++++ dirname /home/wuxin/miniconda3/bin
+++ SYSP=/home/wuxin/miniconda3
+++ '[' -n '' ']'
+++ PATH=/home/wuxin/miniconda3/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export PATH
+++ /home/wuxin/miniconda3/bin/conda shell.posix activate moyu-ml-python
++ ask_conda='PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
++ eval 'PS1='\''(moyu-ml-python) '\''
export PATH='\''/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin'\''
export CONDA_PREFIX='\''/home/wuxin/miniconda3/envs/moyu-ml-python'\''
export CONDA_SHLVL='\''1'\''
export CONDA_DEFAULT_ENV='\''moyu-ml-python'\''
export CONDA_PROMPT_MODIFIER='\''(moyu-ml-python) '\''
export CONDA_EXE='\''/home/wuxin/miniconda3/bin/conda'\''
export _CE_M='\'''\''
export _CE_CONDA='\'''\''
export CONDA_PYTHON_EXE='\''/home/wuxin/miniconda3/bin/python'\'''
+++ PS1='(moyu-ml-python) '
+++ export PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ PATH=/home/wuxin/miniconda3/envs/moyu-ml-python/bin:/home/wuxin/miniconda3/condabin:/usr/bin:/bin
+++ export CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ CONDA_PREFIX=/home/wuxin/miniconda3/envs/moyu-ml-python
+++ export CONDA_SHLVL=1
+++ CONDA_SHLVL=1
+++ export CONDA_DEFAULT_ENV=moyu-ml-python
+++ CONDA_DEFAULT_ENV=moyu-ml-python
+++ export 'CONDA_PROMPT_MODIFIER=(moyu-ml-python) '
+++ CONDA_PROMPT_MODIFIER='(moyu-ml-python) '
+++ export CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ CONDA_EXE=/home/wuxin/miniconda3/bin/conda
+++ export _CE_M=
+++ _CE_M=
+++ export _CE_CONDA=
+++ _CE_CONDA=
+++ export CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
+++ CONDA_PYTHON_EXE=/home/wuxin/miniconda3/bin/python
++ __conda_hashr
++ '[' -n '' ']'
++ '[' -n '' ']'
++ hash -r
+ date_str=20220711
+ echo 20220711
20220711
+ [[ 20220711 != \2\0\2\2\0\7\1\2 ]]
+ echo 20220711
20220711
+ echo '/bin/bash etl-log_extract.sh 20220711'
/bin/bash etl-log_extract.sh 20220711
+ /bin/bash ../etl/log_extract.sh 20220711
2022-7-11
host is: 47.253.49.46
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f "da/msgaction 2022-7-11.log"
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../tool/ftp_download.py", line 39, in <module>
    client = SftpClient(ftp_configure["ftp_host"], 21,
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 11, in __init__
    self.client = self.__login()
  File "/home/wuxin/moyu-ml/tool/sftp_client.py", line 15, in __login
    transport = paramiko.Transport(sock=(self.host, self.port))
  File "/home/wuxin/miniconda3/envs/moyu-ml-python/lib/python3.9/site-packages/paramiko/transport.py", line 415, in __init__
    raise SSHException(
paramiko.ssh_exception.SSHException: Unable to connect to 47.253.49.46: [Errno 110] Connection timed out
python3 ../tool/ftp_download.py -c 47.253.49.46.json -f  "da/msgaction 2022-7-11.log" failed
+ cd /home/wuxin/english-moyu/data/47.253.49.46/da
+ mkdir 20220711
+ mv '*.log' 20220711
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_transform.sh 20220711'
/bin/bash etl-log_transform.sh 20220711
+ /bin/bash ../etl/log_transform.sh 20220711
2022-7-11
start transform_msgaction /home/wuxin/english-moyu/data/47.253.49.46/da/20220711/msgaction 2022-7-11.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220711/msgaction 2022-7-11.log 2022-7-11 47.253.49.46 file not found
start transform_msgaction2 /home/wuxin/english-moyu/data/47.253.49.46/da/20220711/msgaction2 2022-7-11.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220711/msgaction2 2022-7-11.log 2022-7-11 47.253.49.46 file not found
start transform_msgtype /home/wuxin/english-moyu/data/47.253.49.46/da/20220711/msgtype 2022-7-11.log
/home/wuxin/english-moyu/data/47.253.49.46/da/20220711/msgtype 2022-7-11.log 2022-7-11 47.253.49.46 file not found
start transform_userinfo /home/wuxin/english-moyu/data/47.253.49.46/da/20220711/userinfo 2022-7-11.log
Traceback (most recent call last):
  File "/home/wuxin/moyu-ml/tool/../etl/log_transform_to_hdfs.py", line 252, in transform_userinfo
    f = open(filename, "r")
FileNotFoundError: [Errno 2] No such file or directory: '/home/wuxin/english-moyu/data/47.253.49.46/da/20220711/userinfo 2022-7-11.log'

+ cd /home/wuxin/moyu_ml/english-moyu
+ mkdir 20220711
+ mv '*.log' 20220711
mv: cannot stat ‘*.log’: No such file or directory
+ cd /home/wuxin/moyu-ml/tool
+ echo '/bin/bash etl-log_load.sh 20220711'
/bin/bash etl-log_load.sh 20220711
+ kinit -kt /home/zk/krb5keytab/ywmy.keytab ywmy
+ /bin/bash ../etl/log_load.sh 20220711
2022-7-11
++ date +%Y%m%d -d '20220711 +1day'
+ date_str=20220712
+ [[ 20220712 != \2\0\2\2\0\7\1\2 ]]
